<head>
<style>
	.small           { font: italic 15px sans-serif; }
	.medium0         { font: 20px sans-serif; fill:#006000; }
	.medium1         { font: italic 17px sans-serif; fill:#005000; }
	.vsmall          { font: italic 12px sans-serif; }
	.vsmall-red      { font: italic 12px sans-serif; fill:#ff0000; }
	.teal-box        { fill:#00ffff; stroke:#000000; stroke-width:3; }
	.yellow-box      { fill:#ffff00; stroke:#000000; stroke-width:3; }
	.white-box       { fill:#ffffff; stroke:#000000; stroke-width:3; }
	.gray-box        { fill:#d0d0d0; stroke:#000000; stroke-width:3; }
	.white-box       { fill:#e0e0e0; stroke:#000000; stroke-width:3; }
	.input-line      { fill:#000000; stroke:#000000; stroke-width:1; }
	.red-line        { fill:#f00000; stroke:#000000; stroke-width:1; }
	.out-box         { fill:#ffffff; stroke:#000000; stroke-width:1; }
	.blue-line       { fill:#000000; stroke:#4040ff; stroke-width:3; fill:none }
	.blue-line-1     { fill:#000000; stroke:#4040ff; stroke-width:2; fill:none }
	.button-box      { fill:#b4c5fb; stroke:#000000; stroke-width:2; opacity:0.75 }
	.arrow-line      { stroke:#000000; stroke-width:2; stroke-linecap: round; }
	.arrow-line-red  { stroke:#ff0000; stroke-width:2; stroke-linecap: round; }
	.arrow-line-green { stroke:#00ff00; stroke-width:2; stroke-linecap: round; }
	.bk-box 		 { fill:#d7d7d7; stroke-width:0; }
	.hash-input 	 {
		width: 450px;
		margin-bottom: 20px;
	}
	.modal-submit 	 {
		margin-top: 20px;
		margin-bottom: 20px;
	}
/* Modal ---------------------------------------------------------------------------------- */
body {font-family: Arial, Helvetica, sans-serif;}

/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  position: relative;
  background-color: #fefefe;
  margin: auto;
  padding: 0;
  border: 1px solid #888;
  width: 80%;
  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
  -webkit-animation-name: animatetop;
  -webkit-animation-duration: 0.4s;
  animation-name: animatetop;
  animation-duration: 0.4s
}

/* Add Animation */
@-webkit-keyframes animatetop {
  from {top:-300px; opacity:0} 
  to {top:0; opacity:1}
}

@keyframes animatetop {
  from {top:-300px; opacity:0}
  to {top:0; opacity:1}
}

/* The Close Button */
.close {
  color: white;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}

.modal-header {
  padding: 2px 16px;
  background-color: #5cb85c;
  color: white;
}

.modal-body {padding: 2px 16px;}

.modal-footer {
  padding: 2px 16px;
  background-color: #5cb85c;
  color: white;
}
</style>
<script src="js/jquery-3.3.1.js" type="text/javascript"></script>
<script src="js/popper-1.14.7.js" type="text/javascript"></script>
</head>
<body>
<svg width="1640" height="1480" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
 <g class="layer">
	<rect x="493" y="55" width="97" height="50" rx="20" class="bk-box"/>
	<text id="h_name_txt_0" x="510" y="80" class="medium0">MARIA</text>
	<text id="h_name_txt_0" x="502" y="95" class="medium1">Microcode</text>

	<title>Maria Simple CPU - For Microcoding</title>
	<rect id="id_pc" x="75" y="30" width="50" height="100" class="teal-box" onclick="infoOn('id_pc');"/>
		<text x="75" y="25" class="small" onclick="infoOn('id_pc');">PC</text>
		<rect id="id_pc_Ld" x="125" y="40" width="20" height="1" class="input-line" />
			<text x="130" y="35" class="vsmall" onclick="infoOn('id_pc_Ld');">Ld</text>
		<rect id="id_pc_Inc" x="125" y="60" width="20" height="1" class="input-line" />
			<text x="130" y="55" class="vsmall" onclick="infoOn('id_pc_Inc');">Inc</text>
		<rect id="id_pc_Out" x="125" y="80" width="20" height="1" class="input-line" />
			<text x="130" y="75" class="vsmall" onclick="infoOn('id_pc_Out');">Out</text>
		<rect id="id_pc_Clr" x="125" y="100" width="20" height="1" class="input-line" />
			<text x="130" y="95" class="vsmall" onclick="infoOn('id_pc_Clr');">Clr</text>
		<!-- Connection from PC to Bus -->
		<rect id="id_pc_to_bus" x="100" y="130" width="1" height="160" class="input-line" />

			<!-- arrow down for pc to bus -->
			<line x1="100" y1="290" x2="95" y2="285" class="arrow-line" />
			<line x1="100" y1="290" x2="105" y2="285" class="arrow-line" />
			<!-- arrow up to PC register, load PC input -->
			<line x1="100" y1="132" x2="95" y2="137" class="arrow-line" />
			<line x1="100" y1="132" x2="105" y2="137" class="arrow-line" />

			<text id="h_pc_txt_0" x="85" y="55" class="small"></text>
			<text id="h_pc_txt_1" x="85" y="75" class="small"></text>

	<rect id="id_ir" x="175" y="30" width="50" height="100" class="teal-box" onclick="infoOn('id_ir');"/>
		<text x="175" y="25" class="small" onclick="infoOn('id_ir');">IR</text>
		<rect id="id_ir_Ld" x="225" y="40" width="20" height="1" class="input-line" />
			<text x="230" y="35" class="vsmall" onclick="infoOn('id_ir_Ld');">Ld</text>
		<rect id="id_ir_Out" x="225" y="60" width="20" height="1" class="input-line" />
			<text x="230" y="55" class="vsmall" onclick="infoOn('id_ir_Out');">Out</text>
		<!-- Connection from IR to Bus -->
		<rect id="id_ir_to_bus" x="200" y="130" width="1" height="160" class="input-line" />
		<rect id="id_ir_sw" x="175" y="230" width="50" height="45" class="gray-box" />
			<text x="230" y="233" class="vsmall" onclick="infoOn('hand_out');">Hand Out</text>
			<text x="230" y="245" class="vsmall" onclick="infoOn('hand_out');">Hand[12]</text>
			<rect id="id_hand_out_a" x="225" y="250" width="60" height="1" class="input-line" />
			<rect id="id_hand_out_b" x="285" y="250" width="1" height="40" class="input-line" />

			<!-- arrow for hand-out to bus -->
			<line x1="285" y1="290" x2="280" y2="285" class="arrow-line" />
			<line x1="285" y1="290" x2="290" y2="285" class="arrow-line" />
			<!-- arrow down for IR to bus -->
			<line x1="200" y1="290" x2="195" y2="285" class="arrow-line" />
			<line x1="200" y1="290" x2="205" y2="285" class="arrow-line" />
			<!-- arrow up to IR register, load IR input -->
			<line x1="200" y1="132" x2="195" y2="137" class="arrow-line" />
			<line x1="200" y1="132" x2="205" y2="137" class="arrow-line" />

			<rect id="id_decode_msb_4" x="200" y="170" width="100" height="1" class="input-line" onclick="infoOn('ir_decode_g1');"/>
				<text x="205" y="155" class="vsmall" onclick="infoOn('ir_decode_g1');">IR(15..12)[4] to </text>
				<text x="205" y="167" class="vsmall" onclick="infoOn('ir_decode_g1');">decoder 0b11</text>
			<rect id="id_decode_xIns_4" x="200" y="200" width="100" height="1" class="input-line" onclick="infoOn('ir_decode_g2');" />
				<text x="205" y="185" class="vsmall" onclick="infoOn('ir_decode_g2');">IR(11..8)[4] to </text>
				<text x="205" y="195" class="vsmall" onclick="infoOn('ir_decode_g2');">decoder 0b10</text>

			<!-- xyzzy - IR MSB[4] to Decodeer_In_01 -->
			<!-- xyzzy - IR other[4] to Decodeer_In_02 -->
			<!-- xyzzy - Decoder == 11, connect to bus -->
			<!-- From microcode.m2
				Decoer Inputs
					CTL		Line/Instruction
					00		82,124	/ Microcode Jmp (Halt, Unused)
					01		138,144,150 / Jump if (Is Zero) from Result/Cmp - Microcode PC Inc Twice
					10		133 / OkSkip { OkSkipEe0, OkSkipGt0, OkSkipLt0 }
					11		22  / Common IR Decode
			-->

			<text id="h_ir_txt_0" x="185" y="55" class="small"></text>
			<text id="h_ir_txt_1" x="185" y="75" class="small"></text>

	<rect id="id_result" x="300" y="30" width="50" height="100" class="teal-box" onclick="infoOn('id_result');"/>
		<text x="300" y="25" class="small" onclick="infoOn('id_result');">Result</text>
		<rect id="id_result_Ld" x="350" y="40" width="20" height="1" class="input-line" />
			<text x="355" y="35" class="vsmall" onclick="infoOn('id_result_Ld');">Ld</text>
		<rect id="id_result_Out" x="350" y="60" width="20" height="1" class="input-line" />
			<text x="355" y="55" class="vsmall" onclick="infoOn('id_result_Out');">Out</text>
		<rect id="id_result_Clr" x="350" y="100" width="20" height="1" class="input-line" />
			<text x="355" y="95" class="vsmall" onclick="infoOn('id_result_Clr');">Clr</text>

		<!-- // id_result_Out decoder_ctl_0 Microcode_PC_Ld2			// 0x3 on Decoder-CTL = will load address for a id_pc_Inc*    id_pc_Inc = result_eq_0 -->
		<g id="Microcode_PC_Ld2">
		<rect id="id_result_zero_out" x="350" y="120" width="47" height="1" class="input-line" />
			<text x="355" y="115" class="vsmall" onclick="infoOn('id_result_zero_out');">Is Zero</text>
		</g>

			<!-- arrow for is zero - output from IR -->
			<line x1="397" y1="120" x2="392" y2="115" class="arrow-line" />
			<line x1="397" y1="120" x2="392" y2="125" class="arrow-line" />
			<!-- arrow down for Result to bus -->
			<line x1="325" y1="290" x2="320" y2="285" class="arrow-line" />
			<line x1="325" y1="290" x2="330" y2="285" class="arrow-line" />
			<!-- arrow up to Result register, load Result input -->
			<line x1="325" y1="132" x2="320" y2="137" class="arrow-line" />
			<line x1="325" y1="132" x2="330" y2="137" class="arrow-line" />

			<text id="h_result_txt_0" x="310" y="55" class="small"></text>
			<text id="h_result_txt_1" x="310" y="75" class="small"></text>

		<!-- Connection from Result to Bus -->
		<rect id="id_result_to_bus" x="325" y="130" width="1" height="160" class="input-line" />


	<polygon id="id_ALU"
		points=" 500,30	400,60 400,100 500,130 500,110 480,100 480,60 500,50	 500,30 "
		fill="#80ff80" stroke="#000000" stroke-width="3" />
		<text x="400" y="45" class="small">ALU</text>
		<rect id="id_ALU_Ctl_0" x="420" y="108" width="1" height="45" class="input-line" />
		<rect id="id_ALU_Ctl_1" x="425" y="109" width="1" height="44" class="input-line" />
		<rect id="id_ALU_Ctl_2" x="430" y="110" width="1" height="43" class="input-line" />
		<rect id="id_ALU_Ctl_3" x="435" y="111" width="1" height="42" class="input-line" />
			<text x="440" y="142" class="vsmall" onclick="infoOn('id_ALU_Ctl');">ALU Ctl</text>
			<text x="440" y="152" class="vsmall" onclick="infoOn('id_ALU_Ctl');">0..3</text>
		<!-- Connection from ALU to Result -->
		<rect id="id_ALU_to_result" x="350" y="80" width="50" height="1" class="input-line" />
		<!-- Connection from ALU to AC -->
		<rect id="id_ac_to_ALU" x="500" y="40" width="100" height="1" class="input-line" />
		<!-- Connection from ALU to Bus Pt1 -->
		<rect id="id_ac_to_Bus_pt1" x="500" y="120" width="40" height="1" class="input-line" />
		<!-- Connection from ALU to Bus Pt2 -->
		<rect id="id_ac_to_Bus_pt2" x="540" y="120" width="1" height="170" class="input-line" />

			<!-- arrow for AC to Result -->
			<line x1="352" y1="80" x2="357" y2="75" class="arrow-line" />
			<line x1="352" y1="80" x2="357" y2="85" class="arrow-line" />
			<!-- arrow for AC Input A (from AC register) -->
			<line x1="502" y1="40" x2="507" y2="35" class="arrow-line" />
			<line x1="502" y1="40" x2="507" y2="45" class="arrow-line" />
			<!-- arrow for AC Input B (from bus) -->
			<line x1="502" y1="120" x2="507" y2="115" class="arrow-line" />
			<line x1="502" y1="120" x2="507" y2="125" class="arrow-line" />

		<text id="h_alu_txt" x="405" y="85" class="small"></text>

	<rect id="id_ac" x="600" y="30" width="50" height="100" class="teal-box" onclick="infoOn('id_ac');"/>
		<text x="600" y="25" class="small" onclick="infoOn('id_ac');">AC</text>
		<rect id="id_ac_Ld" x="650" y="40" width="20" height="1" class="input-line" />
			<text x="655" y="35" class="vsmall" onclick="infoOn('id_ac_Ld');">Ld</text>
		<rect id="id_ac_Out" x="650" y="60" width="20" height="1" class="input-line" />
			<text x="655" y="55" class="vsmall" onclick="infoOn('id_ac_Out');">Out</text>
		<rect id="id_ac_Out_to_ALU" x="650" y="80" width="20" height="1" class="input-line" />
			<text x="655" y="75" class="vsmall" onclick="infoOn('id_ac_Out_to_ALU');">Out To ALU</text>
		<rect id="id_ac_Inc" x="650" y="100" width="20" height="1" class="input-line" />
			<text x="655" y="95" class="vsmall" onclick="infoOn('id_ac_Inc');">Inc</text>
		<rect id="id_ac_Clr" x="650" y="120" width="20" height="1" class="input-line" />
			<text x="655" y="115" class="vsmall" onclick="infoOn('id_ac_Inc');">Clr</text>
		<!-- Connection from AC to Bus -->
		<rect id="id_ac_to_bus" x="625" y="130" width="1" height="160" class="input-line" />

			<!-- arrow down for AC to bus -->
			<line x1="625" y1="290" x2="620" y2="285" class="arrow-line" />
			<line x1="625" y1="290" x2="630" y2="285" class="arrow-line" />
			<!-- arrow up to AC register, load AC input -->
			<line x1="625" y1="132" x2="620" y2="137" class="arrow-line" />
			<line x1="625" y1="132" x2="630" y2="137" class="arrow-line" />

		<text id="h_ac_txt_0" x="610" y="55" class="small"></text>
		<text id="h_ac_txt_1" x="610" y="75" class="small"></text>

	<rect id="id_microcode" x="750" y="30" width="400" height="100" fill="#c0a0a0" stroke="#000000" stroke-width="3" onclick="infoOn('id_microcode');"/>
		<text x="750" y="25" class="small" onclick="infoOn('id_microcode');">Microcode</text>
		<text id="microcode_txt_0" x="754" y="47" class="small">Address 256 Words</text>
		<text id="microcode_txt_1" x="754" y="67" class="small">Data 64 bits wide</text>

		<text id="h_microcode_txt_0" x="760" y="50" class="small"></text>
		<text id="h_microcode_txt_1" x="760" y="65" class="small"></text>
		<text id="h_microcode_txt_2" x="760" y="80" class="small"></text>
		<text id="h_microcode_txt_3" x="760" y="95" class="small"></text>
		<text id="h_microcode_txt_4" x="760" y="115" class="small"></text>

	<rect id="id_Microcode_PC" x="1200" y="30" width="100" height="50" fill="#ffd700" stroke="#000000" stroke-width="3" onclick="infoOn('id_Microcode_PC');"/>
		<text x="1200" y="25" class="small" onclick="infoOn('id_Microcode_PC');">Microcode PC</text>
		<rect id="id_Microcode_PC_Ld" x="1300" y="40" width="20" height="1" class="input-line" />
			<text x="1305" y="35" class="vsmall" onclick="infoOn('id_Microcode_PC_Ld');">Ld</text>
		<rect id="id_Microcode_PC_Clr" x="1300" y="60" width="20" height="1" class="input-line" />
			<text x="1305" y="55" class="vsmall" onclick="infoOn('id_Microcode_PC_Clr');">Clr</text>
		<!-- connection from decoder output to Microcode Address Load/Input -->
		<rect id="id_Microcode_PC_In[8]a"   x="1270"   y="80"   width="1"    height="65"    class="input-line" />
		<rect id="id_Microcode_PC_In[8]b"   x="1270"   y="145"  width="60"   height="1"     class="input-line" />
		<rect id="id_Microcode_PC_In[8]c"   x="1330"   y="145"  width="1"    height="75" 	class="input-line" />
		<rect id="id_Microcode_PC_In[8]d"   x="1280"   y="220"  width="50"   height="1"     class="input-line" />
			<text x="1275" y="95" class="vsmall">In[8]</text>
			<text x="1282" y="215" class="vsmall">Out</text>
			<!-- arrow up from decoder output to Microcode PC input lines -->
			<line x1="1270" y1="82" x2="1265" y2="87" class="arrow-line" />
			<line x1="1270" y1="82" x2="1275" y2="87" class="arrow-line" />

		<g id="McJmp[8]">
			<rect id="id_Microcode_Out[8]dec_a"  x="1135"   y="130"  width="1"    height="25"    class="input-line" />
			<rect id="id_Microcode_Out[8]dec_b"  x="1135"   y="155"  width="40"   height="1"     class="input-line" />
			<rect id="id_Microcode_Out[8]dec_c"  x="1175"   y="155"  width="1"    height="40"    class="input-line" />
			<rect id="id_Microcode_Out[8]dec_d"  x="1175"   y="195"  width="35"   height="1"     class="input-line" />
				<text x="1140" y="144" class="vsmall" onclick="infoOn('mm_to_dec');">Out[8] </text>
				<text x="1182" y="190" class="vsmall">00</text>
		</g>
		<rect id="id_Microcode_Out[2]deccoder_ctl_a"  x="1120"   y="130"   width="1"    height="135"     class="input-line" />
		<rect id="id_Microcode_Out[2]deccoder_ctl_b"  x="1120"   y="265"   width="105"  height="1"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-350 14)" onclick="infoOn('decoder-info');">
				<text x="1128" y="260" class="vsmall">Decoder Ctl[2]</text>
			</g>
		<rect id="id_Microcode_Out[4]ALU_ctl"  x="1100"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 34)" onclick="infoOn('id_ALU_Ctl');" >
				<text x="1128" y="260" class="vsmall" >ALU Ctl[4]</text>
			</g>
		<rect id="id_Microcode_Out[1]memory_read"  x="1080"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 54)" onclick="infoOn('id_memory_Read');" >
				<text x="1128" y="260" class="vsmall" >Memory Read</text>
			</g>
		<rect id="id_Microcode_Out[1]memory_write"  x="1060"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 74)" onclick="infoOn('id_memory_Write');">
				<text x="1128" y="260" class="vsmall">Memory Write</text>
			</g>
		<rect id="id_Microcode_Out[3]pc_ctl"  x="1040"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 94)" onclick="infoOn('id_pc_Ld','id_pc_Inc','id_pc_Out','id_pc_Clr');" >
				<text x="1128" y="260" class="vsmall">PC[4] Ld/Inc/Out/Clr</text>
			</g>
		<rect id="id_Microcode_Out[3]ir_ctl"  x="1020"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 114)" onclick="infoOn('id_ir_Ld','id_ir_Out');" >
				<text x="1128" y="260" class="vsmall">IR[3] Ld/Out/Hand_Out</text>
			</g>
		<rect id="id_Microcode_Out[3]result_ctl"  x="1000"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 134)" onclick="infoOn('id_result_Ld','id_result_Clr','id_result_Out');">
				<text x="1128" y="260" class="vsmall">Result[3] Ld/Clr/Out</text>
			</g>
		<rect id="id_Microcode_Out[3]mar_ctl"  x="980"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 154)" onclick="infoOn('id_mar_Ld','id_mar_Out');">
				<text x="1128" y="260" class="vsmall">MAR[2] Ld/Out</text>
			</g>
		<rect id="id_Microcode_Out[3]mdr_ctl"  x="960"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 174)" onclick="infoOn('id_mdr_Ld','id_mdr_Out');">
				<text x="1128" y="260" class="vsmall">MDR[2] Ld/Out</text>
			</g>
		<rect id="id_Microcode_Out[3]ac_ctl"  x="940"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 194)" onclick="infoOn('id_ac_Ld','id_ac_Out','id_ac_Out_to_ALU');">
				<text x="1128" y="260" class="vsmall">AC[3] Ld/Out/Out_to_ALU</text>
			</g>
		<rect id="id_Microcode_Out[2]output_ctl"  x="920"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 214)" onclick="infoOn('id_output_Ld','id_output_Out');">
				<text x="1128" y="260" class="vsmall">Output[2] Ld/Out</text>
			</g>
		<rect id="id_Microcode_Out[2]input_ctl"  x="900"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 234)" onclick="infoOn('id_input_Ld','id_input_Out');">
				<text x="1128" y="260" class="vsmall">Input[2] Ld/Out</text>
			</g>
		<rect id="id_Microcode_Out[2]mc_ctl"  x="880"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 254)" onclick="infoOn('id_Microcode_PC_Ld','id_Microcode_PC_Clr');">
				<text x="1128" y="260" class="vsmall">Microcode PC[2] Ld/Clr</text>
			</g>

		<rect id="id_Microcode_PC_Out[8]to_Microcode"  x="1150"   y="50"   width="50"   height="1"     class="input-line" />
			<text x="1155" y="35" class="vsmall">Out[8]</text>
			<text x="1155" y="45" class="vsmall">Addr</text>
			<!-- arrow left pointing at microcode store from Microcode PC -->
			<line x1="1152" y1="50" x2="1157" y2="45" class="arrow-line" />
			<line x1="1152" y1="50" x2="1157" y2="55" class="arrow-line" />
		<g id="x_id_Microcode_PC_Inc">
			<rect id="id_Microcode_PC_to_Microcode_PC_Inc_out_a"  x="1150"   y="120"   width="85"   height="1"     class="input-line" />
			<rect id="id_Microcode_PC_to_Microcode_PC_Inc_out_b"  x="1235"   y="80"   width="1"   height="40"     class="input-line" />
				<!-- arrow up from Microcode to Microcode PC Inc line -->
				<line x1="1235" y1="80" x2="1230" y2="87" class="arrow-line" />
				<line x1="1235" y1="80" x2="1240" y2="87" class="arrow-line" />
		</g>
			<text x="1155" y="105" class="vsmall">Out Inc </text>
			<text x="1155" y="115" class="vsmall">Microcode PC</text>

		<rect id="id_decoder_In[8]b"  x="1175"   y="210"  width="35"   height="1"     class="input-line" />
			<text x="1182" y="208" class="vsmall">01</text>
		<rect id="id_decoder_In[8]c"  x="1175"   y="225"  width="35"   height="1"     class="input-line" />
			<text x="1182" y="223" class="vsmall">10</text>
		<rect id="id_decoder_In[8]d"  x="1175"   y="240"  width="35"   height="1"     class="input-line" />
			<text x="1182" y="238" class="vsmall">11</text>

		<text id="h_microcode_pc_txt_0" x="1210" y="55" class="small"></text>

	<!-- id="decoder_ctl_0" -->
	<!-- id="decoder_ctl_1" -->
	<polygon id="id_decoder"
		points=" 1200,180	1200,250 1280,220       1200,180 "
		fill="#f0fff0" stroke="#ff0000" stroke-width="3" />
			<text x="1220" y="180" class="small">Decoder</text>
			<!-- Decoder Output to Microcode_PC Input -->

		<rect id="id_decoder_Ctl_0"  x="1215"   y="244"  width="1"   height="21"     class="input-line" />
		<rect id="id_decoder_Ctl_1"  x="1225"   y="240"  width="1"   height="25"     class="input-line" />
			<text x="1230" y="250" class="vsmall">Ctl</text>

		<text id="h_mux_txt" x="1210" y="220" class="small"></text>

	<rect id="id_main_bus" x="25" y="290" width="1380" height="3" fill="#000000" stroke="#000000" stroke-width="1" />
		<text x="25" y="285" class="small">Bus</text>

		<text id="h_bus_txt_0" x="1360" y="280" class="small"></text>

	<rect id="id_mar" x="275" y="324" width="100" height="50" class="yellow-box" onclick="infoOn('id_mar');" />
		<text x="275" y="319" class="small" onclick="infoOn('id_mar');">MAR</text>
		<rect id="id_mar_Ld" x="375" y="340" width="20" height="1" class="input-line" />
			<text x="379" y="334" class="vsmall" onclick="infoOn('id_mar_Ld');">Ld</text>
		<rect id="id_mar_Out" x="375" y="360" width="20" height="1" class="input-line" />
			<text x="379" y="355" class="vsmall" onclick="infoOn('id_mar_Out');">Out</text>
		<!-- Connection from mar to Bus -->
		<rect id="id_mar_to_bus" x="335" y="290" width="1" height="33" class="input-line" />
		<!-- Connection from mar to Main Memory -->
		<rect id="id_mar_to_memory" x="335" y="375" width="1" height="45" class="input-line" />

			<!-- arrow up for MAR to bus -->
			<line x1="335" y1="293" x2="330" y2="298" class="arrow-line" />
			<line x1="335" y1="293" x2="340" y2="298" class="arrow-line" />
			<!-- arrow down to MAR register, load AC input -->
			<line x1="335" y1="322" x2="330" y2="317" class="arrow-line" />
			<line x1="335" y1="322" x2="340" y2="317" class="arrow-line" />
			<!-- arrow down from MAR register to Main Memory -->
			<line x1="335" y1="420" x2="330" y2="415" class="arrow-line" />
			<line x1="335" y1="420" x2="340" y2="415" class="arrow-line" />

		<text id="h_mar_txt_0" x="285" y="350" class="small"></text>

	<rect id="id_mdr" x="520" y="324" width="100" height="50" class="yellow-box" onclick="infoOn('id_mdr');" />
		<text x="520" y="319" class="small" onclick="infoOn('id_mdr');">MDR</text>
		<rect id="id_mdr_Ld" x="620" y="340" width="20" height="1" class="input-line" />
			<text x="625" y="334" class="vsmall" onclick="infoOn('id_mdr_Ld');">Ld</text>
		<rect id="id_mdr_Out" x="620" y="360" width="20" height="1" class="input-line" />
			<text x="624" y="355" class="vsmall" onclick="infoOn('id_mdr_Out');">Out</text>
		<!-- Connection from mar to Bus -->
		<rect id="id_mdr_to_bus" x="570" y="290" width="1" height="33" class="input-line" />
		<!-- Connection from mdr to Main Memory -->
		<rect id="id_mar_to_memory" x="570" y="375" width="1" height="45" class="input-line" />

			<!-- arrow up for MAR to bus -->
			<line x1="570" y1="293" x2="565" y2="298" class="arrow-line" />
			<line x1="570" y1="293" x2="575" y2="298" class="arrow-line" />
			<!-- arrow down to MAR register, load MAR input -->
			<line x1="570" y1="322" x2="565" y2="317" class="arrow-line" />
			<line x1="570" y1="322" x2="575" y2="317" class="arrow-line" />
			<!-- arrow up to MAR register from Main Memory -->
			<line x1="570" y1="375" x2="565" y2="380" class="arrow-line" />
			<line x1="570" y1="375" x2="575" y2="380" class="arrow-line" />
			<!-- arrow down from MAR register to Main Memory -->
			<line x1="570" y1="420" x2="565" y2="415" class="arrow-line" />
			<line x1="570" y1="420" x2="575" y2="415" class="arrow-line" />

		<text id="h_mdr_txt_0" x="530" y="350" class="small"></text>

	<rect id="id_memory" x="250" y="420" width="400" height="350" fill="#d0d0d0" stroke="#000000" stroke-width="1" onclick="infoOn('id_memory',254,480,400,860);"/>
		<text x="400" y="415" class="small" onclick="infoOn('id_memory');">Main Memory</text>
		<text id="memory_txt_0" x="254" y="440" class="small">Address 8K Words</text>
		<text id="memory_txt_1" x="254" y="460" class="small">Data 16 bits wide</text>
		<rect id="id_memory_Read" x="650" y="440" width="40" height="1" class="input-line" />
			<text x="655" y="434" class="vsmall" onclick="infoOn('id_memory_Read');">Read</text>
		<rect id="id_memory_Write" x="650" y="460" width="40" height="1" class="input-line" />
			<text x="655" y="454" class="vsmall" onclick="infoOn('id_memory_Write');">Write</text>

		<text id="h_memory_0"   x="254" y="435" class="small" ></text>
		<text id="h_memory_1"   x="254" y="455" class="small" ></text>
		<text id="h_memory_2"   x="254" y="475" class="small" ></text>
		<text id="h_memory_3"   x="254" y="495" class="small" ></text>
		<text id="h_memory_4"   x="254" y="515" class="small" ></text>
		<text id="h_memory_5"   x="254" y="535" class="small" ></text>
		<text id="h_memory_6"   x="254" y="555" class="small" ></text>
		<text id="h_memory_7"   x="254" y="575" class="small" ></text>
		<text id="h_memory_8"   x="254" y="595" class="small" ></text>
		<text id="h_memory_9"   x="254" y="615" class="small" ></text>
		<text id="h_memory_10"  x="254" y="635" class="small" ></text>
		<text id="h_memory_11"  x="254" y="655" class="small" ></text>
		<text id="h_memory_12"  x="254" y="675" class="small" ></text>
		<text id="h_memory_13"  x="254" y="695" class="small" ></text>
		<text id="h_memory_14"  x="254" y="715" class="small" ></text>
		<text id="h_memory_15"  x="254" y="735" class="small" ></text>
		<text id="h_memory_16"  x="254" y="755" class="small" ></text>

	<rect id="id_output" x="1200" y="324" width="100" height="50" class="white-box" onclick="infoOn('id_output');" />
		<text x="1200" y="319" class="small" onclick="infoOn('id_output');">Output</text>
		<rect id="id_output_Ld" x="1300" y="340" width="20" height="1" class="input-line" />
			<text x="1305" y="334" class="vsmall" onclick="infoOn('id_output_Ld');">Ld</text>
		<rect id="id_output_Out" x="1300" y="360" width="20" height="1" class="input-line" />
			<text x="1305" y="355" class="vsmall" onclick="infoOn('id_output_Out');">Out</text>
		<!-- Connection from output to Bus -->
		<rect id="id_output_to_bus" x="1270" y="290" width="1" height="33" class="input-line" />

			<!-- arrow up for Output to bus -->
			<line x1="1270" y1="293" x2="1265" y2="298" class="arrow-line" />
			<line x1="1270" y1="293" x2="1275" y2="298" class="arrow-line" />
			<!-- arrow down to Output register, load Output input -->
			<line x1="1270" y1="322" x2="1265" y2="317" class="arrow-line" />
			<line x1="1270" y1="322" x2="1275" y2="317" class="arrow-line" />

		<text id="h_input_txt_0" x="1210" y="350" class="small"></text>

	<rect id="id_input" x="1000" y="324" width="100" height="50" class="white-box" onclick="infoOn('id_input');"/>
		<text x="1000" y="319" class="small"onclick="infoOn('id_input');">Input</text>
		<rect id="id_input_Ld" x="1100" y="340" width="20" height="1" class="input-line" />
			<text x="1105" y="334" class="vsmall" onclick="infoOn('id_input_Ld');">Ld</text>
		<rect id="id_input_Out" x="1100" y="360" width="20" height="1" class="input-line" />
			<text x="1105" y="355" class="vsmall" onclick="infoOn('id_input_Out');">Out</text>
		<!-- Connection from input to Bus -->
		<rect id="id_input_to_bus" x="1050" y="290" width="1" height="33" class="input-line" />

			<!-- arrow up for Input to bus -->
			<line x1="1050" y1="293" x2="1045" y2="298" class="arrow-line" />
			<line x1="1050" y1="293" x2="1055" y2="298" class="arrow-line" />
			<!-- arrow down to Input register, load Input input -->
			<line x1="1050" y1="322" x2="1045" y2="317" class="arrow-line" />
			<line x1="1050" y1="322" x2="1055" y2="317" class="arrow-line" />

		<text id="h_output_txt_0" x="1010" y="350" class="small"></text>



<!-- Text Output Area -->
	<rect id="out_box" x="750" y="420" width="650" height="350" class="out-box" />
	<text id="line_0"  x="755" y="435" class="small" ></text>
	<text id="line_1"  x="755" y="455" class="small" ></text>
	<text id="line_2"  x="755" y="475" class="small" ></text>
	<text id="line_3"  x="755" y="495" class="small" ></text>
	<text id="line_4"  x="755" y="515" class="small" ></text>
	<text id="line_5"  x="755" y="535" class="small" ></text>
	<text id="line_6"  x="755" y="555" class="small" ></text>
	<text id="line_7"  x="755" y="575" class="small" ></text>
	<text id="line_8"  x="755" y="595" class="small" ></text>
	<text id="line_9"  x="755" y="615" class="small" ></text>
	<text id="line_10" x="755" y="635" class="small" ></text>
	<text id="line_11" x="755" y="655" class="small" ></text>
	<text id="line_12" x="755" y="675" class="small" ></text>
	<text id="line_13" x="755" y="695" class="small" ></text>
	<text id="line_14" x="755" y="715" class="small" ></text>
	<text id="line_15" x="755" y="735" class="small" ></text>
	<text id="line_16" x="755" y="755" class="small" ></text>




<!-- MM to Dec input - mixed with other inputs. -->
	<!--
		<g id="McJmp[8]">
			<rect id="id_Microcode_Out[8]dec_a"  x="1135"   y="130"  width="1"    height="25"    class="input-line" />
			<rect id="id_Microcode_Out[8]dec_b"  x="1135"   y="155"  width="40"   height="1"     class="input-line" />
			<rect id="id_Microcode_Out[8]dec_c"  x="1175"   y="155"  width="1"    height="40"    class="input-line" />
			<rect id="id_Microcode_Out[8]dec_d"  x="1175"   y="195"  width="35"   height="1"     class="input-line" />
				<text x="1140" y="144" class="vsmall">Out[8] </text>
				<text x="1182" y="190" class="vsmall">00</text>
		</g>
		showLine("#ir_15_12_to_decoder_11","#mm_to_dec_11");
	-->
	<path id="mm_to_dec_11" class="blue-line"
		d="M 1135 130   L 1135 155  1170 155  1170 240  1200 240  "
		/>
	<path id="mm_to_dec_10" class="blue-line"
		d="M 1135 130   L 1135 155  1170 155  1170 225  1200 225 "
		/>
	<path id="mm_to_dec_01" class="blue-line"
		d="M 1135 130   L 1135 155  1170 155  1170 210  1200 210 "
		/>
	<path id="mm_to_dec_00" class="blue-line"
		d="M 1135 130   L 1135 155  1170 155  1170 195  1200 195 "
		/>
<!-- Blue Connection Lines ==== 900 is 1st line out on MM -->
	<!--
		<g id="x_id_Microcode_PC_Inc">
			<rect id="id_Microcode_PC_to_Microcode_PC_Inc_out_a"  x="1150"   y="120"   width="85"   height="1"     class="input-line" />
			<rect id="id_Microcode_PC_to_Microcode_PC_Inc_out_b"  x="1235"   y="80"   width="1"   height="40"     class="input-line" />
	-->
	<path id="id_Microcode_PC_Inc" class="blue-line"
		d="M 1150 120   L 1150 120  1235 120 1235 80 "
		/>
	<path id="pc_Ld_to_microcode" class="blue-line"
		d="M 125 40   L 160 40  160 220  700 220  700 280 1040 280 1040 130  "
		/>
	<path id="pc_Inc_to_microcode" class="blue-line"
		d="M 125 60   L 160 60  160 220  700 220  700 280 1040 280 1040 130  "
		/>
	<path id="pc_Out_to_microcode" class="blue-line"
		d="M 125 80   L 160 80  160 220  700 220  700 280 1040 280 1040 130  "
		/>
	<path id="pc_Clr_to_microcode" class="blue-line"
		d="M 125 100   L 160 100  160 220  700 220  700 280 1040 280 1040 130  "
		/>

	<path id="ir_Ld_to_microcode" class="blue-line"
		d="M 225 40   L 270 40  270 220  700 220  700 280 1020 280 1020 130  "
		/>
	<path id="ir_Out_to_microcode" class="blue-line"
		d="M 225 60   L 270 60  270 220  700 220  700 280 1020 280 1020 130  "
		/>
	<!-- Hand Output to Microcode ,"#Hand_Out_to_microcode" -->
	<path id="hand_out" class="blue-line"
		d="M 225 250   L 700 250  700 280 1020 280 1020 130  "
		/>

	<path id="ir_15_12_to_decoder_11" class="blue-line"
		d="M 200 170   L  705 170  705 280   1170 280 1170 240  1200 240 "
		/>
	<path id="ir_11_8_to_decoder_10" class="blue-line"
		d="M 200 200   L  705 200  705 280   1170 280 1170 225  1200 225 "
		/>

	<g id="alu_ctl_4_to_microcode">
		<rect id="id_ALU_ctl_0" x="420" y="108" width="1" height="45" class="blue-line-1" />
		<rect id="id_ALU_ctl_1" x="425" y="110" width="1" height="43" class="blue-line-1" />
		<rect id="id_ALU_ctl_2" x="430" y="112" width="1" height="41" class="blue-line-1" />
		<rect id="id_ALU_ctl_3" x="435" y="113" width="1" height="40" class="blue-line-1" />
		<path id="alu_ctl_to_microcode_a" class="blue-line-1" d="M 420 152   L  427 160  " />
		<path id="alu_ctl_to_microcode_b" class="blue-line-1" d="M 425 152   L  427 160  " />
		<path id="alu_ctl_to_microcode_c" class="blue-line-1" d="M 430 152   L  428 160  " />
		<path id="alu_ctl_to_microcode_d" class="blue-line-1" d="M 435 152   L  428 160  " />
		<path id="alu_ctl_to_microcoee_e" class="blue-line"
			d="M 428.5 160   L  428.5 280  705 280   700 280  1100 280 1100 130  "
			/>
	</g>


<!-- -->
	<path id="result_Ld_to_microcode" class="blue-line"
		d="M 350 40   L  390 40   390 280    1000 280 1000 130  "
		/>
	<path id="result_Out_to_microcode" class="blue-line"
		d="M 350 60   L  390 60   390 280    1000 280 1000 130  "
		/>
	<path id="result_Clr_to_microcode" class="blue-line"
		d="M 350 100  L  390 100 390 280     1000 280 1000 130  "
		/>
	<path id="result_zero_out" class="blue-line"
		d="M 350 120  L  390 120  390 280    1170 280 1170 210  1200 210 "
		/>


<!-- -->
	<path id="ac_Ld_to_microcode" class="blue-line"
		d="M 650 40   L  690 40   690 280     940 280 940 130  "
		/>
	<path id="ac_Out_to_microcode" class="blue-line"
		d="M 650 60   L  690 60   690 280     940 280 940 130  "
		/>
	<path id="ac_Out_to_ALU" class="blue-line"
		d="M 650 80  L  690 80    690 280     940 280 940 130  "
		/>

<!-- MDR -->
	<path id="mdr_Ld_to_microcode" class="blue-line"
		d="M 620 340   L  690 340   690 280     960 280 960 130  "
		/>
	<path id="mdr_Out_to_microcode" class="blue-line"
		d="M 620 360   L  690 360   690 280     960 280 960 130  "
		/>

<!-- MAR -->
	<path id="mar_Ld_to_microcode" class="blue-line"
		d="M 375 340   L  450 340   450 280     980 280 980 130  "
		/>
	<path id="mar_Out_to_microcode" class="blue-line"
		d="M 375 360   L  450 360   450 280     980 280 980 130  "
		/>


<!-- input -->
	<path id="input_Ld_to_microcode" class="blue-line"
		d="M 1100 340   L  1150 340   1150 280     900 280 900 130  "
		/>
	<path id="input_Out_to_microcode" class="blue-line"
		d="M 1100 360   L  1150 360   1150 280     900 280 900 130  "
		/>


<!-- output -->
	<path id="output_Ld_to_microcode" class="blue-line"
		d="M 1300 340   L  1350 340   1350 280     920 280 920 130  "
		/>
	<path id="output_Out_to_microcode" class="blue-line"
		d="M 1300 360   L  1350 360   1350 280     920 280 920 130  "
		/>



<!-- Microcode PC -->
	<path id="Microcode_PC_Ld_to_microcode" class="blue-line"
		d="M 1300 40   L  1350 40   1350 280     880 280 880 130  "
		/>
	<path id="Microcode_PC_Clr_to_microcode" class="blue-line"
		d="M 1300 60   L  1350 60   1350 280     880 280 880 130  "
		/>


<!-- Main Memory -->
<!--
	<rect id="id_memory" x="250" y="420" width="400" height="250" fill="#d0d0d0" stroke="#000000" stroke-width="1" onclick="infoOn('id_memory',254,480,400,860);"/>
		<text x="400" y="415" class="small">Main Memory</text>
		<text x="254" y="440" class="small">Address 8K Words</text>
		<text x="254" y="460" class="small">Data 16 bits wide</text>
		<rect id="id_mdr_Ld" x="650" y="440" width="40" height="1" class="input-line" />
			<text x="655" y="434" class="vsmall">Read</text>
		<rect id="id_mdr_Ld" x="650" y="460" width="40" height="1" class="input-line" />
			<text x="655" y="454" class="vsmall">Write</text>
-->
	<path id="Main_Memory_Read" class="blue-line"
		d="M 650 440   L  730 440   730 280     1080 280 1080 130  "
		/>
	<path id="Main_Memory_Write" class="blue-line"
		d="M 650 460   L  730 460   730 280     1060 280 1060 130  "
		/>

<!--
		<rect id="id_Microcode_Out[2]deccoder_ctl_a"  x="1120"   y="130"   width="1"    height="135"     class="input-line" />
		<rect id="id_Microcode_Out[2]deccoder_ctl_b"  x="1120"   y="265"   width="105"  height="1"     class="input-line" />
				1120+105 =
			<g transform="rotate(90 1000 400) translate(-350 14)" onclick="infoOn('decoder-info');">
-->
	<path id="microcode_to_decoder_ctl" class="blue-line"
		d="M 1120 130   L  1120 265  1225 265 1225 240 M 1215 245 L 1215 265"
		/>


<!-- Buttons -->
		<rect id="b-help"            x="40" y="300" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('help');"/>
		<text id="b-help-txt"        x="45" y="317" class="small" onclick="infoOn('help');">Help</text>

		<rect id="b-clear-line"      x="40" y="330" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('clear-line');"/>
		<text id="b-clear-line-txt"  x="45" y="347" class="small" onclick="infoOn('clear-line');">Clear Lines</text>

		<rect id="b-load-memory"     x="40" y="360" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('load-memory');"/>
		<text id="b-load-memory-txt" x="45" y="377" class="small" onclick="infoOn('load-memory');">Load Memory</text>

		<rect id="b-step"            x="40" y="390" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('step');"/>
		<text id="b-step-txt"        x="45" y="407" class="small" onclick="infoOn('step');">Step Tick</text>

		<rect id="b-run"             x="40" y="420" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('run');"/>
		<text id="b-run-txt"         x="45" y="437" class="small" onclick="infoOn('run');">Run</text>

		<rect id="b-input"           x="40" y="450" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('input');"/>
		<text id="b-input-txt"       x="45" y="467" class="small" onclick="infoOn('input');">Input</text>

		<rect id="b-reset"           x="40" y="480" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('reset');"/>
		<text id="b-reset-txt"       x="45" y="497" class="small" onclick="infoOn('reset');">Reset</text>

		<rect id="b-load-mc"         x="40" y="510" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('load-mc');"/>
		<text id="b-load-mc-txt"     x="45" y="527" class="small" onclick="infoOn('load-mc');">Load Microcode</text>

		<rect id="b-step-ins"        x="40" y="540" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('step-ins');"/>
		<text id="b-step-ins-txt"    x="45" y="557" class="small" onclick="infoOn('step-ins');">Step Instruction</text>

		<rect id="b-setup-cfg"       x="40" y="570" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('setup-cfg');"/>
		<text id="b-setup-cfg-txt"   x="45" y="587" class="small" onclick="infoOn('setup-cfg');">Setup</text>

		<rect id="b-logic-probe"     x="40" y="600" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('logic-probe');"/>
		<text id="b-logic-probe-txt" x="45" y="617" class="small" onclick="infoOn('logic-probe');">Logic Probe</text>

		<rect id="b-show-memory"     x="40" y="630" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('show-memory');"/>
		<text id="b-show-memory-txt" x="45" y="647" class="small" onclick="infoOn('show-memory');">Show Memory</text>






 </g>
</svg>

<!-- The Modal ======================================================== -->
<div id="myModal" class="modal">

	<!-- Modal content -->
	<div class="modal-content">
		<div class="modal-header">
			<span class="close" onclick="hideModal();">&times;</span>
			<h4>Load Code Into Microcode Memory</h4>
		</div>
		<div class="modal-body">
			<p>Enter the hash printed out by McAsm with the --upload flag.</p>
			<input id="modal-input-code-hash" spellcheck="false" name="i_hash" class="hash-input">
		</div>
		<div class="modal-footer">
			<button class="modal-submit" type="button" id="modal-submit" onclick="LoadMC();">Load Code</button>
		</div>
	</div>

</div>

<script>

// Get the modal
var modal = document.getElementById("myModal");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal 
function displayModal () {
  modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
function hideModal() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
	if (event.target == modal) {
		modal.style.display = "none";
	}
}

// Equvelance classes for wires - What is wired to what.

var ConnectionsWiredTogether = {
	// infoOn Name you use to turn on/off the line
	//			// Connected To [ last one is the Microcode connection if it starts with id_Microcoude_Out[...
	//			// Fisr one is line between that gets turned on-off
	  "__From": [ "__To1", "__To2" ]		// Example
	, "id_memory_Read" : [ "Main_Memory_Read", "id_Microcode_Out[1]memory_read" ]
	, "id_memory_Write" : [ "Main_Memory_Write", "id_Microcode_Out[1]memory_write" ]
};

var lineOn = [
	 "#pc_Ld_to_microcode"
	,"#pc_Inc_to_microcode"
	,"#pc_Out_to_microcode"
	,"#pc_Clr_to_microcode" 
	,"#ir_15_12_to_decoder_11" 
	,"#ir_11_8_to_decoder_10"
	,"#ir_Ld_to_microcode" 
	,"#ir_Out_to_microcode"
	,"#alu_ctl_4_to_microcode"
	,"#result_Ld_to_microcode" 
	,"#result_Out_to_microcode"
	,"#result_Clr_to_microcode"
	,"#result_zero_out" 
	,"#ac_Ld_to_microcode"
	,"#ac_Out_to_microcode"
	,"#ac_Out_to_ALU"
	,"#mar_Ld_to_microcode" 
	,"#mar_Out_to_microcode"
	,"#mdr_Ld_to_microcode" 
	,"#mdr_Out_to_microcode"
	,"#input_Ld_to_microcode" 
	,"#input_Out_to_microcode"
	,"#output_Ld_to_microcode" 
	,"#output_Out_to_microcode"
	,"#Microcode_PC_Ld_to_microcode"
	,"#Microcode_PC_Clr_to_microcode"
	,"#Main_Memory_Read" 
	,"#Main_Memory_Write"
	,"#hand_out"
	,"#microcode_to_decoder_ctl"
	,"#id_Microcode_PC_Inc" 
	,"#mm_to_dec_11" 
	,"#mm_to_dec_10" 
	,"#mm_to_dec_01" 
	,"#mm_to_dec_00" 
];	// List of IDs of lines that are turned-on

function clearOtherLine() {
	for ( var i = 0; i < lineOn.length; i++ ) {
		var x = lineOn[i];
		$(x).hide()
	}
	lineOn = [];	
}

clearOtherLine();

function showLine(id) {
	// clearOtherLine()
	var i = 0;
	for ( var j = 0, mx = arguments.length; j < mx && i < 16; i++, j++ ) {
		id = arguments[j];
		$(id).show();
		lineOn.push(id);
	}
}

var textCur = 0;

function clearText() {
	for ( var i = 0; i < 16; i++ ) {
		$("#line_"+i).html("");
	}
	textCur = 0;
}

function showTextInOutputBox(text) {
	var i = textCur;
	for ( var j = 0, mx = arguments.length; j < mx && i < 16; i++, j++ ) {
		var x = arguments[i];
		// console.log ( "i=", i, "j=", j, x );
		$("#line_"+i).html(arguments[j]);
		textCur++;
	}
}

function infoOn(x) {
	clearOtherLine();
	clearText();
	for ( var i = 0, mx = arguments.length; i < mx; i++ ) {
		var x = arguments[i];
		infoOn1(i,x);
	}
}

function infoOn1(i,x) {

	console.log("svg/id["+i+"]:"+x);
	switch ( x ) {

	case "clear-line":
		break;
	case "help":
		showTextInOutputBox("MARIA Microcode Emulator: Version v0.3.0"
			,"Load assembled microcode and assembled instructions, then step or run."
			,""
			,"https://github.com/Univ-Wyo-Education/S20-2150/McDocs/ for more detailed help."
			,""
			,"Click on a line to see where the input connects to.  Try Ld near the PC register."
			);
		break;
	case "load-mc":
		console.log ( "load-mc - load microcode" );
		displayModal() ;
		// Display Form - setup for "Submit" button.
		break;
	case "decoder-info":
		showLine("#microcode_to_decoder_ctl");
		showTextInOutputBox("Decoder takes 2 input lines and has 4 8-wide inputs connecting to 1 8-wide output."
			,"The control lines select the input source."
			,"Lines that are not hooked to other sources are Out_7 to Out_0 from the Microcode."
			, ""
			," CTL   Instruction"
			," ---  -----------------------------------------------------"
			,"  00   Microcode Jmp (Halt, Unused)"
			,"  01   Jump if (Is Zero) from Result/Cmp - Microcode PC Inc Twice"
			,"  10   Skip { SkipEe0, SkipGt0, SkipLt0 }"
			,"  11   Common IR Decode"
			);
		break;
		// <g transform="rotate(90 1000 400) translate(-350 14)" onclick="infoOn('decoder-info');">


	case "id_pc":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("PC - Program Counter");
		break;
	case "id_pc_Ld":
		showLine("#pc_Ld_to_microcode");
		showTextInOutputBox("pc_Ld - Load Register");
		break;
	case "id_pc_Inc":
		showLine("#pc_Inc_to_microcode");
		showTextInOutputBox("pc_Inc - Increment Register");
		break;
	case "id_pc_Out":
		showLine("#pc_Out_to_microcode");
		showTextInOutputBox("pc_Out - Output Register to Bus");
		break;
	case "id_pc_Clr":
		showLine("#pc_Clr_to_microcode");
		showTextInOutputBox("pc_Clr - Clear Register, set to 0");
		break;


	case "id_ir":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("IR - Instruction Register");
		break;
	case "id_ir_Ld":
		showLine("#ir_Ld_to_microcode");
		break;
	case "id_ir_Out":
		showLine("#ir_Out_to_microcode");
		break;
// ,"#Hand_Out_to_microcode"
	case "hand_out":
		showTextInOutputBox("Take the least-significant 12 bits of the IR and puts that on the bus - with 0's for the most","significant nibble (4 bits).","","IR_Out must be enabled at the same time.");
		showLine("#hand_out");
		break;


	case "id_result":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("Result - Output from ALU");
		break;
	case "id_result_Ld":
		showLine("#result_Ld_to_microcode");
		break;
	case "id_result_Out":
		showLine("#result_Out_to_microcode");
		break;
	case "id_result_Clr":
		showLine("#result_Clr_to_microcode");
		break;
	case "id_result_zero_out":
		showLine("#result_zero_out","#mm_to_dec_01");
		showTextInOutputBox("Connects 1 bit to decoder input 01.","The other addresses come from the McJmp_X");
		break;

	case "id_ac":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("AC - Accumulator");
		break;
	case "id_ac_Ld":
		showLine("#ac_Ld_to_microcode");
		break;
	case "id_ac_Out":
		showLine("#ac_Out_to_microcode");
		break;
	case "id_ac_Out_to_ALU":
		showLine("#ac_Out_to_ALU");
		break;

	case "id_ALU_Ctl":
		showLine("#alu_ctl_4_to_microcode");
		showTextInOutputBox("4 control lines for determining the Arithmetic or Logic Operation performed.");
		break;

//	,"#mar_Ld_to_microcode" 
//	,"#mar_Out_to_microcode"
	case "id_mar":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("MAR - Memory Address Register");
		break;
	case "id_mar_Ld":
		showLine("#mar_Ld_to_microcode");
		break;
	case "id_mar_Out":
		showLine("#mar_Out_to_microcode");
		break;

//	,"#mdr_Ld_to_microcode" 
//	,"#mdr_Out_to_microcode"
	case "id_mdr":
		showTextInOutputBox("MDR (mbr) - Memory Data Register - Buffer memory read/write");
		$("#"+x).css("fill","#ff0000");
		break;
	case "id_mdr_Ld":
		showLine("#mdr_Ld_to_microcode");
		break;
	case "id_mdr_Out":
		showLine("#mdr_Out_to_microcode");
		break;

//	,"#input_Ld_to_microcode" 
//	,"#input_Out_to_microcode"
	case "id_input":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("Input Register","You need to set the input value before the input instruction runs.");
		break;
	case "id_input_Ld":
		showLine("#input_Ld_to_microcode");
		break;
	case "id_input_Out":
		showLine("#input_Out_to_microcode");
		break;

//	,"#output_Ld_to_microcode" 
//	,"#output_Out_to_microcode"
	case "id_output":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("Output from the CPU");
		break;
	case "id_output_Ld":
		showLine("#output_Ld_to_microcode");
		break;
	case "id_output_Out":
		showLine("#output_Out_to_microcode");
		break;


//	,"#Microcode_PC_Ld_to_microcode"
//	,"#Microcode_PC_Clr_to_microcode"
	case "id_Microcode_PC":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("PC for the Microcode Instructions");
		break;
	case "id_Microcode_PC_Ld":
		showLine("#Microcode_PC_Ld_to_microcode");
		break;
	case "id_Microcode_PC_Clr":
		showLine("#Microcode_PC_Clr_to_microcode");
		break;


	case "id_microcode":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("The Microcode Instructions");
		break;


//	,"#Main_Memory_Read" 
//	,"#Main_Memory_Write"
	case "id_memory":
		$("#"+x).css("fill","#ff0000");
		break;
	case "id_memory_Read":
		showLine("#Main_Memory_Read");
		break;
	case "id_memory_Write":
		showLine("#Main_Memory_Write");
		break;


	case "ir_decode_g1":
		showLine("#ir_15_12_to_decoder_11","#mm_to_dec_11");
		showTextInOutputBox("Instruction decode uses 1 bit of output from the Microcode Out[8] (Out_7)"
			,"then 4 bits of the IR, the 3 bits of Out[8] (Out_2, Out_1, Out_0)."
			,""
			,"Given that Out_7 is a one for the high addresses of the memory, then the instruction"
			,"0x2034 (Store) will jump to address 0b1_0010_000);  Set the Microcode_Ld to 1 and"
			,"the decoder_ctl_1 and decoder_clt_0 to 0b11 to select and load this address."
			,""
			,"The hand_Out gives us access in to the 12 bits of operand, the 034 portion of the instruction."
			,"Transfer the AC to the MDR with AC_Out = 1, and MDR_Ld = 1, then set the MAR_Ld to 1 and"
			,"the hand_Out to 1 to transfer the address from the IR to the MAR.  Then Memory_Write = 1"
			,"and the data is written to memory."
			);
		break;
	case "ir_decode_g2":
		showLine("#ir_11_8_to_decoder_10","#mm_to_dec_10");	// xyzzy
		showTextInOutputBox("Instruction decode use 01 bit of output from the Microcode Out[8] (Out_7, Out_6)","then 4 bits of the IR, the 2 bits of Out[8] (Out_1, Out_0).");
			// xyzzy - add addressing example
		break;

	case "mm_to_dec":
		showLine( "#mm_to_dec_11" ,"#mm_to_dec_10" ,"#mm_to_dec_01" ,"#mm_to_dec_00" );
		showTextInOutputBox("Output from the microcode is mixed with other output to produce a microcode jump address.");
		break;
		
	}
}


function toHex(d, padding) {
    var hex = Number(d).toString(16);
    padding = typeof (padding) === "undefined" || padding === null ? padding = 2 : padding;
    while (hex.length < padding) {
        hex = "0" + hex;
    }
    return hex;
}
function toBin(d, padding) {
    var bin = Number(d).toString(2);
    padding = typeof (padding) === "undefined" || padding === null ? padding = 2 : padding;
    while (bin.length < padding) {
        bin = "0" + bin;
    }
    return bin;
}

var theWorld = {
	"Bus": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.Bus._used_ ) {
				return ( theWorld.Bus._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'bus.State' when undefined" );
					theWorld.Bus._error_.push( "Warning: Pulling 'bus.State' when undefined" );
				}
				return ( theWorld.Bus._data_ );
			}
		}
		, "SetState": function ( v ) {		//xyzzy - add in who is setting!
			// if ( theWorld.Bus._used_ ) {
			// 	theWorld.Bus._error_.push ( "Multiple SetState on the bus!" );
			// }
			theWorld.Bus._data_ = v;
			theWorld.Bus._used_ = true;
			var sVal = toHex(v,4);
			displayMainBus(sVal);
		}
		, "TickRise": function ( v ) {
			theWorld.Bus._data_ = undefined;
			theWorld.Bus._used_ = false;
			clearMainBus();
		}
		, "Error": function ( v ) {
			return ( theWorld.Bus._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.Bus._error_ = [];
		}
	}
	,"IsZero": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.IsZero._used_ ) {
				return ( theWorld.IsZero._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'IsZero.State' when undefined" );
					theWorld.IsZero._error_.push( "Warning: Pulling 'IsZero.State' when undefined" );
				}
				return ( theWorld.IsZero._data_ );
			}
		}
		, "SetState": function ( v ) {
			theWorld.IsZero._data_ = v;
			theWorld.IsZero._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.IsZero._data_ = undefined;
			theWorld.IsZero._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.IsZero._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.IsZero._error_ = [];
		}
	}
	,"IR_15__12": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.IR_15__12._used_ ) {
				return ( theWorld.IR_15__12._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'IR_15__12.State' when undefined" );
					theWorld.IR_15__12._error_.push( "Warning: Pulling 'IR_15__12.State' when undefined" );
				}
				return ( theWorld.IR_15__12._data_ );
			}
		}
		, "SetState": function ( v ) {
			theWorld.IR_15__12._data_ = v;
			theWorld.IR_15__12._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.IR_15__12._data_ = undefined;
			theWorld.IR_15__12._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.IR_15__12._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.IR_15__12._error_ = [];
		}
	}
	,"IR_11__8": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.IR_11__8._used_ ) {
				return ( theWorld.IR_11__8._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'IR_11__8.State' when undefined" );
					theWorld.IR_11__8._error_.push( "Warning: Pulling 'IR_11__8.State' when undefined" );
				}
				return ( theWorld.IR_11__8._data_ );
			}
		}
		, "SetState": function ( v ) {
			theWorld.IR_11__8._data_ = v;
			theWorld.IR_11__8._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.IR_11__8._data_ = undefined;
			theWorld.IR_11__8._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.IR_11__8._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.IR_11__8._error_ = [];
		}
	}
	,"hand": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.hand._used_ ) {
				return ( theWorld.hand._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'hand.State' when undefined" );
					theWorld.hand._error_.push( "Warning: Pulling 'hand.State' when undefined" );
				}
				return ( theWorld.hand._data_ );
			}
		}
		, "SetState": function ( v ) {
			theWorld.hand._data_ = v;
			theWorld.hand._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.hand._data_ = undefined;
			theWorld.hand._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.hand._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.hand._error_ = [];
		}
	}
	,"MAR_to_Memory": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.MAR_to_Memory._used_ ) {
				return ( theWorld.MAR_to_Memory._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'bus.State' when undefined" );
					theWorld.MAR_to_Memory._error_.push( "Warning: Pulling 'bus.State' when undefined" );
				}
				return ( theWorld.MAR_to_Memory._data_ );
			}
		}
		, "SetState": function ( v ) {
			theWorld.MAR_to_Memory._data_ = v;
			theWorld.MAR_to_Memory._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.MAR_to_Memory._data_ = undefined;
			theWorld.MAR_to_Memory._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.MAR_to_Memory._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.MAR_to_Memory._error_ = [];
		}
	}
	,"MDR_to_Memory": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.MDR_to_Memory._used_ ) {
				return ( theWorld.MDR_to_Memory._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'bus.State' when undefined" );
					theWorld.MDR_to_Memory._error_.push( "Warning: Pulling 'bus.State' when undefined" );
				}
				return ( theWorld.MDR_to_Memory._data_ );
			}
		}
		, "SetState": function ( v ) {
			theWorld.MDR_to_Memory._data_ = v;
			theWorld.MDR_to_Memory._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.MDR_to_Memory._data_ = underfined;
			theWorld.MDR_to_Memory._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.MDR_to_Memory._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.MDR_to_Memory._error_ = [];
		}
	}

//	,"id_pc_Out": {
//		"_data_": 0
//		, "_used_": false
//		, "_error_": []
//		, "State": function () {
//			if ( theWorld.id_pc_Out._used_ ) {
//				return ( theWorld.id_pc_Out._data_ );
//			} else {
//				var ignore = false;
//				if ( arguments.length > 0 ) {
//					ignore = arguments[0];
//				}
//				if ( ! ignore ) {
//					console.log ( "Warning: Pulling 'bus.State' when undefined" );
//					theWorld.id_pc_Out._error_.push( "Warning: Pulling 'bus.State' when undefined" );		// xyzzy - 
//				}
//				return ( theWorld.id_pc_Out._data_ );
//			}
//		}
//		, "SetState": function ( v ) {
//			theWorld.id_pc_Out._data_ = v;
//			theWorld.id_pc_Out._used_ = true;
//console.log ( "PC.msg('Out') -- Called --" );
//			PC.msg ( "Out", 1 );						// connection from "wire" to chip.
//		}
//		, "TickRise": function ( v ) {
//			theWorld.id_pc_Out._data_ = underfined;
//			theWorld.id_pc_Out._used_ = false;
//			PC.rise();
//		}
//		, "Error": function ( v ) {
//			return ( theWorld.id_pc_Out._error_ );
//		}
//		, "ClearError": function ( v ) {
//			theWorld.id_pc_Out._error_ = [];
//		}
//	}

};

var Connections = {
	  "id_pc_Out": { Name:"PC",						Op: ["Out"]      	}
	, "id_pc_Ld": { Name:"PC",						Op: ["Ld"]      	}
	, "id_pc_Inc": { Name:"PC",						Op: ["Inc"]      	}
	, "id_Microcode_PC_Clr": { Name:"MICROCODE_PC",	Op: ["Clr"]      	} 
	, "id_Microcode_PC_Ld": { Name:"MICROCODE_PC",	Op: ["Ld"]      	}
	, "id_Microcode_PC_Inc": { Name:"MICROCODE_PC", Op: ["Inc"]      	}
	, "id_ac_Clr": { Name:"AC",						Op: ["Clr"]      	}
	, "id_ac_Inc": { Name:"AC",						Op: ["Inc"]      	}
	, "id_ac_Ld": { Name:"AC",						Op: ["Ld"]      	}
	, "id_ac_Out": { Name:"AC",						Op: ["Out"]      	}
	, "id_ac_Out_to_ALU": { Name:"AC",				Op: ["Out_to_ALU"] 	}
	, "id_input_Out": { Name:"INPUT",				Op: ["Out"]      	}
	, "id_input_Ld": { Name:"INPUT",				Op: ["Ld"]      	}
	, "id_ir_Ld": { Name:"IR",						Op: ["Ld"]      	}
	, "id_ir_Out": { Name:"IR",						Op: ["Out"]      	}
	, "id_mar_Ld": { Name:"MAR",					Op: ["Ld"]      	}
	, "id_mar_Out": { Name:"MAR",					Op: ["Out"]      	}
	, "id_mdr_Ld": { Name:"MDR",					Op: ["Ld"]      	}
	, "id_mdr_Out": { Name:"MDR",					Op: ["Out"]      	}
	, "id_memory_Read": { Name:"MEMORY",			Op: ["Read"]      	}
	, "id_memory_Write": { Name:"MEMORY",			Op: ["Write"]      	}
	, "id_output_Ld": { Name:"OUTPUT",				Op: ["Ld"]      	}
	, "id_output_Out": { Name:"OUTPUT",				Op: ["Out"]      	}
	, "id_result_Ld": { Name:"RESULT",				Op: ["Ld"]      	}
	, "id_result_Out": { Name:"RESULT",				Op: ["Out"]      	}
	
	//                                                   Always Jump -- All Bits
	//                                                          IsZero - one bit
	//                                                                  2nd Decode - Instruction IR Bits 11..8
	//                                                                         1st Decode - Instruction MSB 15..12 of IR
	, "McJmp_7": { Name: "MUX", 					Op: ["00_7","01_7","10_7","11_7"] }
	, "McJmp_6": { Name: "MUX", 					Op: ["00_6","01_6","10_6"       ] }
	, "McJmp_5": { Name: "MUX", 					Op: ["00_5","01_5"              ] }
	, "McJmp_4": { Name: "MUX", 					Op: ["00_4","01_4"              ] }
	, "McJmp_3": { Name: "MUX", 					Op: ["00_3","01_3"              ] }
	, "McJmp_2": { Name: "MUX", 					Op: ["00_2","01_2"       ,"11_2"] }	
	, "McJmp_1": { Name: "MUX", 					Op: ["00_1"       ,"10_1","11_1"] }
	, "McJmp_0": { Name: "MUX", 					Op: ["00_0","01_0","10_0","11_0"] }

//Microcode_PC_Ld2 4
//hand_Out 24
//id_ALU_Ctl_0 18
//id_ALU_Ctl_1 19
//id_ALU_Ctl_2 20
//id_ALU_Ctl_3 21
//id_decoder_Ctl_0 22
//id_decoder_Ctl_1 23
};

function SetupTheWorld() {
	for ( var key in Connections ) {
		if ( theWorld[key] ) {
			console.log ( "Already Defined:", key );
		} else {
			var fx = function(key,name,op) { 
				return {
					"_data_": 0
					, "_used_": false
					, "_error_": []
					, "__key": key
					, "__name": name
					, "__op": op
					, "State": function () {
						if ( theWorld[key]._used_ ) {
							return ( theWorld[key]._data_ );
						} else {
							var ignore = false;
							if ( arguments.length > 0 ) {
								ignore = arguments[0];
							}
							if ( ! ignore ) {
								console.log ( "Warning: Pulling 'bus.State' when undefined" );
								theWorld[key]._error_.push( "Warning: Pulling 'bus.State' when undefined" );		// xyzzy - 
							}
							return ( theWorld[key]._data_ );
						}
					}
					, "SetState": function ( v ) {
						theWorld[key]._data_ = v;
						theWorld[key]._used_ = true;
			console.log ( name+".msg('"+op+"') -- Called -- ** An Array ** " );
						for ( var kk = 0, mx = op.length; kk < mx; kk++ ) {
							window[name].msg ( op[kk], 1 );						// connection from "wire" to chip.
						}
					}
					, "TickRise": function ( v ) {
						theWorld[key]._data_ = underfined;
						theWorld[key]._used_ = false;
						window[name].rise();
					}
					, "Error": function ( v ) {
						return ( theWorld[key]._error_ );
					}
					, "ClearError": function ( v ) {
						theWorld[key]._error_ = [];
					}
				};
			}
			theWorld[key] = fx(key,Connections[key].Name,Connections[key].Op);
		}
	}
}

SetupTheWorld();

function clearMicrocodeText() {
	$("#microcode_txt_0").text("");
	$("#microcode_txt_1").text("");
}

function displayMicrocodeText(t1,t2,t3,t4,t5) {
	clearMicrocodeText();
	$("#h_microcode_txt_0").text(t1);
	$("#h_microcode_txt_1").text(t2);
	$("#h_microcode_txt_2").text(t3);
	$("#h_microcode_txt_3").text(t4);
	$("#h_microcode_txt_4").text(t5);
}

function clearMemoryText() {
	$("#memory_txt_0").text("");
	$("#memory_txt_1").text("");
}

function displayMemoryText() {
	clearMemoryText();
	for ( var i = 0, mx = arguments.length; i < mx && i < 16; i++ ) {
		var x = arguments[i];
		$("#h_memory_"+i).html(arguments[i]);
	}
}

function clearMainBus() {
	$("#h_bus_txt_0").html("");
}

function displayMainBus(s) {
	// <text id="h_bus_txt_0" x="1280" y="280" class="small"></text>
	$("#h_bus_txt_0").html(s);
}




// id_result_Out decoder_ctl_0 Microcode_PC_Ld2			// 0x3 on Decoder-CTL = will load address for a id_pc_Inc*    id_pc_Inc = result_eq_0

</script>
<script src="js/pc_reg.js?v=0008"></script>
<script src="js/ir_reg.js?v=0008"></script>
<script src="js/result_reg.js?v=0008"></script>
<script src="js/ac_reg.js?v=0008"></script>
<script src="js/mar_reg.js?v=0008"></script>
<script src="js/mdr_reg.js?v=0008"></script>
<script src="js/input_reg.js?v=0008"></script>
<script src="js/output_reg.js?v=0008"></script>
<script src="js/microcode_pc_reg.js?v=0008"></script>
<script src="js/microcode_memory.js?v=0008"></script>
<script src="js/main_memory.js?v=0008"></script>
<script src="js/alu.js?v=0008"></script>
<script src="js/mux.js?v=0008"></script>
<script>

console.log ( "PC=",PC, "RESULT=", RESULT);
console.log ( "IR=",IR, "AC=", AC);
console.log ( "MAR=",MAR, "MDR=", MDR);
console.log ( "INPUT=",INPUT, "OUTPUT=", OUTPUT);
console.log ( "MICROCODE_PC=",MICROCODE_PC);
console.log ( "MICROCODE=",MICROCODE);
console.log ( "MEMORY=",MEMORY);
console.log ( "ALU=",ALU);
console.log ( "MUX=",MUX);

/*
0000000430000001 000
0000000144000000 001
0000000008c00008 002
436f646520427920 003
*/
var ParseInput = function (data) {
	var array = data.toString().split("\n");
	var pc = 0;
	var st = 0;
    for(i in array) {
        // console.log("->"+array[i]+"<-");
		const str = array[i];
		if ( str.length === 0 ) {
			console.log ( "Skipping 0 length line" )
		} else if ( str === "##1" ) {
			st = 1;
		} else if ( st === 0 ) {
			const words = str.split(' ');
			const str2 = words[0];
			// console.log(words[0]);
			const p2 = str2.substr(0, 8)
			const p1 = str2.substr(8)
			// console.log("p1 ->"+p1+"<- p2 ->"+p2+"<-");
			const p1x = parseInt(p1,16);
			const p2x = parseInt(p2,16);
			MICROCODE.x["_data1_"][pc] = p1x;
			MICROCODE.x["_data2_"][pc] = p2x;
			pc++;
		} else if ( st === 1 ) {
			// Associate bit with "line" that is turned on.
			const words = str.split(' ');
			const id = words[0];		// Name ####
			const pos = parseInt(words[1]);
			var da = "_data1_";
			var nb = pos;
			if ( pos >= 32 ) {
				da = "_data2_";
				nb = pos - 32;
			}
			if ( ! MICROCODE.x_Output_Lines_ ) {
				MICROCODE.x_Output_Lines_ = {};
			}
			MICROCODE.x["_Output_Lines_"][id] = {
				Loc: pos,
				NthBit: nb,
				Name: id,
				DataArray: da
			};
		}
    }
	displayMicrocodeText(
		"Address 256 Words",
		"Data 64 bits wide",
		"Microcode Loaded... "+mc_hash.substr(0,10)+"...",
		"",
		"");
	// console.log ( JSON.stringify ( MICROCODE ) );
};

// <button class="modal-submit" type="button" id="modal-submit" onclick="LoadMC();">Load Code</button>
// <input id="modal-input-code-hash" spellcheck="false" name="i_hash" class="hash-input">
function LoadMC() {
	hideModal();
	var v = $("#modal-input-code-hash").val();
	console.log ( "v=", v );
	$.get ( "./data/"+v+".txt", function(data){
		// console.log ( "Got It: ", data );
		localStorage.setItem('microcode_data',v);
		ParseInput(data);
	});
}

var mc_hash = "";

function OnStartupReloadMicrocode() {
	var v = localStorage.getItem('microcode_data');
	if ( v ) {
		mc_hash = v;
		$("#modal-input-code-hash").val(v);
		LoadMC();
	}
}

OnStartupReloadMicrocode();

var test0001 = false;	// Turn on the line from the PC data
var test0002 = false;	// Display value in the PC register
var test0003 = false;	// Send message to PC and see it turn on.
var test0004 = false;	// Send data from Result to PC and see it in both.
var test0005 = false;	// PC -> IR (abnomral move, what could be better?)
var test0006 = false;	// Show Memory Read Line - via MEMORY.msg
var test0007 = false;	// Show Memory Write Line - via MEMORY.msg
var test0008 = true;	// MC: Set to address 0, test output - see that they are turned on.
						// id_mar_Ld id_pc_Out id_mdr_Ld id_memory_Read  

if ( test0001 ) {
	PC.x["_data_"] = "0123";	// 0x7b
	PC.msg("Clr", 1);
	// Just Display: PC.TurnOn( "pc_Clr" );
	PC.Display(PC.x["_data_"]); 
}
if ( test0002 ) {
	PC.x["_data_"] = "0123";	// 0x7b
	PC.Display(PC.x["_data_"]); 
}
if ( test0003 ) {
	PC.x["_data_"] = 16;
	PC.msg("Inc", 1);
}
if ( test0004 ) {
	RESULT.msg("Out", 1);
	PC.msg("Ld", 1);
	RESULT.x["_data_"] = 32;
	for ( var ii = 0; ii < 2; ii++ ) {	// Tick to depth of propgation of signals
		PC.tick();
		RESULT.tick();
	}
	PC.rise();
}
if ( test0005 ) {
	RESULT.msg("Ld", 1);
	PC.msg("Out", 1);
	PC.x["_data_"] = 4428;	// 0x114c
	RESULT.x["_data_"] = 32;
	for ( var ii = 0; ii < 2; ii++ ) {	// Tick to depth of propgation of signals
		PC.tick();
		RESULT.tick();
	}
	PC.rise();
	RESULT.rise();
}
if ( test0006 ) {
	MEMORY.msg("Read", 1);
}
if ( test0007 ) {
	MEMORY.msg("Write", 1);
}
if ( test0008 ) {
	MICROCODE_PC.msg("Clr", 1);
	MICROCODE.msg("Addr", 1);
}

function test0009() {
	MICROCODE.msg("Addr", 1);
	// MAR.msg('Ld', 1);
}

function test000A() {
	clearOtherLine();
	MICROCODE.rise();
}

// 0ad7f1aef0bc1918380360372de72ff3de68d1001966a7b60ac437d60bdbfd0c

</script>
</body>
</html>
