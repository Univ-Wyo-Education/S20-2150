<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> MARIA Microcode Emulator </title>
<!--
MARIA Microcode Emulator: Version v1.4.4
Sat Mar 14 16:00:54 MDT 2020
Copyright (C) University of Wyoming, 2019-2020.
Credits:
	Prof Philip Schlump - Primary Code Developer
	Alexandra (Sosha) Maria Krosley - Graphic Design
--> 

<!-- Bootstrap CSS
<link rel="stylesheet" href="/bootstrap-4.3.1-dist/css/bootstrap.css">
<link rel="stylesheet" href="/css/bootstrap.curulean-theme.min.css">
<link rel="stylesheet" href="/css/bootstrap-datepicker.min.css">
-->

<head>
<style>
	.small					 { font: italic 15px sans-serif; }
	.medium0				 { font: 20px sans-serif; fill:#0603cf; }
	.medium1				 { font: italic 17px sans-serif; fill:#0603cf; }
	.vsmall					{ font: italic 12px sans-serif; }
	.vsmall-red			{ font: italic 12px sans-serif; fill:#ff0000; }
	.teal-box				{ fill:#00ffff; stroke:#000000; stroke-width:3; }
	.yellow-box			{ fill:#ffff00; stroke:#000000; stroke-width:3; }
	.white-box			 { fill:#ffffff; stroke:#000000; stroke-width:3; }
	.gray-box				{ fill:#d0d0d0; stroke:#000000; stroke-width:3; }
	.white-box			 { fill:#e0e0e0; stroke:#000000; stroke-width:3; }
	.input-line			{ fill:#000000; stroke:#000000; stroke-width:1; }
	.red-line				{ fill:#f00000; stroke:#000000; stroke-width:1; }
	.out-box				 { fill:#ffffff; stroke:#000000; stroke-width:1; }
	.blue-line			 { fill:#000000; stroke:#4040ff; stroke-width:3; fill:none }
	.light-green-line			 { fill:#000000; stroke:#20f020; stroke-width:3; fill:none }
	.light-cyan-line			 { fill:#000000; stroke:#40ffff; stroke-width:3; fill:none }
	.light-red-line			 { fill:#000000; stroke:#ff0000; stroke-width:3; fill:none }
	.blue-line-1		 { fill:#000000; stroke:#4040ff; stroke-width:2; fill:none }
	.button-box			{ fill:#b4c5fb; stroke:#000000; stroke-width:2; opacity:0.75 }
	.arrow-line			{ stroke:#000000; stroke-width:2; stroke-linecap: round; }
	.arrow-line-red	{ stroke:#ff0000; stroke-width:2; stroke-linecap: round; }
	.arrow-line-green { stroke:#00ff00; stroke-width:2; stroke-linecap: round; }
	.bk-box 		 { fill:#d7d7d7; stroke-width:0; }
	.hash-input 	 {
		width: 450px;
		margin-bottom: 20px;
	}
	.modal-submit 	 {
		margin-top: 20px;
		margin-bottom: 20px;
	}
/* Modal ---------------------------------------------------------------------------------- */
body {font-family: Arial, Helvetica, sans-serif;}

/* The Modal (background) */
.modal {
	display: none; /* Hidden by default */
	position: fixed; /* Stay in place */
	z-index: 1; /* Sit on top */
	padding-top: 100px; /* Location of the box */
	left: 0;
	top: 0;
	width: 100%; /* Full width */
	height: 100%; /* Full height */
	overflow: auto; /* Enable scroll if needed */
	background-color: rgb(0,0,0); /* Fallback color */
	background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
	position: relative;
	background-color: #fefefe;
	margin: auto;
	padding: 0;
	border: 1px solid #888;
	width: 80%;
	box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
	-webkit-animation-name: animatetop;
	-webkit-animation-duration: 0.4s;
	animation-name: animatetop;
	animation-duration: 0.4s
}

/* Add Animation */
@-webkit-keyframes animatetop {
	from {top:-300px; opacity:0} 
	to {top:0; opacity:1}
}

@keyframes animatetop {
	from {top:-300px; opacity:0}
	to {top:0; opacity:1}
}

/* The Close Button */
.close {
	color: white;
	float: right;
	font-size: 28px;
	font-weight: bold;
}

.close:hover,
.close:focus {
	color: #000;
	text-decoration: none;
	cursor: pointer;
}

.modal-header {
	padding: 2px 16px;
	background-color: #5cb85c;
	color: white;
}

.modal-blue-top {
	background-color: #1888fc;
}

.modal-body {padding: 2px 16px;}

.modal-footer {
	padding: 2px 16px;
	background-color: #5cb85c;
	color: white;
}

.modal-blue-bot {
	background-color: #1888fc;
}

</style>
<script src="js/jquery-3.3.1.js" type="text/javascript"></script>
<script src="js/popper-1.14.7.js" type="text/javascript"></script>
</head>
<body>
<div id="ins_end"></div>
<div id="id_ALU_Ctl"></div>
<div id="do_input"></div>
<div id="do_output"></div>
<svg width="1640" height="1480" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
 <g class="layer">
	<rect x="493" y="55" width="97" height="50" rx="20" class="bk-box"/>
	<text id="h_name_txt_0" x="510" y="80" class="medium0">MARIA</text>
	<text id="h_name_txt_0" x="502" y="95" class="medium1">Microcode</text>

	<title>Maria Simple CPU - For Microcoding</title>
	<rect id="id_pc" x="75" y="30" width="50" height="100" class="teal-box" onclick="infoOn('id_pc');"/>
		<text x="75" y="25" class="small" onclick="infoOn('id_pc');">PC</text>
		<rect id="id_pc_Ld" x="125" y="40" width="20" height="1" class="input-line" />
			<text x="130" y="35" class="vsmall" onclick="infoOn('id_pc_Ld');">Ld</text>
		<rect id="id_pc_Inc" x="125" y="60" width="20" height="1" class="input-line" />
			<text x="130" y="55" class="vsmall" onclick="infoOn('id_pc_Inc');">Inc</text>
		<rect id="id_pc_Out" x="125" y="80" width="20" height="1" class="input-line" />
			<text x="130" y="75" class="vsmall" onclick="infoOn('id_pc_Out');">Out</text>
		<rect id="id_pc_Clr" x="125" y="100" width="20" height="1" class="input-line" />
			<text x="130" y="95" class="vsmall" onclick="infoOn('id_pc_Clr');">Clr</text>
		<!-- Connection from PC to Bus -->
		<rect id="id_pc_to_bus" x="100" y="130" width="1" height="160" class="input-line" />

			<!-- arrow down for pc to bus -->
			<line x1="100" y1="290" x2="95" y2="285" class="arrow-line" />
			<line x1="100" y1="290" x2="105" y2="285" class="arrow-line" />
			<!-- arrow up to PC register, load PC input -->
			<line x1="100" y1="132" x2="95" y2="137" class="arrow-line" />
			<line x1="100" y1="132" x2="105" y2="137" class="arrow-line" />

			<text id="h_pc_txt_0" x="85" y="55" class="small"></text>
			<text id="h_pc_txt_1" x="85" y="75" class="small"></text>

	<rect id="id_ir" x="175" y="30" width="50" height="100" class="teal-box" onclick="infoOn('id_ir');"/>
		<text x="175" y="25" class="small" onclick="infoOn('id_ir');">IR</text>
		<rect id="id_ir_Ld" x="225" y="40" width="20" height="1" class="input-line" />
			<text x="230" y="35" class="vsmall" onclick="infoOn('id_ir_Ld');">Ld</text>
		<rect id="id_ir_Out" x="225" y="60" width="20" height="1" class="input-line" />
			<text x="230" y="55" class="vsmall" onclick="infoOn('id_ir_Out');">Out</text>
		<!-- Connection from IR to Bus -->
		<rect id="id_ir_to_bus" x="200" y="130" width="1" height="160" class="input-line" />
		<rect id="id_ir_sw" x="175" y="230" width="50" height="45" class="gray-box" />
			<text x="230" y="233" class="vsmall" onclick="infoOn('hand_out');">Hand Out</text>
			<text x="230" y="245" class="vsmall" onclick="infoOn('hand_out');">Hand[12]</text>
			<!-- Line from gray box left and down to buss - hand_out data line -->
			<rect id="id_hand_out_a" x="225" y="250" width="60" height="1" class="input-line" />
			<rect id="id_hand_out_b" x="285" y="250" width="1" height="40" class="input-line" />

			<!-- arrow for hand-out to bus -->
			<line x1="285" y1="290" x2="280" y2="285" class="arrow-line" />
			<line x1="285" y1="290" x2="290" y2="285" class="arrow-line" />
			<!-- arrow down for IR to bus -->
			<line x1="200" y1="290" x2="195" y2="285" class="arrow-line" />
			<line x1="200" y1="290" x2="205" y2="285" class="arrow-line" />
			<!-- arrow up to IR register, load IR input -->
			<line x1="200" y1="132" x2="195" y2="137" class="arrow-line" />
			<line x1="200" y1="132" x2="205" y2="137" class="arrow-line" />

			<rect id="id_decode_msb_4" x="200" y="170" width="100" height="1" class="input-line" onclick="infoOn('ir_decode_g1');"/>
				<text x="205" y="155" class="vsmall" onclick="infoOn('ir_decode_g1');">IR(15..12)[4] to </text>
				<text x="205" y="167" class="vsmall" onclick="infoOn('ir_decode_g1');">decoder 0b11</text>
			<rect id="id_decode_xIns_4" x="200" y="200" width="100" height="1" class="input-line" onclick="infoOn('ir_decode_g2');" />
				<text x="205" y="185" class="vsmall" onclick="infoOn('ir_decode_g2');">IR(11..8)[4] to </text>
				<text x="205" y="195" class="vsmall" onclick="infoOn('ir_decode_g2');">decoder 0b10</text>

			<!-- Xyzzy - IR MSB[4] to Decodeer_In_01 -->
			<!-- Xyzzy - IR other[4] to Decodeer_In_02 -->
			<!-- Xyzzy - Decoder == 11, connect to bus -->
			<!-- From microcode.m2
				Decoer Inputs
					CTL		Line/Instruction
					00		82,124	/ Microcode Jmp (Halt, Unused)
					01		138,144,150 / Jump if (Is Zero) from Result/Cmp - Microcode PC Inc Twice
					10		133 / OkSkip { OkSkipEe0, OkSkipGt0, OkSkipLt0 }
					11		22  / Common IR Decode
			-->

			<text id="h_ir_txt_0" x="185" y="55" class="small"></text>
			<text id="h_ir_txt_1" x="185" y="75" class="small"></text>


	<rect id="id_result" x="300" y="30" width="50" height="100" class="teal-box" onclick="infoOn('id_result');"/>
		<text x="300" y="25" class="small" onclick="infoOn('id_result');">Result</text>
		<rect id="id_result_Ld" x="350" y="40" width="20" height="1" class="input-line" />
			<text x="355" y="35" class="vsmall" onclick="infoOn('id_result_Ld');">Ld</text>
		<rect id="id_result_Out" x="350" y="60" width="20" height="1" class="input-line" />
			<text x="355" y="55" class="vsmall" onclick="infoOn('id_result_Out');">Out</text>
		<rect id="id_result_Clr" x="350" y="100" width="20" height="1" class="input-line" />
			<text x="355" y="95" class="vsmall" onclick="infoOn('id_result_Clr');">Clr</text>

		<!-- // id_result_Out decoder_ctl_0 Microcode_PC_Ld2			// 0x3 on Decoder-CTL = will load address for a id_pc_Inc*    id_pc_Inc = result_eq_0 -->
		<g id="Microcode_PC_Ld2">
		<rect id="id_result_zero_out" x="350" y="120" width="47" height="1" class="input-line" />
			<text x="355" y="115" class="vsmall" onclick="infoOn('id_result_zero_out');">Is Zero</text>
		</g>

			<!-- arrow for is zero - output from IR -->
			<line x1="397" y1="120" x2="392" y2="115" class="arrow-line" />
			<line x1="397" y1="120" x2="392" y2="125" class="arrow-line" />
			<!-- arrow down for Result to bus -->
			<line x1="325" y1="290" x2="320" y2="285" class="arrow-line" />
			<line x1="325" y1="290" x2="330" y2="285" class="arrow-line" />
			<!-- arrow up to Result register, load Result input -->
			<line x1="325" y1="132" x2="320" y2="137" class="arrow-line" />
			<line x1="325" y1="132" x2="330" y2="137" class="arrow-line" />

			<text id="h_result_txt_0" x="310" y="55" class="small"></text>
			<text id="h_result_txt_1" x="310" y="75" class="small"></text>

		<!-- Connection from Result to Bus -->
		<rect id="id_result_to_bus" x="325" y="130" width="1" height="160" class="input-line" />


	<polygon id="id_ALU"
		points=" 500,30	400,60 400,100 500,130 500,110 480,100 480,60 500,50	 500,30 "
		fill="#80ff80" stroke="#000000" stroke-width="3" />
		<text x="400" y="45" class="small">ALU</text>
		<rect id="id_ALU_Ctl_0" x="420" y="108" width="1" height="45" class="input-line" />
		<rect id="id_ALU_Ctl_1" x="425" y="109" width="1" height="44" class="input-line" />
		<rect id="id_ALU_Ctl_2" x="430" y="110" width="1" height="43" class="input-line" />
		<rect id="id_ALU_Ctl_3" x="435" y="111" width="1" height="42" class="input-line" />
			<text x="440" y="142" class="vsmall" onclick="infoOn('id_ALU_Ctl');">ALU Ctl</text>
			<text x="440" y="152" class="vsmall" onclick="infoOn('id_ALU_Ctl');">0..3</text>
		<!-- Connection from ALU to Result -->
		<rect id="id_ALU_to_result" x="350" y="80" width="50" height="1" class="input-line" />
		<!-- Connection from ALU to AC -->
		<rect id="id_ac_to_ALU" x="500" y="40" width="100" height="1" class="input-line" />
		<!-- Connection from ALU to Bus Pt1 -->
		<rect id="id_ac_to_Bus_pt1" x="500" y="120" width="40" height="1" class="input-line" />
		<!-- Connection from ALU to Bus Pt2 -->
		<rect id="id_ac_to_Bus_pt2" x="540" y="120" width="1" height="170" class="input-line" />

			<!-- arrow for AC to Result -->
			<line x1="352" y1="80" x2="357" y2="75" class="arrow-line" />
			<line x1="352" y1="80" x2="357" y2="85" class="arrow-line" />
			<!-- arrow for AC Input A (from AC register) -->
			<line x1="502" y1="40" x2="507" y2="35" class="arrow-line" />
			<line x1="502" y1="40" x2="507" y2="45" class="arrow-line" />
			<!-- arrow for AC Input B (from bus) -->
			<line x1="502" y1="120" x2="507" y2="115" class="arrow-line" />
			<line x1="502" y1="120" x2="507" y2="125" class="arrow-line" />

		<text id="h_alu_txt" x="405" y="85" class="small"></text>

		<text id="h_alu_A_txt" x="505"    y="32" class="vsmall off-at-start">XXaa</text>
		<text id="h_alu_B_txt" x="505"   y="137" class="vsmall off-at-start">xxYY</text>
		<text id="h_alu_Out_txt" x="367"  y="75" class="vsmall off-at-start">mmDD</text>

	<rect id="id_ac" x="600" y="30" width="50" height="100" class="teal-box" onclick="infoOn('id_ac');"/>
		<text x="600" y="25" class="small" onclick="infoOn('id_ac');">AC</text>
		<rect id="id_ac_Ld" x="650" y="40" width="20" height="1" class="input-line" />
			<text x="655" y="35" class="vsmall" onclick="infoOn('id_ac_Ld');">Ld</text>
		<rect id="id_ac_Out" x="650" y="60" width="20" height="1" class="input-line" />
			<text x="655" y="55" class="vsmall" onclick="infoOn('id_ac_Out');">Out</text>
		<rect id="id_ac_Out_to_ALU" x="650" y="80" width="20" height="1" class="input-line" />
			<text x="655" y="75" class="vsmall" onclick="infoOn('id_ac_Out_to_ALU');">Out To ALU</text>
		<rect id="id_ac_Inc" x="650" y="100" width="20" height="1" class="input-line" />
			<text x="655" y="95" class="vsmall" onclick="infoOn('id_ac_Inc');">Inc</text>
		<rect id="id_ac_Clr" x="650" y="120" width="20" height="1" class="input-line" />
			<text x="655" y="115" class="vsmall" onclick="infoOn('id_ac_Inc');">Clr</text>
		<!-- Connection from AC to Bus -->
		<rect id="id_ac_to_bus" x="625" y="130" width="1" height="160" class="input-line" />

			<!-- arrow down for AC to bus -->
			<line x1="625" y1="290" x2="620" y2="285" class="arrow-line" />
			<line x1="625" y1="290" x2="630" y2="285" class="arrow-line" />
			<!-- arrow up to AC register, load AC input -->
			<line x1="625" y1="132" x2="620" y2="137" class="arrow-line" />
			<line x1="625" y1="132" x2="630" y2="137" class="arrow-line" />

		<text id="h_ac_txt_0" x="610" y="55" class="small"></text>
		<text id="h_ac_txt_1" x="610" y="75" class="small"></text>

	<rect id="id_microcode" x="750" y="30" width="400" height="100" fill="#dba5fd" stroke="#000000" stroke-width="3" onclick="infoOn('id_microcode');"/>
		<text x="750" y="25" class="small" onclick="infoOn('id_microcode');">Microcode</text>
		<text id="microcode_txt_0" x="754" y="47" class="small">Address 256 Words</text>
		<text id="microcode_txt_1" x="754" y="67" class="small">Data 64 bits wide</text>

		<text id="h_microcode_txt_0" x="754"  y="50" class="small"></text>
		<text id="h_microcode_txt_1" x="754"  y="70" class="small"></text>
		<text id="h_microcode_txt_2" x="754"  y="85" class="small"></text>
		<text id="h_microcode_txt_3" x="754" y="100" class="small"></text>
		<text id="h_microcode_txt_4" x="754" y="115" class="small"></text>

	<rect id="id_Microcode_PC" x="1200" y="30" width="100" height="50" fill="#f68c1d" stroke="#000000" stroke-width="3" onclick="infoOn('id_Microcode_PC');"/>
		<text x="1200" y="25" class="small" onclick="infoOn('id_Microcode_PC');">Microcode PC</text>
		<rect id="id_Microcode_PC_Ld" x="1300" y="40" width="20" height="1" class="input-line" />
			<text x="1305" y="35" class="vsmall" onclick="infoOn('id_Microcode_PC_Ld');">Ld</text>
		<rect id="id_Microcode_PC_Clr" x="1300" y="60" width="20" height="1" class="input-line" />
			<text x="1305" y="55" class="vsmall" onclick="infoOn('id_Microcode_PC_Clr');">Clr</text>
		<!-- connection from decoder output to Microcode Address Load/Input -->
		<rect id="id_Microcode_PC_In[8]a"   x="1270"   y="80"   width="1"    height="65"    class="input-line" />
		<rect id="id_Microcode_PC_In[8]b"   x="1270"   y="145"  width="60"   height="1"     class="input-line" />
		<rect id="id_Microcode_PC_In[8]c"   x="1330"   y="145"  width="1"    height="75" 	class="input-line" />
		<rect id="id_Microcode_PC_In[8]d"   x="1280"   y="220"  width="50"   height="1"     class="input-line" />
			<text x="1275" y="95" class="vsmall">In[8]</text>
			<text x="1282" y="215" class="vsmall">Out</text>
			<!-- arrow up from decoder output to Microcode PC input lines -->
			<line x1="1270" y1="82" x2="1265" y2="87" class="arrow-line" />
			<line x1="1270" y1="82" x2="1275" y2="87" class="arrow-line" />

		<g id="McJmp[8]">
			<rect id="id_Microcode_Out[8]dec_a"  x="1135"   y="130"  width="1"    height="25"    class="input-line" />
			<rect id="id_Microcode_Out[8]dec_b"  x="1135"   y="155"  width="40"   height="1"     class="input-line" />
			<rect id="id_Microcode_Out[8]dec_c"  x="1175"   y="155"  width="1"    height="40"    class="input-line" />
			<rect id="id_Microcode_Out[8]dec_d"  x="1175"   y="195"  width="35"   height="1"     class="input-line" />
				<text x="1140" y="144" class="vsmall" onclick="infoOn('mm_to_dec');">Out[8] </text>
				<text x="1182" y="190" class="vsmall">00</text>
		</g>
		<rect id="id_Microcode_Out[2]deccoder_ctl_a"  x="1120"   y="130"   width="1"    height="135"     class="input-line" />
		<rect id="id_Microcode_Out[2]deccoder_ctl_b"  x="1120"   y="265"   width="105"  height="1"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-350 14)" onclick="infoOn('decoder-info');">
				<text x="1128" y="260" class="vsmall">Decoder Ctl[2]</text>
			</g>
		<rect id="id_Microcode_Out[4]ALU_ctl"  x="1100"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 34)" onclick="infoOn('id_ALU_Ctl');" >
				<text x="1128" y="260" class="vsmall" >ALU Ctl[4]</text>
			</g>
		<rect id="id_Microcode_Out[1]memory_read"  x="1080"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 54)" onclick="infoOn('id_memory_Read');" >
				<text x="1128" y="260" class="vsmall" >Memory Read</text>
			</g>
		<rect id="id_Microcode_Out[1]memory_write"  x="1060"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 74)" onclick="infoOn('id_memory_Write');">
				<text x="1128" y="260" class="vsmall">Memory Write</text>
			</g>
		<rect id="id_Microcode_Out[3]pc_ctl"  x="1040"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 94)" onclick="infoOn('id_pc_Ld','id_pc_Inc','id_pc_Out','id_pc_Clr');" >
				<text x="1128" y="260" class="vsmall">PC[4] Ld/Inc/Out/Clr</text>
			</g>
		<rect id="id_Microcode_Out[3]ir_ctl"  x="1020"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 114)" onclick="infoOn('id_ir_Ld','id_ir_Out');" >
				<text x="1128" y="260" class="vsmall">IR[3] Ld/Out/Hand_Out</text>
			</g>
		<rect id="id_Microcode_Out[3]result_ctl"  x="1000"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 134)" onclick="infoOn('id_result_Ld','id_result_Clr','id_result_Out');">
				<text x="1128" y="260" class="vsmall">Result[3] Ld/Clr/Out</text>
			</g>
		<rect id="id_Microcode_Out[3]mar_ctl"  x="980"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 154)" onclick="infoOn('id_mar_Ld','id_mar_Out');">
				<text x="1128" y="260" class="vsmall">MAR[2] Ld/Out</text>
			</g>
		<rect id="id_Microcode_Out[3]mdr_ctl"  x="960"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 174)" onclick="infoOn('id_mdr_Ld','id_mdr_Out');">
				<text x="1128" y="260" class="vsmall">MDR[2] Ld/Out</text>
			</g>
		<rect id="id_Microcode_Out[3]ac_ctl"  x="940"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 194)" onclick="infoOn('id_ac_Ld','id_ac_Out','id_ac_Out_to_ALU');">
				<text x="1128" y="260" class="vsmall">AC[3] Ld/Out/Out_to_ALU</text>
			</g>
		<rect id="id_Microcode_Out[2]output_ctl"  x="920"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 214)" onclick="infoOn('id_output_Ld','id_output_Out');">
				<text x="1128" y="260" class="vsmall">Output[2] Ld/Out</text>
			</g>
		<rect id="id_Microcode_Out[2]input_ctl"  x="900"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 234)" onclick="infoOn('id_input_Ld','id_input_Out');">
				<text x="1128" y="260" class="vsmall">Input[2] Ld/Out</text>
			</g>
		<rect id="id_Microcode_Out[2]mc_ctl"  x="880"   y="130"   width="1"    height="125"     class="input-line" />
			<g transform="rotate(90 1000 400) translate(-390 254)" onclick="infoOn('id_Microcode_PC_Ld','id_Microcode_PC_Clr');">
				<text x="1128" y="260" class="vsmall">Microcode PC[2] Ld/Clr</text>
			</g>

		<rect id="id_Microcode_PC_Out[8]to_Microcode"  x="1150"   y="50"   width="50"   height="1"     class="input-line" />
			<text x="1155" y="35" class="vsmall">Out[8]</text>
			<text x="1155" y="45" class="vsmall">Addr</text>
			<!-- arrow left pointing at microcode store from Microcode PC -->
			<line x1="1152" y1="50" x2="1157" y2="45" class="arrow-line" />
			<line x1="1152" y1="50" x2="1157" y2="55" class="arrow-line" />
		<g id="x_id_Microcode_PC_Inc">
			<rect id="id_Microcode_PC_to_Microcode_PC_Inc_out_a"  x="1150"   y="120"   width="85"   height="1"     class="input-line" />
			<rect id="id_Microcode_PC_to_Microcode_PC_Inc_out_b"  x="1235"   y="80"   width="1"   height="40"     class="input-line" />
				<!-- arrow up from Microcode to Microcode PC Inc line -->
				<line x1="1235" y1="80" x2="1230" y2="87" class="arrow-line" />
				<line x1="1235" y1="80" x2="1240" y2="87" class="arrow-line" />
		</g>
			<text x="1155" y="105" class="vsmall">Out Inc </text>
			<text x="1155" y="115" class="vsmall">Microcode PC</text>

		<rect id="id_decoder_In[8]b"  x="1175"   y="210"  width="35"   height="1"     class="input-line" />
			<text x="1182" y="208" class="vsmall">01</text>
		<rect id="id_decoder_In[8]c"  x="1175"   y="225"  width="35"   height="1"     class="input-line" />
			<text x="1182" y="223" class="vsmall">10</text>
		<rect id="id_decoder_In[8]d"  x="1175"   y="240"  width="35"   height="1"     class="input-line" />
			<text x="1182" y="238" class="vsmall">11</text>

		<text id="h_microcode_pc_txt_0" x="1210" y="55" class="small"></text>

	<!-- id="decoder_ctl_0" -->
	<!-- id="decoder_ctl_1" -->
	<polygon id="id_decoder"
		points=" 1200,180	1200,250 1280,220       1200,180 "
		fill="#f0fff0" stroke="#ff0000" stroke-width="3" />
			<text x="1220" y="180" class="small">Decoder</text>
			<text x="1250" y="200" class="small">MUX</text>
			<!-- Decoder Output to Microcode_PC Input -->
			<text id="mux_to_mpc" x="1280" y="140" class="vsmall"></text>

		<rect id="id_decoder_Ctl_0"  x="1215"   y="244"  width="1"   height="21"     class="input-line" />
		<rect id="id_decoder_Ctl_1"  x="1225"   y="240"  width="1"   height="25"     class="input-line" />
			<text x="1230" y="250" class="vsmall">Ctl</text>

		<text id="h_mux_txt" x="1210" y="220" class="small"></text>

		<text id="h_mux_out_to_MPC" x="1280"  y="140" class="vsmall off-at-start"></text>

	<rect id="id_main_bus" x="25" y="290" width="1380" height="3" fill="#000000" stroke="#000000" stroke-width="1" />
		<text x="25" y="285" class="small">Bus</text>

		<text id="h_bus_txt_0" x="1360" y="280" class="small"></text>

	<rect id="id_mar" x="275" y="324" width="100" height="50" class="yellow-box" onclick="infoOn('id_mar');" />
		<text x="275" y="319" class="small" onclick="infoOn('id_mar');">MAR</text>
		<rect id="id_mar_Ld" x="375" y="340" width="20" height="1" class="input-line" />
			<text x="379" y="334" class="vsmall" onclick="infoOn('id_mar_Ld');">Ld</text>
		<rect id="id_mar_Out" x="375" y="360" width="20" height="1" class="input-line" />
			<text x="379" y="355" class="vsmall" onclick="infoOn('id_mar_Out');">Out</text>
		<!-- Connection from mar to Bus -->
		<rect id="id_mar_to_bus" x="335" y="290" width="1" height="33" class="input-line" />
		<!-- Connection from mar to Main Memory -->
		<rect id="id_mar_to_memory" x="335" y="375" width="1" height="45" class="input-line" />

			<!-- arrow up for MAR to bus -->
			<line x1="335" y1="293" x2="330" y2="298" class="arrow-line" />
			<line x1="335" y1="293" x2="340" y2="298" class="arrow-line" />
			<!-- arrow down to MAR register, load AC input -->
			<line x1="335" y1="322" x2="330" y2="317" class="arrow-line" />
			<line x1="335" y1="322" x2="340" y2="317" class="arrow-line" />
			<!-- arrow down from MAR register to Main Memory -->
			<line x1="335" y1="420" x2="330" y2="415" class="arrow-line" />
			<line x1="335" y1="420" x2="340" y2="415" class="arrow-line" />

		<text id="h_mar_txt_0" x="285" y="350" class="small"></text>

	<rect id="id_mdr" x="520" y="324" width="100" height="50" class="yellow-box" onclick="infoOn('id_mdr');" />
		<text x="520" y="319" class="small" onclick="infoOn('id_mdr');">MDR</text>
		<rect id="id_mdr_Ld" x="620" y="340" width="20" height="1" class="input-line" />
			<text x="625" y="334" class="vsmall" onclick="infoOn('id_mdr_Ld');">Ld</text>
		<rect id="id_mdr_Out" x="620" y="360" width="20" height="1" class="input-line" />
			<text x="624" y="355" class="vsmall" onclick="infoOn('id_mdr_Out');">Out</text>
		<!-- Connection from mar to Bus -->
		<rect id="id_mdr_to_bus" x="570" y="290" width="1" height="33" class="input-line" />
		<!-- Connection from mdr to Main Memory -->
		<rect id="id_mar_to_memory" x="570" y="375" width="1" height="45" class="input-line" />

			<!-- arrow up for MAR to bus -->
			<line x1="570" y1="293" x2="565" y2="298" class="arrow-line" />
			<line x1="570" y1="293" x2="575" y2="298" class="arrow-line" />
			<!-- arrow down to MAR register, load MAR input -->
			<line x1="570" y1="322" x2="565" y2="317" class="arrow-line" />
			<line x1="570" y1="322" x2="575" y2="317" class="arrow-line" />
			<!-- arrow up to MAR register from Main Memory -->
			<line x1="570" y1="375" x2="565" y2="380" class="arrow-line" />
			<line x1="570" y1="375" x2="575" y2="380" class="arrow-line" />
			<!-- arrow down from MAR register to Main Memory -->
			<line x1="570" y1="420" x2="565" y2="415" class="arrow-line" />
			<line x1="570" y1="420" x2="575" y2="415" class="arrow-line" />

		<text id="h_mdr_txt_0" x="530" y="350" class="small"></text>

	<rect id="id_memory" x="250" y="420" width="400" height="350" fill="#d0d0d0" stroke="#000000" stroke-width="1" onclick="infoOn('id_memory',254,480,400,860);"/>
		<text x="400" y="415" class="small" onclick="infoOn('id_memory');">Main Memory</text>
		<text id="memory_txt_0" x="254" y="440" class="small">Address 8K Words</text>
		<text id="memory_txt_1" x="254" y="460" class="small">Data 16 bits wide</text>
		<rect id="id_memory_Read" x="650" y="440" width="40" height="1" class="input-line" />
			<text x="655" y="434" class="vsmall" onclick="infoOn('id_memory_Read');">Read</text>
		<rect id="id_memory_Write" x="650" y="460" width="40" height="1" class="input-line" />
			<text x="655" y="454" class="vsmall" onclick="infoOn('id_memory_Write');">Write</text>

		<text id="h_memory_0"   x="254" y="435" class="small" ></text>
		<text id="h_memory_1"   x="254" y="455" class="small" ></text>
		<text id="h_memory_2"   x="254" y="475" class="small" ></text>
		<text id="h_memory_3"   x="254" y="495" class="small" ></text>
		<text id="h_memory_4"   x="254" y="515" class="small" ></text>
		<text id="h_memory_5"   x="254" y="535" class="small" ></text>
		<text id="h_memory_6"   x="254" y="555" class="small" ></text>
		<text id="h_memory_7"   x="254" y="575" class="small" ></text>
		<text id="h_memory_8"   x="254" y="595" class="small" ></text>
		<text id="h_memory_9"   x="254" y="615" class="small" ></text>
		<text id="h_memory_10"  x="254" y="635" class="small" ></text>
		<text id="h_memory_11"  x="254" y="655" class="small" ></text>
		<text id="h_memory_12"  x="254" y="675" class="small" ></text>
		<text id="h_memory_13"  x="254" y="695" class="small" ></text>
		<text id="h_memory_14"  x="254" y="715" class="small" ></text>
		<text id="h_memory_15"  x="254" y="735" class="small" ></text>
		<text id="h_memory_16"  x="254" y="755" class="small" ></text>

	<rect id="id_output" x="1200" y="324" width="100" height="50" class="white-box" onclick="infoOn('id_output');" />
		<text x="1200" y="319" class="small" onclick="infoOn('id_output');">Output</text>
		<rect id="id_output_Ld" x="1300" y="340" width="20" height="1" class="input-line" />
			<text x="1305" y="334" class="vsmall" onclick="infoOn('id_output_Ld');">Ld</text>
		<rect id="id_output_Out" x="1300" y="360" width="20" height="1" class="input-line" />
			<text x="1305" y="355" class="vsmall" onclick="infoOn('id_output_Out');">Out</text>
		<!-- Connection from output to Bus -->
		<rect id="id_output_to_bus" x="1270" y="290" width="1" height="33" class="input-line" />

			<!-- arrow up for Output to bus -->
			<line x1="1270" y1="293" x2="1265" y2="298" class="arrow-line" />
			<line x1="1270" y1="293" x2="1275" y2="298" class="arrow-line" />
			<!-- arrow down to Output register, load Output input -->
			<line x1="1270" y1="322" x2="1265" y2="317" class="arrow-line" />
			<line x1="1270" y1="322" x2="1275" y2="317" class="arrow-line" />

		<text id="h_output_txt_0" x="1210" y="350" class="small"></text>

		<g transform="translate(1185 380) scale(1.8)">
			<g id="dig0_0_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#bbbbbb"/>
			</g>
			<g id="dig0_1_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig0_2_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#cccccc"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig0_3_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig0_4_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig0_5_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig0_6_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig0_7_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig0_8_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig0_9_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig0___7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#cccccc"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
		</g>

		<g transform="translate(1210 380) scale(1.8)">
			<g id="dig1_0_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig1_1_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig1_2_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#cccccc"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig1_3_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig1_4_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig1_5_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig1_6_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig1_7_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig1_8_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig1_9_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig1___7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#cccccc"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
		</g>

		<g transform="translate(1232 380) scale(1.8)">
			<g id="dig2_0_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig2_1_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig2_2_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#cccccc"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig2_3_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig2_4_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig2_5_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig2_6_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig2_7_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig2_8_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig2_9_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig2___7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#cccccc"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
		</g>

		<g transform="translate(1254 380) scale(1.8)">
			<g id="dig3_0_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig3_1_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig3_2_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#cccccc"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig3_3_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig3_4_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig3_5_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig3_6_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig3_7_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig3_8_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig3_9_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig3___7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#cccccc"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
		</g>

		<g transform="translate(1279 380) scale(1.8)">
			<g id="dig4_0_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig4_1_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig4_2_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#cccccc"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig4_3_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig4_4_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig4_5_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig4_6_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig4_7_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
			<g id="dig4_8_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#ff0000"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig4_9_7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#ff0000"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#ff0000"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#ff0000"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#ff0000"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#ff0000"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#ff0000"/>
			</g>
			<g id="dig4___7seg" style="fill-rule:evenodd; stroke:#FFFFFF; stroke-width:0.25; stroke-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;">
			  <polygon id="a" points=" 1, 1  2, 0  8, 0  9, 1  8, 2  2, 2" fill="#cccccc"/>
			  <polygon id="b" points=" 9, 1 10, 2 10, 8  9, 9  8, 8  8, 2" fill="#cccccc"/>
			  <polygon id="c" points=" 9, 9 10,10 10,16  9,17  8,16  8,10" fill="#cccccc"/>
			  <polygon id="d" points=" 9,17  8,18  2,18  1,17  2,16  8,16" fill="#cccccc"/>
			  <polygon id="e" points=" 1,17  0,16  0,10  1, 9  2,10  2,16" fill="#cccccc"/>
			  <polygon id="f" points=" 1, 9  0, 8  0, 2  1, 1  2, 2  2, 8" fill="#cccccc"/>
			  <polygon id="g" points=" 1, 9  2, 8  8, 8  9, 9  8,10  2,10" fill="#cccccc"/>
			</g>
		</g>

	<rect id="id_input" x="1000" y="324" width="100" height="50" class="white-box" onclick="infoOn('id_input');"/>
		<text x="1000" y="319" class="small"onclick="infoOn('id_input');">Input</text>
		<rect id="id_input_Ld" x="1100" y="340" width="20" height="1" class="input-line" />
			<text x="1105" y="334" class="vsmall" onclick="infoOn('id_input_Ld');">Ld</text>
		<rect id="id_input_Out" x="1100" y="360" width="20" height="1" class="input-line" />
			<text x="1105" y="355" class="vsmall" onclick="infoOn('id_input_Out');">Out</text>
		<!-- Connection from input to Bus -->
		<rect id="id_input_to_bus" x="1050" y="290" width="1" height="33" class="input-line" />

			<!-- arrow up for Input to bus -->
			<line x1="1050" y1="293" x2="1045" y2="298" class="arrow-line" />
			<line x1="1050" y1="293" x2="1055" y2="298" class="arrow-line" />
			<!-- arrow down to Input register, load Input input -->
			<line x1="1050" y1="322" x2="1045" y2="317" class="arrow-line" />
			<line x1="1050" y1="322" x2="1055" y2="317" class="arrow-line" />

		<text id="h_input_txt_0" x="1010" y="350" class="small"></text>



<!-- Text Output Area -->
	<rect id="out_box" x="750" y="420" width="650" height="350" class="out-box" />
	<text id="line_0"  x="755" y="435" class="small" ></text>
	<text id="line_1"  x="755" y="455" class="small" ></text>
	<text id="line_2"  x="755" y="475" class="small" ></text>
	<text id="line_3"  x="755" y="495" class="small" ></text>
	<text id="line_4"  x="755" y="515" class="small" ></text>
	<text id="line_5"  x="755" y="535" class="small" ></text>
	<text id="line_6"  x="755" y="555" class="small" ></text>
	<text id="line_7"  x="755" y="575" class="small" ></text>
	<text id="line_8"  x="755" y="595" class="small" ></text>
	<text id="line_9"  x="755" y="615" class="small" ></text>
	<text id="line_10" x="755" y="635" class="small" ></text>
	<text id="line_11" x="755" y="655" class="small" ></text>
	<text id="line_12" x="755" y="675" class="small" ></text>
	<text id="line_13" x="755" y="695" class="small" ></text>
	<text id="line_14" x="755" y="715" class="small" ></text>
	<text id="line_15" x="755" y="735" class="small" ></text>
	<text id="line_16" x="755" y="755" class="small" ></text>



	<path id="id_ir_to_bus_full_hand_out" class="blue-line off-at-start"
		d="M 200 130      L 200 285 "
		/>

<!-- MM to Dec input - mixed with other inputs. -->
	<!--
		<g id="McJmp[8]">
			<rect id="id_Microcode_Out[8]dec_a"  x="1135"   y="130"  width="1"    height="25"    class="input-line" />
			<rect id="id_Microcode_Out[8]dec_b"  x="1135"   y="155"  width="40"   height="1"     class="input-line" />
			<rect id="id_Microcode_Out[8]dec_c"  x="1175"   y="155"  width="1"    height="40"    class="input-line" />
			<rect id="id_Microcode_Out[8]dec_d"  x="1175"   y="195"  width="35"   height="1"     class="input-line" />
				<text x="1140" y="144" class="vsmall">Out[8] </text>
				<text x="1182" y="190" class="vsmall">00</text>
		</g>
		showLine("#ir_15_12_to_decoder_11","#mm_to_dec_11");
	-->
	<path id="mm_to_dec_11" class="blue-line off-at-start"
		d="M 1135 130   L 1135 155  1170 155  1170 240  1200 240  "
		/>
	<path id="mm_to_dec_10" class="blue-line off-at-start"
		d="M 1135 130   L 1135 155  1170 155  1170 225  1200 225 "
		/>
	<path id="mm_to_dec_01" class="blue-line off-at-start"
		d="M 1135 130   L 1135 155  1170 155  1170 210  1200 210 "
		/>
	<path id="mm_to_dec_00" class="blue-line off-at-start"
		d="M 1135 130   L 1135 155  1170 155  1170 195  1200 195 "
		/>
<!-- Blue Connection Lines ==== 900 is 1st line out on MM -->
	<!--
		<g id="x_id_Microcode_PC_Inc">
			<rect id="id_Microcode_PC_to_Microcode_PC_Inc_out_a"  x="1150"   y="120"   width="85"   height="1"     class="input-line" />
			<rect id="id_Microcode_PC_to_Microcode_PC_Inc_out_b"  x="1235"   y="80"   width="1"   height="40"     class="input-line" />
	-->
	<path id="id_Microcode_PC_Inc" class="blue-line off-at-start"
		d="M 1150 120   L 1150 120  1235 120 1235 80 "
		/>
	<path id="pc_Ld_to_microcode" class="blue-line off-at-start"
		d="M 125 40   L 160 40  160 220  700 220  700 280 1040 280 1040 130  "
		/>
	<path id="pc_Inc_to_microcode" class="blue-line off-at-start"
		d="M 125 60   L 160 60  160 220  700 220  700 280 1040 280 1040 130  "
		/>
	<path id="pc_Out_to_microcode" class="blue-line off-at-start"
		d="M 125 80   L 160 80  160 220  700 220  700 280 1040 280 1040 130  "
		/>
	<path id="pc_Clr_to_microcode" class="blue-line off-at-start"
		d="M 125 100   L 160 100  160 220  700 220  700 280 1040 280 1040 130  "
		/>

	<path id="ir_Ld_to_microcode" class="blue-line off-at-start"
		d="M 225 40   L 270 40  270 220  700 220  700 280 1020 280 1020 130  "
		/>
	<path id="ir_Out_to_microcode" class="blue-line off-at-start"
		d="M 225 60   L 270 60  270 220  700 220  700 280 1020 280 1020 130  "
		/>
	<!-- Hand Output to Microcode ,"#Hand_Out_to_microcode" -->
	<path id="hand_out" class="blue-line off-at-start"
		d="M 225 235   L 700 235  700 280 1020 280 1020 130  "
		/>
	<!-- 12 bits of IR - 9:0 -->
	<g id="id_hand_out" class="off-at-start">
		<path class="light-green-line"
			d="M 225 252   L 282 252  282 290"
			/>
		<text id="id_hand_out_value" x="245" y="268" class="small"></text>
	</g>

	<g id="ir_decode_g1">
		<path id="ir_15_12_to_decoder_11" class="blue-line off-at-start"
			d="M 200 170   L  705 170  705 280   1170 280 1170 240  1200 240 "
			/>
	</g>
	<g id="ir_decode_g2">
		<path id="ir_11_8_to_decoder_10" class="light-red-line off-at-start"
			d="M 200 200   L  705 200  705 280   1170 280 1170 225  1200 225 "
			/>
	</g>

	<g id="alu_ctl_4_to_microcode" class="off-at-start">
		<rect id="id_ALU_ctl_0" x="420" y="108" width="1" height="45" class="blue-line-1" />
		<rect id="id_ALU_ctl_1" x="425" y="110" width="1" height="43" class="blue-line-1" />
		<rect id="id_ALU_ctl_2" x="430" y="112" width="1" height="41" class="blue-line-1" />
		<rect id="id_ALU_ctl_3" x="435" y="113" width="1" height="40" class="blue-line-1" />
		<path id="alu_ctl_to_microcode_a" class="blue-line-1" d="M 420 152   L  427 160  " />
		<path id="alu_ctl_to_microcode_b" class="blue-line-1" d="M 425 152   L  427 160  " />
		<path id="alu_ctl_to_microcode_c" class="blue-line-1" d="M 430 152   L  428 160  " />
		<path id="alu_ctl_to_microcode_d" class="blue-line-1" d="M 435 152   L  428 160  " />
		<path id="alu_ctl_to_microcoee_e" class="blue-line"
			d="M 428.5 160   L  428.5 280  705 280   700 280  1100 280 1100 130  "
			/>
	</g>


<!-- -->
	<path id="result_Ld_to_microcode" class="blue-line off-at-start"
		d="M 350 40   L  390 40   390 280    1000 280 1000 130  "
		/>
	<path id="result_Out_to_microcode" class="blue-line off-at-start"
		d="M 350 60   L  390 60   390 280    1000 280 1000 130  "
		/>
	<path id="result_Clr_to_microcode" class="blue-line off-at-start"
		d="M 350 100  L  390 100 390 280     1000 280 1000 130  "
		/>
	<path id="result_zero_out" class="blue-line off-at-start"
		d="M 350 120  L  390 120  390 280    1170 280 1170 210  1200 210 "
		/>


<!-- -->
	<path id="ac_Ld_to_microcode" class="blue-line off-at-start"
		d="M 650 40   L  690 40   690 280     940 280 940 130  "
		/>
	<path id="ac_Out_to_microcode" class="blue-line off-at-start"
		d="M 650 60   L  690 60   690 280     940 280 940 130  "
		/>
	<path id="ac_Out_to_ALU" class="blue-line off-at-start"
		d="M 650 80  L  690 80    690 280     940 280 940 130  "
		/>

<!-- MDR -->
	<path id="mdr_Ld_to_microcode" class="blue-line off-at-start"
		d="M 620 340   L  690 340   690 280     960 280 960 130  "
		/>
	<path id="mdr_Out_to_microcode" class="blue-line off-at-start"
		d="M 620 360   L  690 360   690 280     960 280 960 130  "
		/>

<!-- MAR -->
	<path id="mar_Ld_to_microcode" class="blue-line off-at-start"
		d="M 375 340   L  450 340   450 280     980 280 980 130  "
		/>
	<path id="mar_Out_to_microcode" class="blue-line off-at-start"
		d="M 375 360   L  450 360   450 280     980 280 980 130  "
		/>


<!-- input -->
	<path id="input_Ld_to_microcode" class="blue-line off-at-start"
		d="M 1100 340   L  1150 340   1150 280     900 280 900 130  "
		/>
	<path id="input_Out_to_microcode" class="blue-line off-at-start"
		d="M 1100 360   L  1150 360   1150 280     900 280 900 130  "
		/>


<!-- output -->
	<path id="output_Ld_to_microcode" class="blue-line off-at-start"
		d="M 1300 340   L  1350 340   1350 280     920 280 920 130  "
		/>
	<path id="output_Out_to_microcode" class="blue-line off-at-start"
		d="M 1300 360   L  1350 360   1350 280     920 280 920 130  "
		/>



<!-- Microcode PC -->
	<path id="Microcode_PC_Ld_to_microcode" class="blue-line off-at-start"
		d="M 1300 40   L  1350 40   1350 280     880 280 880 130  "
		/>
	<path id="Microcode_PC_Clr_to_microcode" class="blue-line off-at-start"
		d="M 1300 60   L  1350 60   1350 280     880 280 880 130  "
		/>


<!-- Main Memory -->
<!--
	<rect id="id_memory" x="250" y="420" width="400" height="250" fill="#d0d0d0" stroke="#000000" stroke-width="1" onclick="infoOn('id_memory',254,480,400,860);"/>
		<text x="400" y="415" class="small">Main Memory</text>
		<text x="254" y="440" class="small">Address 8K Words</text>
		<text x="254" y="460" class="small">Data 16 bits wide</text>
		<rect id="id_mdr_Ld" x="650" y="440" width="40" height="1" class="input-line" />
			<text x="655" y="434" class="vsmall">Read</text>
		<rect id="id_mdr_Ld" x="650" y="460" width="40" height="1" class="input-line" />
			<text x="655" y="454" class="vsmall">Write</text>
-->
	<path id="Main_Memory_Read" class="blue-line off-at-start"
		d="M 650 440   L  730 440   730 280     1080 280 1080 130  "
		/>
	<path id="Main_Memory_Write" class="blue-line off-at-start"
		d="M 650 460   L  730 460   730 280     1060 280 1060 130  "
		/>

<!--
		<rect id="id_Microcode_Out[2]deccoder_ctl_a"  x="1120"   y="130"   width="1"    height="135"     class="input-line" />
		<rect id="id_Microcode_Out[2]deccoder_ctl_b"  x="1120"   y="265"   width="105"  height="1"     class="input-line" />
				1120+105 =
			<g transform="rotate(90 1000 400) translate(-350 14)" onclick="infoOn('decoder-info');">
-->
	<path id="microcode_to_decoder_ctl" class="blue-line off-at-start"
		d="M 1120 130   L  1120 265  1225 265 1225 240 M 1215 245 L 1215 265"
		/>

<!--
	Green Decoder Lines
-->
	<g id="ir_15_12_to_decoder_mux_11" class="off-at-start">
		<path class="light-green-line"
			d="M 1135 130   L 1135 155  1170 155  1170 240  1200 240  "
			/>
		<path class="light-green-line"
			d="M 200 170   L 1135 170  1170 170  1170 240  1200 240  "
			/>
			<text id="h_ir_val_15_12" x="350"  y="165" class="vsmall off-at-start">0 0 0 0</text>
	</g>
	<g id="ir_11_08_to_decoder_mux_10" class="off-at-start">
		<path class="light-green-line"
			d="M 1135 130   L 1135 155  1170 155  1170 228  1200 228  "
			/>
		<path class="light-green-line"
			d="M 200 200   L 1135 200  1170 200  1170 228  1170 228  "
			/>
			<text id="h_ir_val_11_08" x="350"  y="195" class="vsmall off-at-start">1 1 1 1</text>
	</g>

	<!--	showLine("#id_mar_Out_to_memory"); -->
	<!-- Connection from mar to Main Memory -->
	<g id="id_mar_Out_to_memory" class="off-at-start">
		<path class="light-green-line"
			d="M 335 375   L  335 415 "
			/>
		<!-- Arrow -->
	</g>

	<!-- Connection from mdr to Main Memory -->
	<g id="id_mdr_to_memory" class="off-at-start">
		<path class="light-green-line"
			d="M 570 375   L  570 415 "
			/>
		<!-- Arrow -->
	</g>

	<g id="id_memory_to_mdr" class="off-at-start">
		<path class="light-green-line"
			d="M 570 375   L  570 415 "
			/>
	</g>
		<!-- Arrow -->

	<!--
		<rect id="id_result_zero_out" x="350" y="120" width="47" height="1" class="input-line" />
			<text x="355" y="115" class="vsmall" onclick="infoOn('id_result_zero_out');">Is Zero</text>
	-->
	<g id="id_is_zero_to_mux" class="off-at-start">
		<path class="light-cyan-line"
			d="M 1135 130   L 1135 155  1170 155  1170 208  1200 208  "
			/>
		<path class="light-cyan-line"
			d="M 350 120   L  397 120  397 208   1200 208 "
			/>
			<text id="h_is_zero_output" x="450"  y="200" class="vsmall off-at-start"></text>
	</g>





<!-- Buttons -->
		<rect id="b-help"            x="40" y="300" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('help');"/>
		<text id="b-help-txt"        x="45" y="317" class="small" onclick="infoOn('help');">Help</text>

		<rect id="b-clear-line"      x="40" y="330" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('clear-line');"/>
		<text id="b-clear-line-txt"  x="45" y="347" class="small" onclick="infoOn('clear-line');">Clear Lines</text>

		<rect id="b-load-memory"     x="40" y="360" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('load-memory');"/>
		<text id="b-load-memory-txt" x="45" y="377" class="small" onclick="infoOn('load-memory');">Load Memory</text>

		<rect id="b-step"            x="40" y="390" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('load-mc');"/>
		<text id="b-step-txt"        x="45" y="407" class="small" onclick="infoOn('load-mc');">Load Microcode</text>

		<rect id="b-run"             x="40" y="420" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('step');"/>
		<text id="b-run-txt"         x="45" y="437" class="small" onclick="infoOn('step');">Step Tick</text>

		<rect id="b-input"           x="40" y="450" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('step-ins');"/>
		<text id="b-input-txt"       x="45" y="467" class="small" onclick="infoOn('step-ins');">Step Instruction</text>

		<rect id="b-reset"           x="40" y="480" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('run');"/>
		<text id="b-reset-txt"       x="45" y="497" class="small" onclick="infoOn('run');">Run</text>

		<rect id="b-load-mc"         x="40" y="510" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('reset');"/>
		<text id="b-load-mc-txt"     x="45" y="527" class="small" onclick="infoOn('reset');">Reset</text>

		<rect id="b-step-ins"        x="40" y="540" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('input');"/>
		<text id="b-step-ins-txt"    x="45" y="557" class="small" onclick="infoOn('input');">Input</text>

		<rect id="b-setup-cfg"       x="40" y="570" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('setup-cfg');"/>
		<text id="b-setup-cfg-txt"   x="45" y="587" class="small" onclick="infoOn('setup-cfg');">Setup / Test</text>

		<rect id="b-logic-probe"     x="40" y="600" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('logic-probe');"/>
		<text id="b-logic-probe-txt" x="45" y="617" class="small" onclick="infoOn('logic-probe');">Logic Probe</text>

		<rect id="b-show-memory"     x="40" y="630" rx="6" ry="6" width="120" height="25" class="button-box" onclick="infoOn('show-memory');"/>
		<text id="b-show-memory-txt" x="45" y="647" class="small" onclick="infoOn('show-memory');">Show Memory</text>



	<g id="is_halted" class="off-at-start">
		<text x="20" y="35" class="small">Halt</text>
		<circle cx="35" cy="50" r="10" stroke="black" stroke-width="1" fill="#ee4040" />
	</g>
	<g id="set_run">
		<text x="20" y="35" class="small">Run</text>
		<circle cx="35" cy="50" r="10" stroke="black" stroke-width="1" fill="#00f040" />
	</g>



	<g id="is_fetch" class="off-at-start">
		<text x="14" y="80" class="small">Fetch</text>
		<circle cx="35" cy="95" r="10" stroke="black" stroke-width="1" fill="#40bdff" />
	</g>
	<g id="set_execute">
		<text x="9" y="80" class="small">Execute</text>
		<circle cx="35" cy="95" r="10" stroke="black" stroke-width="1" fill="#00f040" />
	</g>



	<g id="is_error" class="off-at-start">
		<text x="18" y="126" class="small">Error</text>
		<circle cx="35" cy="140" r="10" stroke="black" stroke-width="1" fill="#ee4040" />
	</g>
	<g id="set_ok">
		<text x="22" y="126" class="small">OK</text>
		<circle cx="35" cy="140" r="10" stroke="black" stroke-width="1" fill="#00f040" />
	</g>



 </g>
</svg>

<!-- The Modal : Microcode Load ======================================================== -->
<div id="myModal1" class="modal hideMyModal">

	<!-- Modal content -->
	<div class="modal-content">
		<div class="modal-header">
			<span class="close" onclick="hideModal();">&times;</span>
			<h4>Load Code Into Microcode Memory</h4>
		</div>
		<div class="modal-body">
			<p>Enter the hash printed out by McAsm with the --upload flag.</p>
			<input id="modal-input-code-hash" spellcheck="false" name="i_hash" class="hash-input">
		</div>
		<div class="modal-footer">
			<button class="modal-submit" type="button" id="modal-submit" onclick="LoadMC();">Load Code</button>
		</div>
	</div>

</div>

<!-- The Modal : Code Load ======================================================== -->
<div id="myModal2" class="modal hideMyModal">

	<!-- Modal content -->
	<div class="modal-content">
		<div class="modal-header modal-blue-top">
			<span class="close" onclick="hideModal();">&times;</span>
			<h4>Load Hex Code Into Main Memory</h4>
		</div>
		<div class="modal-body">
			<p>Enter the hash printed out by Asm with the --upload flag.</p>
			<input id="modal-input-mm-hash" spellcheck="false" name="i_hash" class="hash-input">
		</div>
		<div class="modal-footer modal-blue-bot">
			<button class="modal-submit" type="button" id="modal-submit2" onclick="LoadMM();">Load Hex File</button>
		</div>
	</div>

</div>

<!-- The Modal : Show Memory  ======================================================== -->
<div id="myModal3" class="modal hideMyModal">

	<!-- Modal content -->
	<div class="modal-content">
		<div class="modal-header">
			<span class="close" onclick="hideModal();">&times;</span>
			<h4>Address in Main Memory</h4>
		</div>
		<div class="modal-body">
			<p>Enter the address in hex you want to have shown</p>
			<input id="modal-input-ma" spellcheck="false" name="i_mm_addr" class="mem-input">
		</div>
		<div class="modal-footer">
			<button class="modal-submit" type="button" id="modal-submit3" onclick="LoadMA();">Show Address</button>
		</div>
	</div>

</div>

<!-- The Modal : Setup / Test ======================================================== -->
<div id="myModal4" class="modal hideMyModal">

	<!-- Modal content -->
	<div class="modal-content">
		<div class="modal-header">
			<span class="close" onclick="hideModal();">&times;</span>
			<h4>Setup and Test</h4>
		</div>
		<div class="modal-body">
			<h5>Speed for running when "Run" button is pressed.</h5>
			<input id="modal-input-run-time" spellcheck="false" name="i_st_run_time"><br>
			<h5> Tests that can be run </h5>
			<input type="checkbox" checked id="modal-single-step-test">Single Tick Through the Test?<br><br>
			<select id="modal-select-test">
				<option value="" selected> -- no test selected -- </option>
				<option value="test7000">  7000:  Halt                                                       </option>
				<option value="test2000">  2000:  Load / Halt                                                </option>
				<option value="test5001">  5001:  Load / Add / Halt                                          </option>
				<option value="test5002">  5002:  Load / Subt / Halt                                         </option>
				<option value="test5003">  5003:  Clear / Subt / Halt                                        </option>
				<option value="test5004">  5004:  Clear / Jump / Halt / Halt                                 </option>
				<option value="test5005">  5005:  Load / Store / Halt                                        </option>
				<option value="test5007">  5007:  Input   - 0x5000                                           </option>
				<option value="test5006">  5006:  Output  - 0x6000                                           </option>
				<option value="test5010">  5010:  SkipLt0 - 0x8000 / ac &gt; 0                               </option>
				<option value="test5011">  5011:  SkipLt0 - 0x8000  / ac &lt; 0                              </option>
				<option value="test5012">  5012:  SkipLt0 - 0x8000  / ac == 0 (should behave like test 5010) </option>
				<option value="test5020">  5020:  SkipGt0 - 0x8800  / ac &gt; 0                              </option>
				<option value="test5021">  5021:  SkipGt0 - 0x8800  / ac &lt; 0                              </option>
				<option value="test5022">  5022:  SkipGt0 - 0x8800  / ac == 0 (should behave like test 5020) </option>
				<option value="test5030">  5030:  SkipEq0 - 0x8400  / ac &gt; 0                              </option>
				<option value="test5031">  5031:  SkipEq0 - 0x8400  / ac &lt; 0                              </option>
				<option value="test5032">  5032:  SkipEq0 - 0x8400  / ac == 0                                </option>
				<option value="test5040">  5040:  LoadI   - 0xd000                                           </option>
				<option value="test5041">  5041:  StoreI  - 0xe000                                           </option>
				<option value="test5043">  5043:  AddI    - 0xB000                                           </option>
				<option value="test5042">  5042:  JumpI   - 0xc000                                           </option>
				<option value="test5044">  5044:  JnS     - 0x0000                                           </option>
				<option value="test1000">  1000:  PC                                                         </option>
				<option value="test1001">  1001:  PC -&gt; MAR                                               </option>
				<option value="test1102">  1102:  Output -&gt; 7-seg                                         </option>
				<option value="test1101">  1101:  AC -&gt; Output                                            </option>
				<option value="test1003">  1003:  MDR -&gt; Bus -&gt; MAR                                    </option>
				<option value="test1104">  1104:  Result -&gt; AC                                            </option>
				<option value="test1105">  1105:  Input -&gt; AC                                             </option>
				<option value="test1002">  1002:  PC -&gt; MAR -&gt; Memory Read -&gt; IR                    </option>
				<option value="test3000">  3000:  Test MUX                                                   </option>
				<option value="test3001">  3001:  Test ALU                                                   </option>
				<option value="test7000">  7000:  Halt                                                       </option>
				<option value="test2000">  2000:  Test Load, Halt                                            </option>
			</select><br>
			<p>&nbsp;</p>
		</div>
		<div class="modal-footer">
			<button class="modal-submit" type="button" id="modal-submit4" onclick="DoSetupTest_Config();">Apply</button>
			<button class="modal-submit" type="button" id="modal-submit4" onclick="DoSetupTest_RunTest();">Run Test</button>
		</div>
	</div>

</div>

<!-- The Modal : Collect Input  ======================================================== -->
<div id="myModal5" class="modal hideMyModal">

	<!-- Modal content -->
	<div class="modal-content">
		<div class="modal-header">
			<span class="close" onclick="hideModal();">&times;</span>
			<h4>Input to be used by <b>Input</b> instructions.</h4>
		</div>
		<div class="modal-body">
			<h5>Input</h5>
			<input id="modal-input-0" spellcheck="false" name="i_input_0" class="mem-input"><br>
			<input id="modal-input-1" spellcheck="false" name="i_input_1" class="mem-input"><br>
			<input id="modal-input-2" spellcheck="false" name="i_input_2" class="mem-input"><br>
			<input id="modal-input-3" spellcheck="false" name="i_input_3" class="mem-input"><br>
			<input id="modal-input-4" spellcheck="false" name="i_input_4" class="mem-input"><br>
			<input id="modal-input-5" spellcheck="false" name="i_input_5" class="mem-input"><br>
			<input id="modal-input-6" spellcheck="false" name="i_input_6" class="mem-input"><br>
			<input id="modal-input-7" spellcheck="false" name="i_input_7" class="mem-input"><br>
			<input id="modal-input-8" spellcheck="false" name="i_input_8" class="mem-input"><br>
			<input id="modal-input-9" spellcheck="false" name="i_input_9" class="mem-input"><br>
		</div>
		<div class="modal-footer">
			<button class="modal-submit" type="button" id="modal-submit5" onclick="DoInput();">Collect Input</button>
		</div>
	</div>

</div>

<script>

var debug_PropagateSignals = false ;
var run_timing = 500;	// In MS = 1/10th of a second.





// Get the <span> element that closes the modal
// var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal 
function displayModal () {
	// modal.style.display = "block";
	$("#myModal1").css ( { "display":"block" } );
}
function displayModalMM () {
	$("#myModal2").css ( { "display":"block" } );
}
function displayModalMA () {
	$("#myModal3").css ( { "display":"block" } );
}
function displayModalSetupTest () {
	$("#modal-input-run-time" ).val(run_timing);
	$("#myModal4").css ( { "display":"block" } );
}
function displayModalInput () {
	$("#myModal5").css ( { "display":"block" } );
}

// When the user clicks on <span> (x), close the modal
function hideModal() {
	// modal.style.display = "none";
	$(".hideMyModal").css ( { "display":"none" } );
}


// Get the modal
var modal1 = document.getElementById("myModal1");
var modal2 = document.getElementById("myModal2");
var modal3 = document.getElementById("myModal3");
var modal4 = document.getElementById("myModal4");
var modal5 = document.getElementById("myModal5");
// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
	if (event.target == modal1) {
		//modal.style.display = "none";
		hideModal();
	} else if (event.target == modal2) {
		//modal.style.display = "none";
		hideModal();
	} else if (event.target == modal3) {
		//modal.style.display = "none";
		hideModal();
	} else if (event.target == modal4) {
		//modal.style.display = "none";
		hideModal();
	} else if (event.target == modal5) {
		//modal.style.display = "none";
		hideModal();
	}
}

// Equvelance classes for wires - What is wired to what.


//var lineOn = [
//	 "#pc_Ld_to_microcode"
//	,"#pc_Inc_to_microcode"
//	,"#pc_Out_to_microcode"
//	,"#pc_Clr_to_microcode" 
//	,"#ir_15_12_to_decoder_11" 
//	,"#ir_11_8_to_decoder_10"
//	,"#ir_Ld_to_microcode" 
//	,"#ir_Out_to_microcode"
//	,"#alu_ctl_4_to_microcode"
//	,"#result_Ld_to_microcode" 
//	,"#result_Out_to_microcode"
//	,"#result_Clr_to_microcode"
//	,"#result_zero_out" 
//	,"#ac_Ld_to_microcode"
//	,"#ac_Out_to_microcode"
//	,"#ac_Out_to_ALU"
//	,"#mar_Ld_to_microcode" 
//	,"#mar_Out_to_microcode"
//	,"#mdr_Ld_to_microcode" 
//	,"#mdr_Out_to_microcode"
//	,"#input_Ld_to_microcode" 
//	,"#input_Out_to_microcode"
//	,"#output_Ld_to_microcode" 
//	,"#output_Out_to_microcode"
//	,"#Microcode_PC_Ld_to_microcode"
//	,"#Microcode_PC_Clr_to_microcode"
//	,"#Main_Memory_Read" 
//	,"#Main_Memory_Write"
//	,"#hand_out"
//	,"#microcode_to_decoder_ctl"
//	,"#id_Microcode_PC_Inc" 
//	,"#mm_to_dec_11" 
//	,"#mm_to_dec_10" 
//	,"#mm_to_dec_01" 
//	,"#mm_to_dec_00" 
//	,"#is_halted"
//	,"#is_fetch"
//	,"#is_error"
//	,"#ir_15_12_to_decoder_mux_11"
//	,"#ir_11_08_to_decoder_mux_10"
//	,"#id_hand_out"
//	,"#id_mar_Out_to_memory" 
//	,"#id_mdr_to_memory" 
//	,"#id_memory_to_mdr" 
//	,"#id_ir_to_bus_full_hand_out"
//	// Text hidden until ready to use.
//		, "#h_alu_A_txt" 
//		, "#h_alu_B_txt" 
//		, "#h_alu_Out_txt" 
//		, "#h_mux_out_to_MPC" 
//		, "#h_ir_val_15_12" 
//		, "#h_ir_val_11_08" 
//];	// List of IDs of lines that are turned-on

var lineOn = [
	".off-at-start"
];

function clearOtherLine() {
	for ( var i = 0; i < lineOn.length; i++ ) {
		var x = lineOn[i];
		$(x).hide()
	}
	lineOn = [];	
}

clearOtherLine();

function showLine(id) {
	// clearOtherLine()
	var i = 0;
	for ( var j = 0, mx = arguments.length; j < mx && i < 16; i++, j++ ) {
		id = arguments[j];
		if ( $(id) ) {				// Check that the ID exists in the HTML code.
			$(id).show();
			var fnd = false;		// Only add unique IDs to lineOn
			for ( var k = 0; k < lineOn.length; k++ ) {
				if ( lineOn[k] === id ) {
					fnd = true;
					break;
				}
			}
			if ( !fnd ) {			// Not fnd, so unique -push to lineOn
				lineOn.push(id);
			}
		}
	}
}

var textCur = 0;
var textBuf = [];

function clearText() {
	for ( var i = 0; i < 16; i++ ) {
		$("#line_"+i).html("");
	}
	textCur = 0;
	textBuf = [];
}

function showTextInOutputBox(text) {
	var i = textCur;
	var jj = textCur;
	for ( var j = 0, mx = arguments.length; j < mx && i < 16; i++, j++ ) {
		var sss = arguments[j];
		// console.error ( sss, textBuf );
		if ( textCur > 0 && textBuf[textCur-1] == sss ) {
		} else {
			// console.error ( "Will be added", sss, textBuf );
			var x = arguments[i];
			// console.log ( "i=", i, "j=", j, x, jj );
			$("#line_"+jj).html(arguments[j]);
			textBuf.push(sss);
			textCur++;
			jj++;
		}
	}
}

// ---------------------------------------------------------------------------------------------------------------------------------------
// Globals
// ---------------------------------------------------------------------------------------------------------------------------------------
var mm_max = 0;
var isHalted = 0;
var doRun = false;
var myVar = setInterval(myTimer, run_timing);
var curPosInput = 0;
var theInput = [];

// ---------------------------------------------------------------------------------------------------------------------------------------
// Functions for turn on/off of 3 leds at top-left of display.
// ---------------------------------------------------------------------------------------------------------------------------------------

function showHalt ( _isHalted ) {
	if ( _isHalted ) {
		isHalted = _isHalted;
		$("#set_run").hide();
		$("#is_halted").show();
	} else {
		$("#is_halted").hide();
		$("#set_run").show();
	}
}

function showFetch ( isFetch ) {
	if ( isFetch ) {
		$("#set_execute").hide();
		$("#is_fetch").show();
	} else {
		showMemoryAtPC ( PC.x._data_ - 1 );
		$("#is_fetch").hide();
		$("#set_execute").show();
	}
}

function showIsError ( isError ) {
	if ( isError ) {
		$("#set_ok").hide();
		$("#is_error").show();
	} else {
		$("#is_error").hide();
		$("#set_ok").show();
	}
}

// ---------------------------------------------------------------------------------------------------------------------------------------
// DoSetupTest - implementaiton for the modal setup/test
// ---------------------------------------------------------------------------------------------------------------------------------------

function DoSetupTest_Config() {
	// <input id="modal-input-run-time" spellcheck="false" name="i_st_run_time"><br>
	run_timing = parseInt ( $("#modal-input-run-time" ).val() );
	if ( run_timing < 0 ) {
		console.error ( "Invalid timing value - setting to 500" );
		run_timing = 500;
	} else if ( run_timing < 100 ) {
		run_timing = 100;
	}
	hideModal();
}

function DoSetupTest_RunTest() {
	// <input type="checkbox" checked id="modal-single-step-test">Single Tick Through the Test?<br>
	// <select id="modal-select-test">
	var isChecked = $("#modal-single-step-test").is(":checked");
	var testToRun = $("#modal-select-test").val();
	console.error ( "isChecked=", isChecked, " testToRun=", testToRun );
	if ( ! window[testToRun] ) {
		console.error ( "Invalid test name", testToRun );
	} else {
		var fx = window[testToRun];
		fx(isChecked);
	}
	hideModal();
}


// ---------------------------------------------------------------------------------------------------------------------------------------
// Run Command setup/run
// ---------------------------------------------------------------------------------------------------------------------------------------

function myTimer() {
	if ( doRun ) {
		var d = new Date();
		var t = d.toLocaleTimeString();
		console.log ( "Run Enabled", t );
		// if ( !!(theWorld2.ins_end === 1) ) {
		// 	doRun = false;
		// } else if ( !!(theWorld2.is_halted) ) {
		if ( !!(theWorld2.is_halted) ) {
			doRun = false;
		} else {
			Step1Tick();
		}
	}
}

function StartRun() {
	// Run1TickInit();
	doRun = true;
}

function StopRun() {
	doRun = false;
}

function myStopFunction() {
  clearInterval(myVar);
}

// ---------------------------------------------------------------------------------------------------------------------------------------
// Put up a form to collect up to 10 inputs that can get pulled.
// ---------------------------------------------------------------------------------------------------------------------------------------


function CollectInput() {
	curPosInput = 0;
	for ( var i = 0; i < 10; i++ ) {
		$("#modal-input-"+i).val(theInput[i]);
	}
	displayModalInput();
}

function DoInput() {
	curPosInput = 0;
	//	<input id="modal-input-0" spellcheck="false" name="i_mm_addr" class="mem-input"><br>
	for ( var i = 0; i < 10; i++ ) {
		var v = $("#modal-input-"+i).val();
		if ( v == "" ) {
			theInput[i] = 0;
		} else {
			var w = parseInt(v,16);
			theInput[i] = w;
		}
	}
	hideModal();
}

function GetInput() {
	if ( curPosInput < 10 ) {
		var v = theInput[curPosInput];
		curPosInput++;
		return ( v );
	}
	return ( 0 );
}

// ---------------------------------------------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------------------------------------------

function infoOn(x) {
	clearOtherLine();
	clearText();
	for ( var i = 0, mx = arguments.length; i < mx; i++ ) {
		var x = arguments[i];
		infoOn1(i,x);
	}
}

function infoOn1(i,x) {

	switch ( x ) {

	case "clear-line":
		break;
	case "help":
		showTextInOutputBox("MARIA Microcode Emulator: Version v1.4.4"
			,"Built on: Sat Mar 14 16:00:54 MDT 2020" 
			,""
			,"Load assembled microcode and assembled instructions, then step or run."
			,""
			,"https://github.com/Univ-Wyo-Education/S20-2150/McRun/ for more detailed help."
			,""
			,"Developed for the Deptatmentment of Computer Science 2150 Machine Architecture class."
			,"Copyright (C) University of Wyoming, 2019-2020." 
			);
		break;
	case "load-mc":
		console.log ( "load-mc - load microcode" );
		displayModal() ;
		// Display Form - setup for "Submit" button.
		break;
	case "decoder-info":
		showLine("#microcode_to_decoder_ctl");
		showTextInOutputBox("Decoder takes 2 input lines and has 4 8-wide inputs connecting to 1 8-wide output."
			,"The control lines select the input source."
			,"Lines that are not hooked to other sources are Out_7 to Out_0 from the Microcode."
			, ""
			," CTL   Instruction"
			," ---  -----------------------------------------------------"
			,"  00   Microcode Jmp (Halt, Unused)"
			,"  01   Jump if (Is Zero) from Result/Cmp - Microcode PC Inc Twice"
			,"  10   Skip { SkipEe0, SkipGt0, SkipLt0 }"
			,"  11   Common IR Decode"
			);
		break;
	case "load-memory":
		displayModalMM() ;
		break;
	case "reset":
		ResetMachine();
		break;
	case "step":	// Step Tick
		if ( isHalted ) {
			showTextInOutputBox("Processor is halted.  You must reset before you can continue." );
		} else {
			Step1Tick();
		}
		break;
	case "step-ins":	// Step 1 Instruction
		Step1Ins();
		break;
	case "show-memory":
		displayModalMA();
		break;
	case "setup-cfg":	// Setup or run of tests.
		displayModalSetupTest () ;
		break;
	case "run":	// 
		StartRun();
		break;
	case "input":	// 
		CollectInput();
		break;

	// logic-probe


	case "id_pc":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("PC - Program Counter");
		break;
	case "id_pc_Ld":
		showLine("#pc_Ld_to_microcode");
		showTextInOutputBox("pc_Ld - Load Register");
		break;
	case "id_pc_Inc":
		showLine("#pc_Inc_to_microcode");
		showTextInOutputBox("pc_Inc - Increment Register");
		break;
	case "id_pc_Out":
		showLine("#pc_Out_to_microcode");
		showTextInOutputBox("pc_Out - Output Register to Bus");
		break;
	case "id_pc_Clr":
		showLine("#pc_Clr_to_microcode");
		showTextInOutputBox("pc_Clr - Clear Register, set to 0");
		break;


	case "id_ir":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("IR - Instruction Register");
		break;
	case "id_ir_Ld":
		showLine("#ir_Ld_to_microcode");
		break;
	case "id_ir_Out":
		showLine("#ir_Out_to_microcode");
		break;
	case "hand_out":
		showTextInOutputBox("Take the least-significant 12 bits of the IR and puts that on the bus - with 0's for the most","significant nibble (4 bits).","","IR_Out must be enabled at the same time.");
		showLine("#hand_out");
		break;
	case "id_full_hand_out":
	case "full_hand_out":
		// xyzzy IR.TurnOn ( "full_hand_out" );
		// xyzzy_5010_003: turn on line under gray hand_out box and arrow
		showLine("#id_ir_to_bus_full_hand_out");
		break;

// ,"#Hand_Out_to_microcode"
	case "id_hand_out":
		showLine("#id_hand_out");
		// <text id="id_hand_out_value" x="245" y="268" class="small"></text>
		var sv = toHex( theWorld2["Bus"], 4 );
		$("#id_hand_out_value").html(sv);
		break;

	case "id_result":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("Result - Output from ALU");
		break;
	case "id_result_Ld":
		showLine("#result_Ld_to_microcode");
		break;
	case "id_result_Out":
		showLine("#result_Out_to_microcode");
		break;
	case "id_result_Clr":
		showLine("#result_Clr_to_microcode");
		break;
	case "id_result_zero_out":
		showLine("#result_zero_out","#mm_to_dec_01");
		showTextInOutputBox("Connects 1 bit to decoder input 01.","The other addresses come from the McJmp_X");
		break;

	case "id_ac":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("AC - Accumulator");
		break;
	case "id_ac_Ld":
		showLine("#ac_Ld_to_microcode");
		break;
	case "id_ac_Out":
		showLine("#ac_Out_to_microcode");
		break;
	case "id_ac_Out_to_ALU":
		showLine("#ac_Out_to_ALU");
		break;

	case "id_ALU_Ctl":
		showLine("#alu_ctl_4_to_microcode");
		showTextInOutputBox("4 control lines for determining the Arithmetic or Logic Operation performed.");
		break;

//	,"#mar_Ld_to_microcode" 
//	,"#mar_Out_to_microcode"
	case "id_mar":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("MAR - Memory Address Register");
		break;
	case "id_mar_Ld":
		showLine("#mar_Ld_to_microcode");
		break;
	case "id_mar_Out":
		showLine("#mar_Out_to_microcode");
		break;
	case "id_mar_Out_to_Memory":
		showLine("#id_mar_Out_to_memory");
		break;

//	,"#mdr_Ld_to_microcode" 
//	,"#mdr_Out_to_microcode"
	case "id_mdr":
		showTextInOutputBox("MDR (mbr) - Memory Data Register - Buffer memory read/write");
		$("#"+x).css("fill","#ff0000");
		break;
	case "id_mdr_Ld":
		showLine("#mdr_Ld_to_microcode");
		break;
	case "id_mdr_Out":
		showLine("#mdr_Out_to_microcode");
		break;
/*
xyzzy
*/
	case "id_mdr_xyzzy":
		showLine("#id_mdr_Out_to_memory");
		break;

//	,"#input_Ld_to_microcode" 
//	,"#input_Out_to_microcode"
	case "id_input":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("Input Register","You need to set the input value before the input instruction runs.");
		break;
	case "id_input_Ld":
		showLine("#input_Ld_to_microcode");
		break;
	case "id_input_Out":
		showLine("#input_Out_to_microcode");
		break;

//	,"#output_Ld_to_microcode" 
//	,"#output_Out_to_microcode"
	case "id_output":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("Output from the CPU");
		break;
	case "id_output_Ld":
		showLine("#output_Ld_to_microcode");
		break;
	case "id_output_Out":
		showLine("#output_Out_to_microcode");
		break;


//	,"#Microcode_PC_Ld_to_microcode"
//	,"#Microcode_PC_Clr_to_microcode"
	case "id_Microcode_PC":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("PC for the Microcode Instructions");
		break;
	case "id_Microcode_PC_Ld":
		showLine("#Microcode_PC_Ld_to_microcode");
		break;
	case "id_Microcode_PC_Clr":
		showLine("#Microcode_PC_Clr_to_microcode");
		break;


	case "id_microcode":
		$("#"+x).css("fill","#ff0000");
		showTextInOutputBox("The Microcode Instructions");
		break;


//	,"#Main_Memory_Read" 
//	,"#Main_Memory_Write"
	case "id_memory":
		$("#"+x).css("fill","#ff0000");
		break;
	case "id_memory_Read":
		// console.error(stackTrace());
		showLine("#Main_Memory_Read");
		showLine("#id_memory_to_mdr");
		break;
	case "id_memory_Write":
		// console.error(stackTrace());
		showLine("#Main_Memory_Write");
		showLine("#id_memory_to_mdr");
		break;


	case "ir_decode_g1":
		showLine("#ir_15_12_to_decoder_11","#mm_to_dec_11");
		showTextInOutputBox("Instruction decode uses 1 bit of output from the Microcode Out[8] (Out_7)"
			,"then 4 bits of the IR, the 3 bits of Out[8] (Out_2, Out_1, Out_0)."
			,""
			,"Given that Out_7 is a one for the high addresses of the memory, then the instruction"
			,"0x2034 (Store) will jump to address 0b1_0010_000);  Set the Microcode_Ld to 1 and"
			,"the decoder_ctl_1 and decoder_clt_0 to 0b11 to select and load this address."
			,""
			,"The hand_Out gives us access in to the 12 bits of operand, the 034 portion of the instruction."
			,"Transfer the AC to the MDR with AC_Out = 1, and MDR_Ld = 1, then set the MAR_Ld to 1 and"
			,"the hand_Out to 1 to transfer the address from the IR to the MAR.  Then Memory_Write = 1"
			,"and the data is written to memory."
			);
		break;
	case "ir_decode_g2":
		showLine("#ir_11_8_to_decoder_10","#mm_to_dec_10");	
		showTextInOutputBox("Instruction decode use 01 bit of output from the Microcode Out[8] (Out_7, Out_6)","then 4 bits of the IR, the 2 bits of Out[8] (Out_1, Out_0).");
			// xyzzy - add addressing example
		break;

	case "mm_to_dec":
		showLine( "#mm_to_dec_11" ,"#mm_to_dec_10" ,"#mm_to_dec_01" ,"#mm_to_dec_00" );
		showTextInOutputBox("Output from the microcode is mixed with other output to produce a microcode jump address.");
		break;
		
	}
}


function toHex(d, padding) {
	var hex;
	if ( typeof d === "string" ) {
		hex = d;
	} else {
		hex = Number(d).toString(16);
	}
    padding = typeof (padding) === "undefined" || padding === null ? padding = 2 : padding;
    while (hex.length < padding) {
        hex = "0" + hex;
    }
    return hex;
}
function toDec(d, padding) {
	var hex;
	if ( typeof d === "string" ) {
		hex = d;
	} else {
		hex = Number(d).toString(10);
	}
    padding = typeof (padding) === "undefined" || padding === null ? padding = 2 : padding;
    while (hex.length < padding) {
        hex = "0" + hex;
    }
    return hex;
}
function toBin(d, padding) {
	var bin;
	if ( typeof d === "string" ) {
		bin = d;
	} else {
		bin = Number(d).toString(2);
	}
    padding = typeof (padding) === "undefined" || padding === null ? padding = 2 : padding;
    while (bin.length < padding) {
        bin = "0" + bin;
    }
    return bin;
}

var theWorld = {
	"Bus": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.Bus._used_ ) {
console.log ( "Called Bus.State, returing", theWorld.Bus._data_ );
				return ( theWorld.Bus._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'bus.State' when undefined" );
					theWorld.Bus._error_.push( "Warning: Pulling 'bus.State' when undefined" );
				}
				return ( theWorld.Bus._data_ );
			}
		}
		, "SetState": function ( v ) {		//Xyzzy - add in who is setting!
console.log ( "****************** SetState:", v );
			if (typeof(v) === "undefined" ) {
				return
			}
			// if ( theWorld.Bus._used_ ) {
			// 	theWorld.Bus._error_.push ( "Multiple SetState on the bus!" );
			// }
			theWorld.Bus._data_ = v;
			theWorld.Bus._used_ = true;
			var sVal = toHex(v,4);
			displayMainBus(sVal);
		}
		, "TickRise": function ( v ) {
			theWorld.Bus._data_ = undefined;
			theWorld.Bus._used_ = false;
			clearMainBus();
		}
		, "Error": function ( v ) {
			return ( theWorld.Bus._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.Bus._error_ = [];
		}
	}
	,"IsZero": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.IsZero._used_ ) {
				return ( theWorld.IsZero._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'IsZero.State' when undefined" );
					theWorld.IsZero._error_.push( "Warning: Pulling 'IsZero.State' when undefined" );
				}
				return ( theWorld.IsZero._data_ );
			}
		}
		, "SetState": function ( v ) {
			if (typeof(v) === "undefined" ) {
				return
			}
			theWorld.IsZero._data_ = v;
			theWorld.IsZero._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.IsZero._data_ = undefined;
			theWorld.IsZero._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.IsZero._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.IsZero._error_ = [];
		}
	}
	,"IR_15__12": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.IR_15__12._used_ ) {
				return ( theWorld.IR_15__12._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'IR_15__12.State' when undefined" );
					theWorld.IR_15__12._error_.push( "Warning: Pulling 'IR_15__12.State' when undefined" );
				}
				return ( theWorld.IR_15__12._data_ );
			}
		}
		, "SetState": function ( v ) {
			if (typeof(v) === "undefined" ) {
				return
			}
			theWorld.IR_15__12._data_ = v;
			theWorld.IR_15__12._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.IR_15__12._data_ = undefined;
			theWorld.IR_15__12._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.IR_15__12._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.IR_15__12._error_ = [];
		}
	}
	,"IR_11__8": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.IR_11__8._used_ ) {
				return ( theWorld.IR_11__8._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'IR_11__8.State' when undefined" );
					theWorld.IR_11__8._error_.push( "Warning: Pulling 'IR_11__8.State' when undefined" );
				}
				return ( theWorld.IR_11__8._data_ );
			}
		}
		, "SetState": function ( v ) {
			if (typeof(v) === "undefined" ) {
				return
			}
			theWorld.IR_11__8._data_ = v;
			theWorld.IR_11__8._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.IR_11__8._data_ = undefined;
			theWorld.IR_11__8._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.IR_11__8._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.IR_11__8._error_ = [];
		}
	}
	,"hand_out": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.hand_out._used_ ) {
				return ( theWorld.hand_out._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'hand.State' when undefined" );
					theWorld.hand_out._error_.push( "Warning: Pulling 'hand.State' when undefined" );
				}
				return ( theWorld.hand._data_ );
			}
		}
		, "SetState": function ( v ) {
			if (typeof(v) === "undefined" ) {
				return
			}
			theWorld.hand_out._data_ = v;
			theWorld.hand_out._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.hand_out._data_ = undefined;
			theWorld.hand_out._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.hand_out._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.hand_out._error_ = [];
		}
	}
	,"MAR_to_Memory": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.MAR_to_Memory._used_ ) {
				return ( theWorld.MAR_to_Memory._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'bus.State' when undefined" );
					theWorld.MAR_to_Memory._error_.push( "Warning: Pulling 'bus.State' when undefined" );
				}
				return ( theWorld.MAR_to_Memory._data_ );
			}
		}
		, "SetState": function ( v ) {
			if (typeof(v) === "undefined" ) {
				return
			}
			theWorld.MAR_to_Memory._data_ = v;
			theWorld.MAR_to_Memory._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.MAR_to_Memory._data_ = undefined;
			theWorld.MAR_to_Memory._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.MAR_to_Memory._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.MAR_to_Memory._error_ = [];
		}
	}
	,"MDR_to_Memory": {
		"_data_": 0
		, "_used_": false
		, "_error_": []
		, "State": function () {
			if ( theWorld.MDR_to_Memory._used_ ) {
				return ( theWorld.MDR_to_Memory._data_ );
			} else {
				var ignore = false;
				if ( arguments.length > 0 ) {
					ignore = arguments[0];
				}
				if ( ! ignore ) {
					console.log ( "Warning: Pulling 'bus.State' when undefined" );
					theWorld.MDR_to_Memory._error_.push( "Warning: Pulling 'bus.State' when undefined" );
				}
				return ( theWorld.MDR_to_Memory._data_ );
			}
		}
		, "SetState": function ( v ) {
			if (typeof(v) === "undefined" ) {
				return
			}
			theWorld.MDR_to_Memory._data_ = v;
			theWorld.MDR_to_Memory._used_ = true;
		}
		, "TickRise": function ( v ) {
			theWorld.MDR_to_Memory._data_ = underfined;
			theWorld.MDR_to_Memory._used_ = false;
		}
		, "Error": function ( v ) {
			return ( theWorld.MDR_to_Memory._error_ );
		}
		, "ClearError": function ( v ) {
			theWorld.MDR_to_Memory._error_ = [];
		}
	}

};

var Connections = {
	  "Microcode_PC_Addr": [ { Name:"MICROCODE",		Op: ["Addr"]      	} ]		// Kick start the process.
	, "id_pc_Out": [ { Name:"PC",						Op: ["Out"]      	} ]
	, "id_pc_Ld": [ { Name:"PC",						Op: ["Ld"]      	} ]
	, "id_pc_Inc": [ { Name:"PC",						Op: ["Inc"]      	} ]
	, "id_Microcode_PC_Clr": [ { Name:"MICROCODE_PC",	Op: ["Clr"]      	} ]
	, "id_Microcode_PC_Ld": [ { Name:"MICROCODE_PC",	Op: ["Ld"]      	} ]
	, "id_Microcode_PC_Inc": [ { Name:"MICROCODE_PC", 	Op: ["Inc"]      	} ]
	, "id_ac_Clr": [ { Name:"AC",						Op: ["Clr"]      	} ]
	, "id_ac_Inc": [ { Name:"AC",						Op: ["Inc"]      	} ]
	, "id_ac_Ld": [ { Name:"AC",						Op: ["Ld"]      	} ]
	, "id_ac_Out": [ { Name:"AC",						Op: ["Out"]      	} ]
	, "id_ac_Out_to_ALU": [ { Name:"AC",				Op: ["Out_to_ALU"] 	} ]
	, "id_input_Out": [ { Name:"INPUT",					Op: ["Out"]      	} ]
	, "id_input_Ld": [ { Name:"INPUT",					Op: ["Ld"]      	} ]
	, "id_ir_Ld": [ { Name:"IR",						Op: ["Ld"]      	} ]
	, "id_ir_Out": [ { Name:"IR",						Op: ["Out"]      	} ]
	, "id_mar_Ld": [ { Name:"MAR",						Op: ["Ld"]      	} ]
	, "id_mar_Out": [ { Name:"MAR",						Op: ["Out"]      	} ]
	, "id_mdr_Ld": [ { Name:"MDR",						Op: ["Ld"]      	} ]
	, "id_mdr_Out": [ { Name:"MDR",						Op: ["Out"]      	} ]
	, "id_memory_Read": [ { Name:"MEMORY",				Op: ["Read"]      	}
		, { Name:"MAR", Op:["Out_to_Memory"] }
		, { Name:"MDR", Op:["From_Memory_to_MDR"] }		
	]
	, "Memory_to_MDR": [
		  { Name:"MAR", Op:["Out_to_Memory"] }
		, { Name:"MEMORY", Op:["Read"] }
		, { Name:"MDR", Op:["From_Memory_to_MDR"] }		
	]
	, "id_memory_Write": [ { Name:"MEMORY",				Op: ["Write"]      	}
		, { Name:"MAR", Op:["Out_to_Memory"] }
		, { Name:"MDR", Op:["From_MDR_to_Memory"] }										// xyzzy - rename From_MDR_to_Memory
	]
	, "id_output_Ld": [ { Name:"OUTPUT",				Op: ["Ld"]      	} ]
	, "id_output_Out": [ { Name:"OUTPUT",				Op: ["Out"]      	} ]
	, "id_result_Ld": [ { Name:"RESULT",				Op: ["Ld"]      	} ]
	, "id_result_Out": [ { Name:"RESULT",				Op: ["Out"]      	} ]
	 
	//                                                   Always Jump -- All Bits 
	//                                                          IsZero - one bit 
	//                                                                  2nd Decode - Instruction IR Bits 11..8 
	//                                                                         1st Decode - Instruction MSB 15..12 of IR 
	, "McJmp_7": [ { Name: "MUX", 						Op: ["00_7","01_7","10_7","11_7"] } ]
	, "McJmp_6": [ { Name: "MUX", 						Op: ["00_6","01_6","10_6"       ] } ]
	, "McJmp_5": [ { Name: "MUX", 						Op: ["00_5","01_5"              ] } ]
	, "McJmp_4": [ { Name: "MUX", 						Op: ["00_4","01_4"              ] } ]
	, "McJmp_3": [ { Name: "MUX", 						Op: ["00_3","01_3"              ] } ]
	, "McJmp_2": [ { Name: "MUX", 						Op: ["00_2","01_2"       ,"11_2"] }	]
	, "McJmp_1": [ { Name: "MUX", 						Op: ["00_1"       ,"10_1","11_1"] } ]
	, "McJmp_0": [ { Name: "MUX", 						Op: ["00_0","01_0","10_0","11_0"] } ]
 
	, "id_decoder_Ctl_0": [ {Name: "MUX",				Op: ["Ctl_0"] } ]
	, "id_decoder_Ctl_1": [ {Name: "MUX",				Op: ["Ctl_1"] } ]

	, "id_ALU_Ctl_0": [ { Name: "ALU",					Op: ["Ctl_0"] } ]
	, "id_ALU_Ctl_1": [ { Name: "ALU",					Op: ["Ctl_1"] } ]
	, "id_ALU_Ctl_2": [ { Name: "ALU",					Op: ["Ctl_2"] } ]
	, "id_ALU_Ctl_3": [ { Name: "ALU",					Op: ["Ctl_3"] } ]

//hand_out 24

};

// ----------------------------------------------------------------------------------------------------------------------------------------
function RunConnections () {
	for ( var cur in theWorld2 ) {
		// for ( var key in Connections ) {
// console.log ( "cur=", cur );
		if ( typeof Connections[cur] !== "undefined" ) {
			var wireTo = Connections[cur];
			// console.log ( "For "+cur+" wireTo=", wireTo );
			for ( var ww = 0, my = wireTo.length; ww < my; ww++ ) {
				var name = wireTo[ww].Name;
				var op = wireTo[ww].Op;
				for ( var kk = 0, mx = op.length; kk < mx; kk++ ) {
					var toCall = name+".msg('"+op[kk]+"',1);";
					if ( ! thisTick[toCall] ) { // thisTick ??
// console.log ( ">>>Connections CALLING<<<: "+name+".msg('"+op[kk]+"',1);" ); 
						if ( window[name] && window[name].msg ) {
							window[name].msg ( op[kk], 1 );						// connection from "wire" to chip.
						} else {
							console.error ( "RunConnections: failed for: ", name+".msg('"+op[kk]+"',1);" ); 
						}
					} else {
// console.log ( ">>>Skipped", toCall);
					}
					thisTick[toCall] = 1;
				}
			}
		}
	}
}


function clearMicrocodeText() {
	$("#microcode_txt_0").text("");
	$("#microcode_txt_1").text("");
}

function displayMicrocodeText(t1,t2,t3,t4,t5) {
	clearMicrocodeText();
	$("#h_microcode_txt_0").text(t1);
	$("#h_microcode_txt_1").text(t2);
	$("#h_microcode_txt_2").text(t3);
	$("#h_microcode_txt_3").text(t4);
	$("#h_microcode_txt_4").text(t5);
}

function displayMicrocodeData(addr,v1,v2,lst) {
	var s1 = toHex(v1,8);
	var s2 = toHex(v2,8);
	var s1a = s1.substr(0,4);
	var s1b = s1.substr(4);
	var s2a = s2.substr(0,4);
	var s2b = s2.substr(4);
	var s = toHex(addr,2) + ": "+ s1a + " " + s1b + " " + s2a + " " + s2b;
	var a = "";
	var b = "";
	var c = "";
	var d = "";
	var maxLen = 45;
	var ii = 0, mx = lst.length;
	for ( ; ii < mx; ii++ ) {
		if ( a.length+lst[ii].length < maxLen ) {
			a = a + " " + lst[ii] + " ";
		} else {
			b = lst[ii];
			break;
		}
	}
	for ( ii++; ii < mx; ii++ ) {
		if ( b.length+lst[ii].length < maxLen ) {
			b = b + " " + lst[ii] + " ";
		} else {
			c = lst[ii];
			break;
		}
	}
	for ( ii++; ii < mx; ii++ ) {
		if ( c.length+lst[ii].length < maxLen ) {
			c = c + " " +  lst[ii] + " ";
		} else {
			d = lst[ii];
			break;
		}
	}
	for ( ii++; ii < mx; ii++ ) {
		if ( d.length+lst[ii].length < (maxLen-5) ) {
			d = d + " " + lst[ii] + " ";
		} else {
			d = "..."
			break;
		}
	}
	//d = "abcdefghij";
	//d += "012345678";
	//d += "abcdefghi";
	//d += "012345678";
	//d += "abcdefghi";
	//d += "01234";
	displayMicrocodeText(s,a,b,c,d);
}

function clearMemoryText() {
	for ( var i = 0; i < 16; i++ ) { 
		$("#memory_txt_"+i).text("");
	}
}

function displayMemoryText() {
	clearMemoryText();
	var i = 0;
	for ( var mx = arguments.length; i < mx && i < 16; i++ ) {
		var x = arguments[i];
		$("#h_memory_"+i).html(arguments[i]);
	}
	for ( ; i < 16; i++ ) {
		$("#h_memory_"+i).html("");
	}
}
function displayMemoryTextArr(arr) {
	clearMemoryText();
	var i = 0;
	for ( var mx = arr.length; i < mx && i < 16; i++ ) {
		var x = arr[i];
		$("#h_memory_"+i).html(arr[i]);
	}
	for ( ; i < 16; i++ ) {
		$("#h_memory_"+i).html("");
	}
}

function clearMainBus() {
	$("#h_bus_txt_0").html("");
}

function displayMainBus(s) {
	// <text id="h_bus_txt_0" x="1280" y="280" class="small"></text>
	$("#h_bus_txt_0").html(s);
}


// ----------------------------------------------------------------------------------------------------------------------
// ----------------------------------------------------------------------------------------------------------------------

var theWorld2 = {};			// Values
var theWorld2WhoSet = [];	// Who set like PC
var theWorld2DepOn = [];	// Functions depending on inputs.
var thisTick = {};			// List of calls run during this tick


// AddMsg ( PC.x.Name, "Bus", "Out", PC.x._OutputBuffer );		// Resovles Bus							
function AddMsg ( Name, Resolves, Type, Value ) {
	if ( Type == "Out" || Type == "I/O" ) {
		// console.log ( "Setting theWorld2['"+Resolves+"'] to "+Value );
		theWorld2[Resolves] = Value;
		theWorld2WhoSet[Resolves] = Name;
		switch ( Resolves ) {
		case "Bus":
			var sVal = toHex(Value,4);
			displayMainBus(sVal);
		break;
		}
	} else {
		console.error ( "AddMsg incorrect type: ", Type );
	}
}

// AddDep ( PC.x.Name, [ "Bus" ], "In", function ( v ) {
function AddDep ( Name, depOn, Type, Fx) {
	theWorld2DepOn.push ( { 
		"State": "Pending",
		"Type": Type,
		"DepOn": depOn,
		"SentFrom": Name,
		"Fx": Fx
	} );
}

function hasPending () {
	for ( var ll = 0, my = theWorld2DepOn.length; ll < my; ll++ ) {
		if ( theWorld2DepOn[ll].State == "Pending" ) {
			return true;
		}
	}
	return false;
}

// xyzzy4001 Proposed: AddDep ( ALU.x.Name, [ "Bus", "ac_Out_to_ALU" , [ [ "ALU_Ctl_0" , "ALU_Ctl_1" , "ALU_Ctl_2" , "ALU_Ctl_3" ], [ "ALU_Ctl" ] ] ], "Out", function () { 		

// tw is the row in theWorld2DepOn
function depdendenciesMet ( tw ) {
	if ( tw.State !== "Pending" ) {
		console.log ( "Invalid data passed to depdendenciesMet()" );
		return true;
	}

	var name = tw.DepOn;
	if ( typeof name === "string" ) {
		if ( theWorld2[ name ] === undefined ) {
			return false;
		}
	}

	for ( var ww = 0, mz = tw.DepOn.length; ww < mz; ww++ ) {
		name = tw.DepOn[ww];
		if ( theWorld2[ name ] === undefined ) {
			return false;
		}
	}
	return true;
}


function KeyOfHash ( x ) {
	var s = [];
	for ( var km in x ) {
		s.push ( km );
	}
	return s.join("-");
}

function KeyOfArr ( x ) {
	return x.join("-");
}

function PropagateSignals () {
	if ( debug_PropagateSignals ) {
		console.log ( "theWorld2      before:" + JSON.stringify ( theWorld2), ln() );
		console.log ( "theWorld2DepOn before:" + JSON.stringify ( theWorld2DepOn ) );
	}
	var Pend = {};
	for ( var nIter = 0; hasPending(); nIter++ ) {
		if ( nIter > 10 ) {
			console.error ( "Out of Gas...", Pend );
			break;
		}
		for ( var kk = 0, mx = theWorld2DepOn.length; kk < mx; kk++ ) {
			var tw = theWorld2DepOn[kk];
			if ( tw.State === "Pending" ) {
				Pend[KeyOfArr(tw.DepOn)] = 1;
				if ( depdendenciesMet ( tw ) ) {
					tw.Fx();
					theWorld2DepOn[kk].State = "Done";
					delete Pend[KeyOfArr(tw.DepOn)];
				}
			}
		}
	}
	if ( debug_PropagateSignals ) {
		console.log ( "theWorld2      after:" + JSON.stringify ( theWorld2) );
		console.log ( "theWorld2DepOn after:" + JSON.stringify ( theWorld2DepOn ) );
	}
}


</script>
<script src="js/pc_reg.js"></script>
<script src="js/ir_reg.js"></script>
<script src="js/result_reg.js"></script>
<script src="js/ac_reg.js"></script>
<script src="js/mar_reg.js"></script>
<script src="js/mdr_reg.js"></script>
<script src="js/input_reg.js"></script>
<script src="js/output_reg.js"></script>
<script src="js/microcode_pc_reg.js"></script>
<script src="js/microcode_memory.js"></script>
<script src="js/main_memory.js"></script>
<script src="js/alu.js"></script>
<script src="js/mux.js"></script>


<script src="js/show-memory.js?v=0008"></script>
<script>

//console.log ( "PC=",PC, "RESULT=", RESULT);
//console.log ( "IR=",IR, "AC=", AC);
//console.log ( "MAR=",MAR, "MDR=", MDR);
//console.log ( "INPUT=",INPUT, "OUTPUT=", OUTPUT);
//console.log ( "MICROCODE_PC=",MICROCODE_PC);
//console.log ( "MICROCODE=",MICROCODE);
//console.log ( "MEMORY=",MEMORY);
//console.log ( "ALU=",ALU);
//console.log ( "MUX=",MUX);

console.log ( "Version v.1.4.4 - Sat Mar 14 16:00:54 MDT 2020" );
console.log ( "Developed for the Deptatmentment of Computer Science 2150 Machine Architecture class.");
console.log ( "Copyright (C) University of Wyoming, 2019-2020." );

// ---------------------------------------------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------------------------------------------

/*
0000000430000001 000
0000000144000000 001
0000000008c00008 002
436f646520427920 003
*/
var ParseInput = function (data) {
	var array = data.toString().split("\n");
	var pc = 0;
	var st = 0;
    for(i in array) {
        // console.log("->"+array[i]+"<-");
		const str = array[i];
		if ( str.length === 0 ) {
			// console.log ( "Skipping 0 length line" )
		} else if ( str === "##1" ) {
			st = 1;
		} else if ( str === "##2" ) {
			st = 2;
		} else if ( st === 0 ) {
			const words = str.split(' ');
			const str2 = words[0];
			// console.log(words[0]);
			const p2 = str2.substr(0, 8)
			const p1 = str2.substr(8)
			// console.log("p1 ->"+p1+"<- p2 ->"+p2+"<-");
			const p1x = parseInt(p1,16);
			const p2x = parseInt(p2,16);
			MICROCODE.x["_data1_"][pc] = p1x;
			MICROCODE.x["_data2_"][pc] = p2x;
			pc++;
		} else if ( st === 1 ) {
			// Associate bit with "line" that is turned on.
			const words = str.split(' ');
			const id = words[0];		// Name ####
			const pos = parseInt(words[1]);
			var da = "_data1_";
			var nb = pos;
			if ( pos >= 32 ) {
				da = "_data2_";
				nb = pos - 32;
			}
			if ( ! MICROCODE.x_Output_Lines_ ) {
				MICROCODE.x_Output_Lines_ = {};
			}
			MICROCODE.x["_Output_Lines_"][id] = {
				Loc: pos,
				NthBit: nb,
				Name: id,
				DataArray: da
			};
		}
    }
	displayMicrocodeText(
		"Address 256 Words",
		"Data 64 bits wide",
		"Microcode Loaded... "+mc_hash.substr(0,10)+"...",
		"",
		"");
	// console.log ( JSON.stringify ( MICROCODE ) );
};


var mc_hash = "";

// <button class="modal-submit" type="button" id="modal-submit" onclick="LoadMC();">Load Code</button>
// <input id="modal-input-code-hash" spellcheck="false" name="i_hash" class="hash-input">
function LoadMC() {		// LoadMicrocode
	hideModal();
	var v = $("#modal-input-code-hash").val();
	// console.log ( "v=", v );
	$.get ( "./data/"+v+".txt", function(data){
		// console.log ( "Got It: ", data );
		localStorage.setItem('microcode_data',v);
		mc_hash = v;
		ParseInput(data);
	});
}


function OnStartupReloadMicrocode() {
	var v = localStorage.getItem('microcode_data');
	if ( v ) {
		mc_hash = v;
		$("#modal-input-code-hash").val(v);
		LoadMC();
	}
}

OnStartupReloadMicrocode();




// ---------------------------------------------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------------------------------------------

var ParseInputHexMM = function (data) {
	var array = data.toString().split("\n");
	var pc = 0;
    for(i in array) {
        // console.log("->"+array[i]+"<-");
		const str = array[i];
		if ( str.length === 0 ) {
			// console.log ( "Skipping 0 length line" )
		} else {
			const p1x = parseInt(str,16);
			MEMORY.x["_data_"][pc] = p1x;
			pc++;
		}
    }
	mm_max = pc;
	displayMemoryText(
		"Address 8K Words",
		"Data 16 bits wide",
		"Hex Code Loaded... "+mm_hash.substr(0,10)+"..."
	);
//	console.log ( JSON.stringify ( MEMORY ) );
};


var mm_hash = "";

function LoadMM() {
	hideModal();
	var v = $("#modal-input-mm-hash").val();
	// console.log ( "v=", v );
	$.get ( "./data/"+v+".txt", function(data){
		// console.log ( "Got It: ", data );
		localStorage.setItem('main_memory_data',v);
		mm_hash = v;
		ParseInputHexMM(data);
	});
}

function OnStartupReloadMainMemory() {
	var v = localStorage.getItem('main_memory_data');
	if ( v ) {
		mm_hash = v;
		$("#modal-input-mm-hash").val(v);
		LoadMM();
	}
}

OnStartupReloadMainMemory();



function LoadMA() {
	hideModal();
console.log ( "LoadMA()" );
	/* <input id="modal-input-ma" spellcheck="false" name="i_mm_addr" class="mem-input"> */
	var v = $("#modal-input-ma").val();
	v = parseInt ( v, 16 );
	showMemoryAtPC ( v );
}


var isInit = 0;

// ---------------------------------------------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------------------------------------------
function ResetMachine() {
	curPosInput = 0;
	isHalted = 0;
	isInit = 0;
	showHalt ( false );
	showFetch ( false );
	showIsError ( false );
	clearOtherLine();
	PC.msg("Clr", 1);
	INPUT.msg("Clr", 1);
	OUTPUT.msg("Clr", 1);
	RESULT.msg("Clr", 1);
	IR.msg("Clr", 1);
	MICROCODE_PC.msg("Clr", 1);
	clearOtherLine();
	if ( mc_hash && mc_hash != "" ) {
		$("#modal-input-code-hash").val(mc_hash);
		LoadMC();
	}
	if ( mm_hash && mm_hash != "" ) {
		$("#modal-input-mm-hash").val(mm_hash);
		LoadMM();
	}
}

// ---------------------------------------------------------------------------------------------------------------------------------------
// Registers and Components.
// ---------------------------------------------------------------------------------------------------------------------------------------
//		Microcode_PC
//		Microcode
//		Input
//		PC
//		MAR
//		Memory
//		MDR
//		IR
//		AC
//		ALU
//		Result
//		Decoder
//		Output
// ---------------------------------------------------------------------------------------------------------------------------------------

var StopMcTick = 0;
var StopTick = 0;

// Step1Tick will step forward 1 microcode step - the user interface gets to refresh after the step-tick.
// Step1Tick checks to see if the system has been setup - if not it will set it up and mark it as isInit
// in a glboal.  This can be reset using the ResetMachine() call.
function Step1Tick() {
	if ( isInit === 0 ) {
		MICROCODE_PC.msg('Out',1);
		MICROCODE.msg('Addr',1);					// send a message - may be start of something!
		PC.msg('Out',1);
		Run1TickInit();
		isInit = 1;
	}
	Run1TickStep();
}

// Step1Ins will step forwared 1 instruction wintout a user-interface refresh.
function Step1Ins() {
	Step1Tick();

	for ( var i = 0; i < 100; i++ ) { 		
		Run1TickStep();
		if ( !!(theWorld2.ins_end === 1) ) {
			break;
		}
	}
}


// stackTrace will return the current stack trace for output on the console.
function stackTrace() {
	var e = new Error();
	if (!e.stack) try {
		throw e;
	} catch (e) {
		if (!e.stack) { // Probably the dreaded IE < 10
			return 0;
		}
	}
	var stack = e.stack.toString().split(/\r\n|\n/);		// deal with Winderz icky newlines.
	return ( stack );
}

// ln will return the line number that you are currently at - for debuging.
function ln() {
	var stack = stackTrace();
	var frameRE = /:(\d+):(?:\d+)[^\d]*$/;
	do {
		var frame = stack.shift();
	} while (!frameRE.exec(frame) && stack.length);
	return frameRE.exec(stack.shift())[1];
}

// ctlTo4Dig will take the LSB - 4 ditits - of the number and convert it to a binary string with spaces in it.
// This is for display purposes.
function ctlTo4Dig(x) {
	var xx = x & 0xf;
	xx |= 0x10;
	var s = xx.toString(2);
	s = s.substr(1)
	// console.log ( "->"+s+"<-", stackTrace() );
	var t = s.split("");
	s = t.join(" ");
	return s;
}

// signed convers a javascript float value that is 16bits to a signed 32 bit value.
function signed(v) {
    if ( ( v & 0x8000 ) > 0 ) {
        var w = v | 0xffff0000;
        return w;
    } else {
        return v;
    }
}

var nErr = 0;











// 1000. PC
function test1000() {
	clearOtherLine(); 	

	PC.msg("Clr",1);
	PC.msg("Inc",1);
	if ( PC.x._Inc_ !== 1 ) {
		console.error ( "Error test1000: pc.x._Inc_ != 1" );
		nErr++;
	}
	if ( PC.x._data_ !== 0 ) {
		console.error ( "Error test1000: pc != 0" );
		nErr++;
	}
	PC.msg("rise",1);
	if ( PC.x._data_ !== 1 ) {
		console.error ( "Error test1000: pc != 1" );
		nErr++;
	}

	// ----------------------------------------------------------------------------
	theWorld2DepOn = [];	// Setup
	theWorld2 = {};			// Values
	theWorld2WhoSet = [];	// Who set like PC

	// Create a pending action
	PC.msg("Ld",1);
	if ( ! hasPending () ) {
		console.error ( "Error test1000: hasPending() false after creation of pending item." );
		nErr++;
	}

	// Verify that the dependencies are not yet met.
	var tw = theWorld2DepOn[0];	// is at 0 due to setup above.
	if ( depdendenciesMet ( tw ) ) {
		console.error ( "Error test1000: depdendenciesMet() true before any dependencies resolved." );
		nErr++;
	}

	// Resolve the dependency
	// theWorld2["Bus"] = 4;
	AddMsg ( "test1000", "Bus", "Out", 44 ) ;

	if ( theWorld2["Bus"] !== 44 ) {
		console.error ( "Error test1000: Expecing 44 on bus, got: "+ theWorld2["Bus"] );
		nErr++;
	}

	// Verify that it is met.
	if ( ! depdendenciesMet ( tw ) ) {
		console.error ( "Error test1000: depdendenciesMet() false when dependency has been met." );
		nErr++;
	}

	if ( lineOn.length != 2 ) {
		console.error ( "Error test1000: should have 2 blue liens on - did not find them." );
		nErr++;
	}

	clearOtherLine(); 	
	if ( lineOn.length != 0 ) {
		console.error ( "Error test1000: should have 0 blue liens on - did not find them." );
		nErr++;
	}

	// Run the Signal Propagator.
	PropagateSignals();


	// Check that no pending actions are left.
	if ( hasPending () ) {
		console.error ( "Error test1000: hasPending() true when all functions should have been run." );
		nErr++;
	}

	// Validate value set.
	if ( PC.x._data_ !== 44 ) {
		console.error ( "Error test1000: should be 44, got:" +PC.x._data_ +" instead." );
		nErr++;
	}

	if ( lineOn.length != 1 ) {
		console.error ( "Error test1000: should have 1 blue liens on - did not find them." );
		nErr++;
	}

	// ----------------------------------------------------------------------------
	PC.msg("rise",1);
	PC.msg("Inc",1);
	PC.msg("rise",1);
	if ( PC.x._data_ !== 45 ) {
		console.error ( "Error test1000: should be 45, got:" +PC.x._data_ +" instead." );
		nErr++;
	}

	PC.msg("Out",1);
	if ( theWorld2["Bus"] !== 45 ) {
		console.error ( "Error test1000: 'Bus' should be 45, got: " +theWorld2["Bus"]+" instead." );
		nErr++;
	}

	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}

// ----------------------------------------------------------------------------------------------------------------------------------------
// Test the transfer of the PC to the MAR
function test1001() {

	PC.x._data_ = 0x1001;		// Test Number 	- Force the PC to have 1001 hex as data.
	PC.msg("Out",1);

	MAR.msg("Ld",1);			// Setup MAR to do a load.

	if ( theWorld2["Bus"] !== 0x1001 ) {
		console.error ( "Error test1001: 'Bus' should be 0x1001, got: " +theWorld2["Bus"]+" instead." );
		nErr++;
	}

	PropagateSignals();

	if ( MAR.x._data_ !== 0x1001 ) {
		console.error ( "Error test1001: MAR.x._data_ should be 0x1001, got: " +MAR.x._data_+" instead." );
		nErr++;
	}

	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}




// ----------------------------------------------------------------------------------------------------------------------------------------
// Test of "OUTPUT" to 7-seg
// 1102. Output -> 7-seg
function test1102() {
	OUTPUT.x._data_ = 0x1234;				// Set data
	OUTPUT.Display( OUTPUT.x._data_ );		// Display it
	return ( nErr );
}

// ----------------------------------------------------------------------------------------------------------------------------------------
// Test the transfer of the PC to the OUTPUT
// 1101. AC -> Output
function test1101() {

	PC.x._data_ = 0x1101;		// Test Number 	- Force the PC to have 1001 hex as data.
	PC.msg("Out",1);

	OUTPUT.msg("Ld",1);			// Setup OUTPUT to do a load.

	if ( theWorld2["Bus"] !== 0x1101 ) {
		console.error ( "Error test1001: 'Bus' should be 0x1001, got: " +theWorld2["Bus"]+" instead." );
		nErr++;
	}

	PropagateSignals();

	if ( OUTPUT.x._data_ !== 0x1101 ) {
		console.error ( "Error test1101: OUTPUT.x._data_ should be 0x1101, got: " +OUTPUT.x._data_+" instead." );
		nErr++;
	}

	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}





// ----------------------------------------------------------------------------------------------------------------------------------------
// 1003. MDR -> Bus -> MAR 
function test1003() {

	MDR.x._data_ = 0x1003;		// Test Number 	- Force the MDR to have 1001 hex as data.
	MDR.msg("Out",1);

	MAR.msg("Ld",1);			// Setup MAR to do a load.

	if ( theWorld2["Bus"] !== 0x1003 ) {
		console.error ( "Error test1003: 'Bus' should be 0x1001, got: " +theWorld2["Bus"]+" instead." );
		nErr++;
	}

	PropagateSignals();

	if ( MAR.x._data_ !== 0x1003 ) {
		console.error ( "Error test1003: MAR.x._data_ should be 0x1003, got: " +MAR.x._data_+" instead." );
		nErr++;
	}

	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}




// ----------------------------------------------------------------------------------------------------------------------------------------
// 1104. Result -> AC
function test1104() {

	RESULT.x._data_ = 0x1103;		// Test Number 	- Force the RESULT to have 1001 hex as data.
	RESULT.Display( RESULT.x._data_ );
	RESULT.msg("Out",1);

	AC.msg("Ld",1);			// Setup AC to do a load.

	if ( theWorld2["Bus"] !== 0x1103 ) {
		console.error ( "Error test1103: 'Bus' should be 0x1001, got: " +theWorld2["Bus"]+" instead." );
		nErr++;
	}

	PropagateSignals();

	if ( AC.x._data_ !== 0x1103 ) {
		console.error ( "Error test1103: AC.x._data_ should be 0x1103, got: " +AC.x._data_+" instead." );
		nErr++;
	}

	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}


// ----------------------------------------------------------------------------------------------------------------------------------------
// 1105. Input -> AC
function test1105() {

	INPUT.x._data_ = 0x1105;		// Test Number 	- Force the INPUT to have 1001 hex as data.
	INPUT.Display( INPUT.x._data_ );
	INPUT.msg("Out",1);

	AC.msg("Ld",1);			// Setup AC to do a load.

	if ( theWorld2["Bus"] !== 0x1105 ) {
		console.error ( "Error test1105: 'Bus' should be 0x1001, got: " +theWorld2["Bus"]+" instead." );
		nErr++;
	}

	PropagateSignals();

	if ( AC.x._data_ !== 0x1105 ) {
		console.error ( "Error test1105: AC.x._data_ should be 0x1105, got: " +AC.x._data_+" instead." );
		nErr++;
	}

	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}







// ----------------------------------------------------------------------------------------------------------------------------------------
// Test the transfer of the PC to the MAR, MAR Read Memory -> MDR
// 1002. PC -> MAR -> Memory Read -> IR
// This tests mimics what will happen in the fetch cycle - where PC -> MAR -> Memory -> IR
function test1002() {

	// ----------------------------------------------------------------------------
	// Data Setup
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x1002] = 0xFace;		
	mm_max = 1024*16;
	PC.x._data_ = 0x1002;		// Test Number 	- Force the PC to have 1002 hex as data.
	MAR.x._data_ = 0x0000;		// Test Number 	- Force the MAR to have 1002 hex as data.



	// ----------------------------------------------------------------------------
	// PC -> MAR - to setup of read of memory.
	// ----------------------------------------------------------------------------
	thisTick = {}; // (same as "Pending" - or Propogation makes it different - ??)
	PC.msg("Out",1);
	MAR.msg("Ld",1);

	console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );

	PropagateSignals();
	RunConnections ();
	clearOtherLine(); 	

	console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );

	if ( theWorld2["Bus"] !== 0x1002 ) {
		console.error ( "Error test1002: 'Bus' should be 0x1002, got: " +theWorld2["Bus"]+" instead." );
		nErr++;
	}
	if ( MAR.x._data_ !== 0x1002 ) {
		console.error ( "Error test1002: 'MAR.x._data_' should be 0x1002, got: " +MAR.x._data_+" instead." );
		nErr++;
	}




	// ----------------------------------------------------------------------------
	// Read of Memory using MAR -> Memory -> MDR
	// ----------------------------------------------------------------------------
	thisTick = {}; // (same as "Pending" - or Propogation makes it different - ??)
	MEMORY.msg("Read",1);			// Setup MAR to do a load.
	MAR.msg("Out_to_Memory",1);
	MDR.msg("From_Memory_to_MDR",1);

	console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );

	PropagateSignals();
	RunConnections ();
	clearOtherLine(); 	

	if ( theWorld2["Memory_to_MDR"] !== 0xFace ) {
		console.error ( "Error test1002: 'Memory_to_MDR' should be 0xFace, got: " +theWorld2["Memory_to_MDR"]+" instead." );
		nErr++;
	}
	if ( MAR.x._data_ !== 0x1002 ) {
		console.error ( "Error test1002: MAR.x._data_ should be 0x1002, got: " +MAR.x._data_+" instead." );
		nErr++;
	}
	if ( MDR.x._data_ !== 0xFace ) {
		console.error ( "Error test1002: MDR.x._data_ should be 0xFace, got: " +MDR.x._data_+" instead." );
		nErr++;
	}



	// ----------------------------------------------------------------------------
	// Transfer of MDR to IR
	// ----------------------------------------------------------------------------
	MDR.msg("Out",1);
	IR.msg("Ld",1);
	console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );

	PropagateSignals();
	clearOtherLine(); 	

	console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );

	if ( theWorld2["Bus"] !== 0xFace ) {
		console.error ( "Error test1002: 'Bus' should be 0xFace, got: " +theWorld2["Bus"]+" instead." );
		nErr++;
	}
	if ( IR.x._data_ !== 0xFace ) {
		console.error ( "Error test1002: 'IR.x._data_' should be 0xFace, got: " +IR.x._data_+" instead." );
		nErr++;
	}



	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}











// ----------------------------------------------------------------------------------------------------------------------------------------
// 1005. MAR -> Memory Read -> AC						Probably Trivial (it was trivial)
//														** but later this test saved me lots of pain **
// ----------------------------------------------------------------------------------------------------------------------------------------
function test1005() {

	// ----------------------------------------------------------------------------
	// Data Setup
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x1005] = 0xBeef;		
	mm_max = 1024*16;
	MAR.x._data_ = 0x1005;		// Test Number 	- Force the MAR to have 1005 hex as data.



	// ----------------------------------------------------------------------------
	// Read of Memory using MAR -> Memory -> MDR
	// ----------------------------------------------------------------------------
	MEMORY.msg("Read",1);			// Setup MAR to do a load.
	MAR.msg("Out",1);
	MDR.msg("From_Memory_to_MDR",1);

	console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );

	PropagateSignals();
	clearOtherLine(); 	

	if ( theWorld2["Memory_to_MDR"] !== 0xBeef ) {
		console.error ( "Error test1005: 'From_Memory_to_MDR' should be 0xBeef, got: " +theWorld2["From_Memory_to_MDR"]+" instead." );
		nErr++;
	}
	if ( MAR.x._data_ !== 0x1005 ) {
		console.error ( "Error test1005: MAR.x._data_ should be 0x1005, got: " +MAR.x._data_+" instead." );
		nErr++;
	}
	if ( MDR.x._data_ !== 0xBeef ) {
		console.error ( "Error test1005: MDR.x._data_ should be 0xBeef, got: " +MDR.x._data_+" instead." );
		nErr++;
	}



	// ----------------------------------------------------------------------------
	// Transfer of MDR to AC
	// ----------------------------------------------------------------------------
	MDR.msg("Out",1);
	AC.msg("Ld",1);
	console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );

	PropagateSignals();
	clearOtherLine(); 	

	console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );

	if ( theWorld2["Bus"] !== 0xBeef ) {
		console.error ( "Error test1005: 'Bus' should be 0xBeef, got: " +theWorld2["Bus"]+" instead." );
		nErr++;
	}
	if ( AC.x._data_ !== 0xBeef ) {
		console.error ( "Error test1005: 'AC.x._data_' should be 0xBeef, got: " +AC.x._data_+" instead." );
		nErr++;
	}



	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}








// ----------------------------------------------------------------------------------------------------------------------------------------
// Test MUX
// ----------------------------------------------------------------------------------------------------------------------------------------
function test3000() {

	// ----------------------------------------------------------------------------
	// Data Setup
	// ----------------------------------------------------------------------------
	MUX.x._Ctl_1_ = 1;  // Should be set via theWorld2 - output bus from Microcode! xyzzy4004
	MUX.x._Ctl_0_ = 1;
	theWorld2["MUX_Ctl_1"] = 1;
	theWorld2["MUX_Ctl_0"] = 1;
	clearOtherLine(); 	

	MUX.x._00_0_ = 0;	// 0x00
	MUX.x._00_1_ = 0;
	MUX.x._00_2_ = 0;
	MUX.x._00_3_ = 0;
	MUX.x._00_4_ = 0;
	MUX.x._00_5_ = 0;
	MUX.x._00_6_ = 0;
	MUX.x._00_7_ = 0;

	MUX.x._01_0_ = 1;	// 0xff
	MUX.x._01_1_ = 1;
	MUX.x._01_2_ = 1;
	MUX.x._01_3_ = 1;
	MUX.x._01_4_ = 1;
	MUX.x._01_5_ = 1;
	MUX.x._01_6_ = 1;
	MUX.x._01_7_ = 1;

	MUX.x._10_0_ = 1;	// 0x69
	MUX.x._10_1_ = 0;
	MUX.x._10_2_ = 0;
	MUX.x._10_3_ = 1;
	MUX.x._10_4_ = 0;
	MUX.x._10_5_ = 1;
	MUX.x._10_6_ = 1;
	MUX.x._10_7_ = 0;

	MUX.x._11_0_ = 0;	// 0x9e
	MUX.x._11_1_ = 1;
	MUX.x._11_2_ = 1;
	MUX.x._11_3_ = 1;
	MUX.x._11_4_ = 1;
	MUX.x._11_5_ = 0;
	MUX.x._11_6_ = 0;
	MUX.x._11_7_ = 1;

	MUX.msg("mux-logic",1);	// remove xyzzy4004

	PropagateSignals(); 			// How to do enough to step an entire Microcode Tick

	//		MUX.x["_Out_"] = MUX.x["_00_"] = 
	//			( MUX.x["_00_0_"] & 0x1 ) 		|
	//			( MUX.x["_00_1_"] & 0x1 ) << 1 	|
	//			( MUX.x["_00_2_"] & 0x1 ) << 2 	|
	//			( MUX.x["_00_3_"] & 0x1 ) << 3 	|
	//			( MUX.x["_00_4_"] & 0x1 ) << 4 	|
	//			( MUX.x["_00_5_"] & 0x1 ) << 5 	|
	//			( MUX.x["_00_6_"] & 0x1 ) << 6 	|
	//			( MUX.x["_00_7_"] & 0x1 ) << 7 	;

	console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );

	if ( theWorld2["Microcode_Ld"] !== 0x9e ) {
		console.error ( "Error test3000: 'Microcode_Ld' should be 0x9e, got: " +theWorld2["Microcode_Ld"]+" instead." );
		nErr++;
	}



	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}



// ----------------------------------------------------------------------------------------------------------------------------------------
// Test ALU
// ----------------------------------------------------------------------------------------------------------------------------------------
function test3001() {

	// ----------------------------------------------------------------------------
	// Data Setup
	// ----------------------------------------------------------------------------
	// |  0 | 1  |  0 |  0 |    *   |	Add: result = ac + bus (mdr usually)                 |
	//ALU.x._Ctl_0_ = 0;	// Setup to do an ADD
	//ALU.x._Ctl_1_ = 0;
	//ALU.x._Ctl_2_ = 1;
	//ALU.x._Ctl_3_ = 0;

	ALU.rise();

	theWorld2["Bus"] = 7;			// _B_ 
	AC.x["_data_"] = 5;				// _A_
	theWorld2["ac_Out_to_ALU"] = 5;	// _A_
	theWorld2["ALU_Ctl_0"] = 0;		// 0x4 = ADD
	theWorld2["ALU_Ctl_1"] = 0;	
	theWorld2["ALU_Ctl_2"] = 1;	
	theWorld2["ALU_Ctl_3"] = 0;	

	ALU.msg("alu-logic",1);

	PropagateSignals(); 			
	clearOtherLine(); 	

	console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );

	if ( theWorld2["ALU_Out"] !== 12 ) {
		console.error ( "Error test3001: 'ALU_Out' should be 0x0d/12, got: " +theWorld2["ALU_Out"]+" instead." );
		nErr++;
	}



	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}


// ----------------------------------------------------------------------------------------------------------------------------------------
// Test the ResetMachine function.
// ----------------------------------------------------------------------------------------------------------------------------------------
function test3800() {

	PC.x._data_ = 1;
	MICROCODE_PC.x._data_ = 2;

	ResetMachine();

	if ( PC.x._data_ !== 0 ) {
		console.error ( "Error test3800: 'PC' should be 0, got: " +PC.x._data_+" instead." );
		nErr++;
	}
	if ( MICROCODE_PC.x._data_ !== 0 ) {
		console.error ( "Error test3800: 'MICROCODE_PC' should be 02, got: " +PC.x._data_+" instead." );
		nErr++;
	}

	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}











// ----------------------------------------------------------------------------------------------------------------------------------------
// 2000.  Test Load, Halt
// ----------------------------------------------------------------------------------------------------------------------------------------
// test a 2 instruction program with 1 word of data.
// 2000.  Test Load, Halt
//var Connections = {				:2033
function test2000( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1002;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0002] = 0x1230;			// X,       HEX   1230 	
	mm_max = 1024*16;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.

	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}


	if ( AC.x._data_ != 0x1230 ) {
		console.error ( "Error test2000: 'AC' should be 0x1230, got not set: "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test2000: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 2 ) {
		console.error ( "Error test2000: 'PC' should be 2, got: " +PC.x._data_+" instead." );
		nErr++;
	}
//	/* Only ran 1 instruciton */
//	if ( PC.x._data_ !== 1 ) {
//		console.error ( "Error test2000: 'PC' should be 1, got: " +PC.x._data_+" instead." );
//		nErr++;
//	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}










function test7000( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x7000;			// Program 	Halt
	mm_max = 2;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.

	// theWorld2["Microcode_PC_Addr"] = 0;			// Simulate Microcode_PC pusing out an address to Microcode(memroy)

	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}

	Run1TickInit();
	for ( var i = 0; i < 100; i++ ) { 		// This is different than others - other tests will check for "ins_end" to mark the end of the instruction.
		Run1TickStep();
		if ( theWorld2["is_halted"] ) {
			break;
		}
	}

	if ( theWorld2.is_halted !== 1 ) {
		console.error ( "Error test7000: 'is_halted' should be 1, got not set: "+theWorld2.is_halted+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test7000: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 1 ) {
		console.error ( "Error test7000: 'PC' should be 1, got: " +PC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( MICROCODE_PC.x._data_ !== 0xb8 ) {
		// MPC = 0xb8
		console.error ( "Error test7000: 'MICROCODE_PC' should be 0xb82, got: 0x"+PC.x._data_.toString(16)+" instead." );
		nErr++;
	}

	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}














function TickFinalCleanup() {
	theWorld2 = {};			// Values
	theWorld2WhoSet = [];	// Who set like PC
	theWorld2DepOn = [];	// Functions depending on inputs.
	thisTick = {};			// List of Connections called based on completion - only 1 call per tick.
}

function TickStart() {
	// Setup ThisTick - if already run then can not run it again.
	thisTick = {}; // (same as "Pending" - or Propogation makes it different - ??)
	MICROCODE_PC.msg('Out',1);
}



var tickDb = 0;
var prev_pc = 0;
var prev_m_pc = 0;

function Run1TickInit( db ) {
	if ( ! db ) {
		db = 100;
	}
	tickDb = db;

	// -----------------------------------------------------
	// 0. Set prev_pc, prev_mpc - to values.
	// -----------------------------------------------------
	if ( ! PC.x._data_ ) {
		PC.x._data_ = 0;
	}
	if ( ! MICROCODE_PC.x._data_ ) {
		MICROCODE_PC.x._data_ = 0;
	}

	prev_pc = PC.x._data_;
	prev_m_pc = MICROCODE_PC.x._data_;
	// xyzzy - prev_is_fetch - false to true - inidicates start of fetch cycle?

	TickFinalCleanup();

}

// console.log ( "After Step 1: AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );
// console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );
function Run1TickStep() {

	// -----------------------------------------------------
	// 1. Send "Out" message to MICROCODE_PC						
	// -----------------------------------------------------
	clearOtherLine(); 	
	TickFinalCleanup();
	TickStart();


	PropagateSignals(); 			// How to do enough to step an entire Microcode Tick
	RunConnections ();

	PropagateSignals(); 			// How to do enough to step an entire Microcode Tick
	RunConnections ();

	PropagateSignals(); 			// How to do enough to step an entire Microcode Tick
	RunConnections ();



	// console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn );
	MICROCODE_PC.rise();			// RiseAll()??
	PC.rise();						// RiseAll()??
	MICROCODE.rise();				// RiseAll()??
	MUX.rise();	

	// console.log ( "AT:"+ln(), theWorld2 , theWorld2WhoSet , theWorld2DepOn, thisTick );
	thisTick = {};			// List of Connections called based on completion - only 1 call per tick.




//	if ( MICROCODE_PC.x._data_ != 1+prev_m_pc ) {
//		console.error ( "Asert: 'MICROCODE_PC' should be 1, got: " +MICROCODE_PC.x._data_+" instead." );
//		nErr++;
//	}



	prev_m_pc = MICROCODE_PC.x._data_;

	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

if ( false ) {
	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
}
	return ( nErr );
}



// ----------------------------------------------------------------------------------------------------------------------------------------
// Steps:
// ----------------------------------------------------------------------------------------------------------------------------------------
// 0. Set prev_pc, prev_mpc - to values.
// 1. Send "Out" message to MICROCODE_PC						TickStart()
// 2. Check that we get the next step via propogation
// 3. DO the rest of it RunConnections()
// 4. Test Propagation Again
// 5. Check that this drives Microcode
// 6. Check that MICROCODE.msg('Addr',1) got called
// 7. Verify that outputs happen
// 8. Check that MICROCONDE_PC.msg('Inc',1) happens
// 9. Check that MPC is +1 (Incremented) on 'rise' of clock.
// 10. Cleanup at the end of tick, 								TickFinalCleanup()
// 11. MICROCODE_PC must be 1 at this point, Loop to (1) above.
// 		- Confinue until prev_pc increment and CLAR on MPC is completed. (New Instruciton??)
// ----------------------------------------------------------------------------------------------------------------------------------------
    // id_Microcode_PC_Clr 	// Inidicates last 'Tick' in an instruction - will go to 0 after this.
// ----------------------------------------------------------------------------------------------------------------------------------------





// ----------------------------------------------------------------------------------------------------------------------------------------
// xyzzy - Test hand_out - decode logic and process
// ----------------------------------------------------------------------------------------------------------------------------------------



















function test5001( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: Load / Halt
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1003;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0x3004;			//			Add Y
	MEMORY.x._data_[0x0002] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0003] = 0x1230;			// X,       HEX   1230 	
	MEMORY.x._data_[0x0004] = 0x0004;			// Y,       HEX   0004 	
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.


	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}


	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}


	// Expect 0x1234 in AC
	// Expect PC = 0x0003 (inc of Halt)
	if ( AC.x._data_ != 0x1234 ) {
		console.error ( "Error test5001: 'AC' should be 0x1234, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test5001: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 3 ) {
		console.error ( "Error test5001: 'PC' should be 2, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}

function test5002( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: Load / Subt / Halt
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1003;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0x4004;			//			Subt Y
	MEMORY.x._data_[0x0002] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0003] = 0x1230;			// X,       HEX   1230 	
	MEMORY.x._data_[0x0004] = 0x0004;			// Y,       HEX   0004 	
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.


	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}


	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}


	// Expect 0x122c in AC
	// Expect PC = 0x0003 (inc of Halt)
	if ( AC.x._data_ != 0x122c ) {
		console.error ( "Error test5002: 'AC' should be 0x122c, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test5002: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 3 ) {
		console.error ( "Error test5002: 'PC' should be 2, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}


function test5003( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: Load / Halt
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0xA003;			// Program 	Clear
	MEMORY.x._data_[0x0001] = 0x4004;			//			Subt Y
	MEMORY.x._data_[0x0002] = 0x7000;			//			Halt

	MEMORY.x._data_[0x0004] = 0x0004;			// Y,       HEX   0004 	
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.


	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}


	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}


	if ( AC.x._data_ != -4 ) {
		console.error ( "Error test5003: 'AC' should be -4, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( ( AC.x._data_ & 0xffff ) != 0xfffc ) {
		console.error ( "Error test5003: 'AC' should be 0xfffc, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test5003: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 3 ) {
		console.error ( "Error test5003: 'PC' should be 2, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}

function test5004( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: Load / Halt
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0xA000;			// Program 	Clear
	MEMORY.x._data_[0x0001] = 0x9003;			//			JUMP Y
	MEMORY.x._data_[0x0002] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0003] = 0x7000;			// Y,		Halt
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.


	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}


	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}


	// Expect 0x0 in AC
	// Expect PC = 0x0004 (inc of 2nd Halt)
	if ( AC.x._data_ != 0 ) {
		console.error ( "Error test5004: 'AC' should be 0, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test5004: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 4 ) {
		console.error ( "Error test5004: 'PC' should be 4, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}

function test5005( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: Load / Halt
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1003;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0x2004;			//			Store Y
	MEMORY.x._data_[0x0002] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0003] = 0x1230;			// X,       HEX   1230 	
	MEMORY.x._data_[0x0004] = 0x0004;			// Y,       HEX   0004 	
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.



	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}



	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}


	// Expect 0x1230 in AC
	// Expect 0x1230 in mem[0x0003]
	// Expect 0x1230 in mem[0x0004]
	// Expect PC = 0x0003 (inc of Halt)
	if ( AC.x._data_ != 0x1230 ) {
		console.error ( "Error test5005: 'AC' should be 0x1230, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( MEMORY.x._data_[0x0003] != 0x1230 ) {
		console.error ( "Error test5005: 'memory[3]' should be 0x1230, got : "+MEMORY.x._data_[0x0003].toString(16)+" instead." );
		nErr++;
	}
	if ( MEMORY.x._data_[0x0004] != 0x1230 ) {
		console.error ( "Error test5005: 'memory[4]' should be 0x1230, got : "+MEMORY.x._data_[0x0004].toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test5005: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 3 ) {
		console.error ( "Error test5005: 'PC' should be 2, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}



// TODO: This needs work.  Input instruction needs to prompt user for the input! "do_input" line is set - what to do?
// OpInput, then Store
function test5007( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: Load / Halt
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x5000;			// Program 	Input
	MEMORY.x._data_[0x0001] = 0x2004;			//			Store Y
	MEMORY.x._data_[0x0002] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0003] = 0x1230;			// X,       HEX   1230 	
	MEMORY.x._data_[0x0004] = 0x0004;			// Y,       HEX   0004 	
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}

	curPosInput = 0;
	theInput[0] = 0x2312;
	theInput[1] = 0x2312;
	theInput[2] = 0x2312;
	theInput[3] = 0x2312;
	theInput[4] = 0x2312;
	theInput[5] = 0x2312;
	theInput[6] = 0x2312;
	theInput[7] = 0x2312;
	theInput[8] = 0x2312;
	theInput[9] = 0x2312;


	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}


	// Input - 0x2312
	// Expect 0x2312 in AC
	// Expect 0x2312` in mem[0x0004]
	// Expect PC = 0x0003 (inc of Halt)
	if ( AC.x._data_ != 0x2312 ) {
		console.error ( "Error test5005: 'AC' should be 0x2312, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( MEMORY.x._data_[0x0004] != 0x2312 ) {
		console.error ( "Error test5005: 'memory[4]' should be 0x2312, got : "+MEMORY.x._data_[0x0003].toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test5005: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 3 ) {
		console.error ( "Error test5005: 'PC' should be 2, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}

// OpOutput - List output values when "do_output" is signaled in a "Output Q"?
function test5006( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: Load / Halt
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1003;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0x6004;			//			Output
	MEMORY.x._data_[0x0002] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0003] = 0x1230;			// X,       HEX   1230 	
	MEMORY.x._data_[0x0004] = 0x0004;			// Y,       HEX   0004 	
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);


	if ( single ) {
		return;
	}


	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}

	// Expect 0x1230 in AC
	// Expect Output of 0x1230
	// Expect PC = 0x0003 (inc of Halt)
	if ( AC.x._data_ != 0x1230 ) {
		console.error ( "Error test5005: 'AC' should be 0x1230, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test5005: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 3 ) {
		console.error ( "Error test5005: 'PC' should be 2, got: " +PC.x._data_+" instead." );
		nErr++;
	}
	if ( OUTPUT.x._data_ != 0x1230 ) {
		console.error ( "Error test5005: 'OUTPUT' should be 0x1230, got : "+OUTPUT.x._data_.toString(16)+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );
}



// Test SkipLt0 - Skipcond 000 - Number Larger than 0, but not negative.
function test5010( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1004;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0x8000;			//			SkipLt0
	MEMORY.x._data_[0x0002] = 0xA000;			//			Clear
	MEMORY.x._data_[0x0003] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0004] = 0x5900;			//			HEX 5900
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}

	// Goes to 40
	// Goes to 20

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x0004 (inc of Halt)
	// Expect PC = 0x0000 (inc of Halt)
	if ( AC.x._data_ != 0x0000 ) {
		console.error ( "Error test5010: 'AC' should be 0x0000, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 4 ) {
		console.error ( "Error test5010: 'PC' should be 4, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}



// Test SkipLt0 - Skipcond 000 - Number less than 0, 2s compliment
function test5011( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1004;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0x8000;			//			SkipLt0
	MEMORY.x._data_[0x0002] = 0xA000;			//			Clear
	MEMORY.x._data_[0x0003] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0004] = 0x9900;			//			HEX 9900
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	// Went to 40
	// Went to 22

	if ( single ) {
		return;
	}

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x0004 (inc of Halt)
	// Expect PC = 0x9900 (inc of Halt)
	if ( AC.x._data_ != 0x9900 ) {
		console.error ( "Error test5010: 'AC' should be 0x9900, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 4 ) {
		console.error ( "Error test5010: 'PC' should be 4, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}





// Test SkipLt0 - Skipcond 000 - Number equal to 0, but not negative.
function test5012( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1004;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0x8000;			//			SkipLt0
	MEMORY.x._data_[0x0002] = 0x1005;			//			Load 1234 -> AC
	MEMORY.x._data_[0x0003] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0004] = 0x0000;			//			HEX 0
	MEMORY.x._data_[0x0005] = 0x1234;			//			HEX 1234
	mm_max = 6;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	// Goes to 40
	// Goes to 20

	if ( single ) {
		return;
	}

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x0004 (inc of Halt)
	// Expect PC = 0x1234 (inc of Halt)
	if ( AC.x._data_ != 0x1234 ) {
		console.error ( "Error test5010: 'AC' should be 0x1234, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 4 ) {
		console.error ( "Error test5010: 'PC' should be 4, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}



























// Test SkipGt0 - Skipcond 000 - Number Larger than 0, but not negative.
function test5020( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1004;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0x8800;			//			SkipGt0
	MEMORY.x._data_[0x0002] = 0xA000;			//			Clear
	MEMORY.x._data_[0x0003] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0004] = 0x5900;			//			HEX 5900
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	// Goes to 40
	// Goes to 22

	if ( single ) {
		return;
	}

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x0004 (inc of Halt)
	// Expect PC = 0x5900 (inc of Halt)
	if ( AC.x._data_ != 0x5900 ) {
		console.error ( "Error test5010: 'AC' should be 0x5900, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 4 ) {
		console.error ( "Error test5010: 'PC' should be 4, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}



// Test SkipGt0 - Skipcond 000 - Number less than 0, 2s compliment
function test5021( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1004;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0x8800;			//			SkipGt0
	MEMORY.x._data_[0x0002] = 0xA000;			//			Clear
	MEMORY.x._data_[0x0003] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0004] = 0x9900;			//			HEX 9900
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	// Went to 40
	// Went to 20

	if ( single ) {
		return;
	}

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x0004 (inc of Halt)
	// Expect PC = 0x0000 (inc of Halt)
	if ( AC.x._data_ != 0x0000 ) {
		console.error ( "Error test5010: 'AC' should be 0x0000, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 4 ) {
		console.error ( "Error test5010: 'PC' should be 4, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}





// Test SkipGt0 - Skipcond 000 - Number equal to 0, but not negative.
function test5022( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1004;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0x8800;			//			SkipGt0
	MEMORY.x._data_[0x0002] = 0x1005;			//			Load 1234 -> AC
	MEMORY.x._data_[0x0003] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0004] = 0x0000;			//			HEX 0
	MEMORY.x._data_[0x0005] = 0x1234;			//			HEX 1234
	mm_max = 6;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	// Goes to 40
	// Goes to 20

	if ( single ) {
		return;
	}

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x0004 (inc of Halt)
	// Expect PC = 0x1234 (inc of Halt)
	if ( AC.x._data_ != 0x1234 ) {
		console.error ( "Error test5010: 'AC' should be 0x1234, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 4 ) {
		console.error ( "Error test5010: 'PC' should be 4, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}









// Test SkipEq0 - Skipcond 000 - Number Larger than 0, but not negative.
function test5030( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1004;			// Program 	Load X			/ ac = 5900, ne 0
	MEMORY.x._data_[0x0001] = 0x8400;			//			SkipEq0			/ should not skip
	MEMORY.x._data_[0x0002] = 0xA000;			//			Clear			/ ac = 0
	MEMORY.x._data_[0x0003] = 0x7000;			//			Halt			/ done.
	MEMORY.x._data_[0x0004] = 0x5900;			//			HEX 5900
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	// Goes to 40
	// Goes to 22

	if ( single ) {
		return;
	}

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x0004 (inc of Halt)
	// Expect PC = 0x0000 (inc of Halt)
	if ( AC.x._data_ != 0x0000 ) {
		console.error ( "Error test5010: 'AC' should be 0x0000, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 4 ) {
		console.error ( "Error test5010: 'PC' should be 4, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}



// Test SkipEq0 - Skipcond 000 - Number less than 0, 2s compliment
function test5031( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1004;			// Program 	Load X		// ac = neg number
	MEMORY.x._data_[0x0001] = 0x8400;			//			SkipEq0		// ac !== 0, so no skip
	MEMORY.x._data_[0x0002] = 0xA000;			//			Clear		// ac = 0
	MEMORY.x._data_[0x0003] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0004] = 0x9900;			//			HEX 9900
	mm_max = 5;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	// Went to 40
	// Went to 20

	if ( single ) {
		return;
	}

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x0004 (inc of Halt)
	// Expect PC = 0x9900 (inc of Halt)
	if ( AC.x._data_ != 0x0000 ) {
		console.error ( "Error test5010: 'AC' should be 0x0000, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 4 ) {
		console.error ( "Error test5010: 'PC' should be 4, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}





// Test SkipEq0 - Skipcond 000 - Number equal to 0, but not negative.
function test5032( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1004;			// Program 	Load X			// ac = 0
	MEMORY.x._data_[0x0001] = 0x8400;			//			SkipEq0			// should skip, ac is 0
	MEMORY.x._data_[0x0002] = 0x1005;			//			Load 1234 -> AC	// error marker
	MEMORY.x._data_[0x0003] = 0x7000;			//			Halt
	MEMORY.x._data_[0x0004] = 0x0000;			//			HEX 0
	MEMORY.x._data_[0x0005] = 0x1234;			//			HEX 1234
	mm_max = 6;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.



	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}

	// Goes to 40
	// Goes to 20

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x0004 (inc of Halt)
	// Expect PC = 0x0000 (inc of Halt)
	if ( AC.x._data_ != 0x0000 ) {
		console.error ( "Error test5010: 'AC' should be 0x0000, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 4 ) {
		console.error ( "Error test5010: 'PC' should be 4, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}
































// Test LoadI - Indirect Load
function test5040( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0xd004;			// Program 	LoadI X
	MEMORY.x._data_[0x0001] = 0x7000;			//			Halt

	MEMORY.x._data_[0x0004] = 0x0005;			//			HEX 5900
	MEMORY.x._data_[0x0005] = 0x1111;			//			HEX 5900
	mm_max = 6;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x1111 (inc of Halt)
	if ( AC.x._data_ != 0x1111 ) {
		console.error ( "Error test5010: 'AC' should be 0x1111, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 2 ) {
		console.error ( "Error test5010: 'PC' should be 2, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}








// Test StoreI - Indirect Load
function test5041( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1006;			// Program 	Load 006        ac = 0x2222
	MEMORY.x._data_[0x0001] = 0xe004;			// 		 	StoreI 004       mem [ 5 ] becomes 0x2222
	MEMORY.x._data_[0x0002] = 0x7000;			//			Halt

	MEMORY.x._data_[0x0004] = 0x0005;			//			HEX 5900
	MEMORY.x._data_[0x0005] = 0x0011;			//			HEX 0011 marker
	MEMORY.x._data_[0x0006] = 0x2222;			//			HEX 5900
	mm_max = 7;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}


	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x1111 (inc of Halt)
	if ( AC.x._data_ != 0x2222 ) {
		console.error ( "Error test5010: 'AC' should be 0x2222, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( MEMORY.x._data_[0x0005] != 0x2222 ) {
		console.error ( "Error test5010: 'MEMORY[0005]' should be 0x2222, got : "+MEMORY.x._data_[5].toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 3 ) {
		console.error ( "Error test5010: 'PC' should be 3, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}




// Test JumpI - Indirect GOTO
function test5042( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: 
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0xc004;			// Program 	JumpI X
	MEMORY.x._data_[0x0001] = 0x7000;			//			Halt

	MEMORY.x._data_[0x0004] = 0x0010;			//			HEX 0005

	MEMORY.x._data_[0x0010] = 0x7010;			//			Halt Instruciton
	mm_max = 20;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);


	if ( single ) {
		return;
	}


	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect PC = 0x0011 (inc of Halt)
	if ( PC.x._data_ != 0x0011 ) {
		console.error ( "Error test5010: 'PC' should be 0x0011, got : "+PC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( IR.x._data_ != 0x7010 ) {
		console.error ( "Error test5010: 'IR' should be 0x7010, got : "+IR.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}












// Test AddI 
function test5043( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0x1004;			// Program 	Load X
	MEMORY.x._data_[0x0001] = 0xB003;			//			AddI Y
	MEMORY.x._data_[0x0002] = 0x7003;			//			Halt
	MEMORY.x._data_[0x0003] = 0x0005;			//	
	MEMORY.x._data_[0x0004] = 0x1110;			//		
	MEMORY.x._data_[0x0005] = 0x1112;			//			
	mm_max = 8;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	// Went to 40
	// Went to 20

	if ( single ) {
		return;
	}

	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0004 in AC
	// Expect PC = 0x9900 (inc of Halt)
	if ( AC.x._data_ != 0x2222 ) {
		console.error ( "Error test5043: 'AC' should be 0x2222, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( PC.x._data_ !== 3 ) {
		console.error ( "Error test5043: 'PC' should be 3, got: " +PC.x._data_+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}











// Test JnS
// Jumps and Store: Stores value of PC at address X then increments PC to X+1
function test5044( single ) {

	// ----------------------------------------------------------------------------
	// Data Setup: JnS, JumpI
	// ----------------------------------------------------------------------------
	MEMORY.x._data_[0x0000] = 0xA000;			// Program 	Clear
	MEMORY.x._data_[0x0001] = 0x0008;			//          Jns 008
	MEMORY.x._data_[0x0002] = 0x7030;			//			Halt
	MEMORY.x._data_[0x0003] = 0;
	MEMORY.x._data_[0x0004] = 0x1155;			//			Data to load to AC in subroutine.
//	MEMORY.x._data_[0x0005] = 0x0008; // ?? -------------------------------------------------------------------- Why?
	MEMORY.x._data_[0x0006] = 0;
	MEMORY.x._data_[0x0007] = 0;
	MEMORY.x._data_[0x0008] = 0x4444;			//			Marker to see if writen with 0
	MEMORY.x._data_[0x0009] = 0x1004;			//			Marker to see if writen with 0
//	MEMORY.x._data_[0x000a] = 0xc005;			//			JumpI 008 (return)	-------------------------------- Why? -changed from 8 to 5, 5 points at 8 (Extra Cycle in JumpI?)
	MEMORY.x._data_[0x000a] = 0xc008;			//			JumpI 008 (return)	-------------------------------- Why? -changed from 8 to 5, 5 points at 8 (Extra Cycle in JumpI?)
	MEMORY.x._data_[0x000b] = 0;
	mm_max = 14;
	PC.x._data_ = 0x0000;						// So can check increment of PC
	AC.x._data_ = 0x0000;						// So can check changed AC value
	MICROCODE_PC.x._data_ = 0x00;				// Start Microcode Off	-- So can check increment of Microcode_PC later.





	MICROCODE_PC.msg('Out',1);
	MICROCODE.msg('Addr',1);					// send a message - may be start of something!
	PC.msg('Out',1);

	if ( single ) {
		return;
	}


	// Standard run 1 instruction code
	Run1TickInit();
	for ( var j = 0; j < 10; j++ ) {
		// console.error( "Top of loop:",j );
		for ( var i = 0; i < 100; i++ ) { 		
			Run1TickStep();
			// console.error( "bottom of loop:",j ,i );
			if ( !!(theWorld2.ins_end === 1) ) {
				break;
			}
		}
		if ( !!(theWorld2.is_halted) ) {
			break;
		}
	}
	clearOtherLine();

	// Expect 0x0003 in PC
	if ( PC.x._data_ != 3 ) {
		console.error ( "Error test5043: 'PC' should be 3, got : "+PC.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( IR.x._data_ != 0x7030 ) {
		console.error ( "Error test5043: 'IR' should be 0x7030, got : "+IR.x._data_.toString(16)+" instead." );
		nErr++;
	}
	if ( theWorld2.ins_end !== 1 ) {
		console.error ( "Error test50010: 'ins_end' should be 1, got not set: "+theWorld2.ins_end+" instead." );
		nErr++;
	}
	if ( AC.x._data_ != 0x1155 ) {
		console.error ( "Error test5043: 'AC' should be 0x1155, got : "+AC.x._data_.toString(16)+" instead." );
		nErr++;
	}


	// ----------------------------------------------------------------------------
	// So... all done - did we get any errors?
	// ----------------------------------------------------------------------------

	if ( nErr > 0 ) {
		console.error ( "FAIL: # of errors: "+nErr );
	} else {
		console.log ( "PASS" );
	}
	return ( nErr );

}














function testAll() {
	var mNErr = 0;
	//var tt = [  test2000,   test1000,   test1001,   test1102,   test1101,   test1003,   test1104,   test1105,   test1002,   test1005,   test3000,   test3001,   test3800,   test7000
	var tt = [  test2000,   test1000,   test1001,   test1102,   test1101,   test1003,   test1104,   test1105,   test1002,   test1005,   test3000,   test3001,   test3800
	];
	// var ss = [ "test2000", "test1000", "test1001", "test1102", "test1101", "test1003", "test1104", "test1105", "test1002", "test1005", "test3000", "test3001", "test3800", "test7000"
	var ss = [ "test2000", "test1000", "test1001", "test1102", "test1101", "test1003", "test1104", "test1105", "test1002", "test1005", "test3000", "test3001", "test3800"
	];
	for ( var ii = 0, mx = tt.length; ii < mx; ii++ ) {
		nErr = 0;
		var t = tt[ii];
		var x = t();
		if ( x > 0 ) {
			mNErr++;
			console.error ( "Failed on test: "+ii+ " Function: "+ss[ii] );
		}
	}
	if ( mNErr > 0 ) {
		console.error ( "FAIL: # of errors: "+mNErr );
	} else {
		console.log ( "PASS" );
	}
}


		// <text id="h_alu_A_txt" x="505"    y="32" class="vsmall">XXaa</text>
		// <text id="h_alu_B_txt" x="505"   y="137" class="vsmall">xxYY</text>
		// <text id="h_alu_Out_txt" x="357"  y="73" class="vsmall">mmDD</text>
		// <text id="h_mux_out_to_MPC" x="1280"  y="140" class="vsmall">Uu</text>
		//		<text id="h_ir_val_15_12" x="350"  y="165" class="vsmall">0 0 0 0</text>
		//		<text id="h_ir_val_11_08" x="350"  y="195" class="vsmall">1 1 1 1</text>

/*
			showLine("#ir_11_08_to_decoder_mux_10");
			$("#h_ir_val_11_08").html(ctlTo4Dig(IR.x._11_08_)).show();

			showLine("#ir_15_12_to_decoder_mux_11");
			lineOn.push("#h_ir_val_15_12");
*/
</script>
</body>
</html>
